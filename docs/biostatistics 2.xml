<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>AMRBiostats</title>
<link>https://www.amrbiostats.com/biostatistics.html</link>
<atom:link href="https://www.amrbiostats.com/biostatistics.xml" rel="self" type="application/rss+xml"/>
<description>A reliable resource for biostatistics and R programming</description>
<image>
<url>https://www.amrbiostats.com/images/opengraph1.jpg</url>
<title>AMRBiostats</title>
<link>https://www.amrbiostats.com/biostatistics.html</link>
</image>
<generator>quarto-1.7.3</generator>
<lastBuildDate>Thu, 14 Nov 2024 20:00:00 GMT</lastBuildDate>
<item>
  <title>Describing the shape of distribution</title>
  <link>https://www.amrbiostats.com/posts/biostats/B08_distrib_shape_stats.html</link>
  <description><![CDATA[ 




<section id="background" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="background"><span class="header-section-number">1</span> Background</h2>
<ul>
<li>The shape of a distribution can be described in terms of the direction and degree of asymmetry, measured by <strong>skewness</strong>, and the heaviness of the tails, measured by <strong>kurtosis</strong>.</li>
</ul>
</section>
<section id="skewness" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="skewness"><span class="header-section-number">2</span> Skewness</h2>
<ul>
<li><p>It is a measure of the direction and degree of asymmetry of a distribution.</p></li>
<li><p>It is described as the standardized third moment <img src="https://latex.codecogs.com/png.latex?(m_3)"> of the distribution about the mean (the concept of moments will be discussed in upcoming articles).</p></li>
</ul>
<section id="formula" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="formula"><span class="header-section-number">2.1</span> Formula</h3>
<ul>
<li><p>There are three formulas to calculate skewness (we will use <strong>sample moments</strong>):</p>
<ol type="1">
<li><p><strong>Raw formula</strong> <img src="https://latex.codecogs.com/png.latex?g_1">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ag_1%20=%20%5Cdisplaystyle%20%5Cfrac%7Bm_3%7D%7Bm_2%5E%7B3/2%7D%7D%0A"></p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?m_3"> is the third moment about the mean:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Am_3%20=%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bn%7D%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20(x_i%20-%20%5Cbar%7Bx%7D)%5E3%0A"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?m_2"> is the second moment about the mean:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Am_2%20=%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bn%7D%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20(x_i%20-%20%5Cbar%7Bx%7D)%5E2%0A"></p></li>
<li><p>It is not biased-corrected for small samples.</p></li>
<li><p>This formula is used by <code>Excel</code>(<code>SKEW.P</code> function).</p></li>
</ul></li>
<li><p><strong>Fisher’s</strong> <img src="https://latex.codecogs.com/png.latex?G_1">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AG_1%20=%20g_1%20%5Cdisplaystyle%20%5Cfrac%7B%5Csqrt%20%7Bn(n-1)%7D%7D%7Bn-2%7D%0A"></p>
<ul>
<li><p>This measure of skewness is bias-corrected for small samples.</p></li>
<li><p>As <img src="https://latex.codecogs.com/png.latex?n"> increases, the correction factor becomes closer to <img src="https://latex.codecogs.com/png.latex?1">.</p></li>
<li><p>This formula is used by <code>SAS</code>, <code>SPSS</code>, <code>NCSS</code>, <code>Excel</code> (<code>SKEW</code> function), and <code>Graphpad Prism</code>.</p></li>
</ul></li>
<li><p>Skewness <img src="https://latex.codecogs.com/png.latex?b_1">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ab_1%20=%20%5Cdisplaystyle%20%5Cfrac%7Bm_3%7D%7Bs%5E3%7D%20=%20g_1%20%5Cbig%20(%5Cdisplaystyle%20%5Cfrac%7Bn-1%7D%7Bn%7D%20%5Cbig)%5E%7B3/2%7D%0A"></p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?s"> is the sample standard deviation <img src="https://latex.codecogs.com/png.latex?%5Cbig%20%5Bs%20=%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bn-1%7D%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20(x_i%20-%20%5Cbar%7Bx%7D)%5E2%20%5Cbig%20%5D">.</p></li>
<li><p>This formula is used by <code>Minitab</code>.</p></li>
<li><p>This measure uses a slight adjustment by including the factor <img src="https://latex.codecogs.com/png.latex?(%5Cdisplaystyle%20%5Cfrac%7Bn-1%7D%7Bn%7D)%5E%7B3/2%7D">.</p></li>
</ul></li>
</ol></li>
<li><p>The standard error of skewness is given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0ASE_%7Bskewness%7D%20=%20%5Csqrt%20%5Cfrac%7B6n(n-1)%7D%7B(n-2)(n+1)(n+3)%7D%0A"></p></li>
</ul>
</section>
<section id="interpretation" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="interpretation"><span class="header-section-number">2.2</span> Interpretation</h3>
<ul>
<li><p>A skewness value of zero indicates a symmetrical distribution (mean and median are equal or approximately equal).</p></li>
<li><p>A positive value indicates a long right tail (right-skewed distribution, the mean is greater than the median).</p></li>
<li><p>A negative value indicates a long left tail (left-skewed distribution, the mean is less than the median).</p></li>
<li><p>Further interpretation will be discussed in detail under assessing the normality of data.</p></li>
<li><p>The following figure shows different distributions and their skewness values:</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B08_distrib_shape_stats_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calculation-in-r" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="calculation-in-r"><span class="header-section-number">2.3</span> Calculation in R</h3>
<ul>
<li><p>Different functions in R can be used to calculate the skewness:</p>
<ul>
<li><p><code>skewness()</code> function from the <code>moments</code> package (uses formula 1).</p></li>
<li><p><code>Skewness()</code> function from the <code>sasLM</code> package (uses formula 2).</p></li>
<li><p><code>skew()</code> function from the <code>psych</code> package or <code>skewness()</code> function from the <code>e1071</code> package can calculate skewness using the three formulas by setting the <code>type</code> argument to either <img src="https://latex.codecogs.com/png.latex?1">, <img src="https://latex.codecogs.com/png.latex?2">, or <img src="https://latex.codecogs.com/png.latex?3">.</p></li>
</ul></li>
<li><p>The skewness standard error can be calculated using the <code>SkewnessSE()</code> function from the <code>sasLM</code> package.</p></li>
<li><p>For example, the skewness of the <code>insulin</code> variable from the <code>PimaIndiansDiabetes</code> dataset can be calculated as follows:</p>
<ul>
<li><p>First, let’s plot the density of the <code>insulin</code> variable:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load the library and dataset</span></span>
<span id="cb1-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mlbench)</span>
<span id="cb1-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(PimaIndiansDiabetes)</span>
<span id="cb1-4"></span>
<span id="cb1-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot density of the insulin variable</span></span>
<span id="cb1-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb1-7">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">density</span>(PimaIndiansDiabetes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>insulin, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">adjust =</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb1-8">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density plot of insulin"</span>,</span>
<span id="cb1-9">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb1-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0466c8"</span>,</span>
<span id="cb1-11">    )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B08_distrib_shape_stats_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># calculate skewness and its standard error</span></span>
<span id="cb2-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(psych)</span>
<span id="cb2-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sasLM)</span>
<span id="cb2-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(</span>
<span id="cb2-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Skewness ="</span>, </span>
<span id="cb2-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">skew</span>(PimaIndiansDiabetes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>insulin, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb2-7">    )</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Skewness = 2.272"</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(</span>
<span id="cb4-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Skewness SE ="</span>, </span>
<span id="cb4-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">SkewnessSE</span>(PimaIndiansDiabetes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>insulin), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb4-4">    )</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Skewness SE = 0.088"</code></pre>
</div>
</div></li>
</ul></li>
<li><p>These results are similar to the results obtained by <code>SPSS</code> or <code>Graphpad Prism</code>:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">SPSS</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">Graphpad Prism</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<p><img src="https://www.amrbiostats.com/images/skew_s.png" alt="SPSS" width="100%"></p>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<p><img src="https://www.amrbiostats.com/images/skew_g.png" alt="Graphpad Prism" width="100%"></p>
</div>
</div>
</div></li>
</ul>
</section>
</section>
<section id="kurtosis" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="kurtosis"><span class="header-section-number">3</span> Kurtosis</h2>
<ul>
<li><p>It is a measure of tail heaviness (tailedness) of a distribution.</p></li>
<li><p>It is described as the standardized fourth moment <img src="https://latex.codecogs.com/png.latex?(m_4)"> of the distribution about the mean.</p></li>
</ul>
<section id="formula-1" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="formula-1"><span class="header-section-number">3.1</span> Formula</h3>
<ul>
<li><p>There are three formulas to calculate excess kurtosis (we will use <strong>sample moments</strong>):</p>
<ol type="1">
<li><p><strong>Raw formula</strong> <img src="https://latex.codecogs.com/png.latex?g_2">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ag_2%20=%20%5Cdisplaystyle%20%5Cfrac%7Bm_4%7D%7Bm_2%5E2%7D%20-%203%0A"></p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?m_4"> is the fourth moment about the mean:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Am_4%20=%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bn%7D%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20(x_i%20-%20%5Cbar%7Bx%7D)%5E4%0A"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?m_2"> is the second moment about the mean:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Am_2%20=%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bn%7D%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20(x_i%20-%20%5Cbar%7Bx%7D)%5E2%0A"></p></li>
</ul></li>
<li><p><strong>Fisher’s</strong> <img src="https://latex.codecogs.com/png.latex?G_2">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AG_2%20=%20%5Cdisplaystyle%20%5Cfrac%7B(n%20+%201)g_2%20+%206%7D%7B(n%20-%202)(n%20-%203)%7D%0A"></p>
<ul>
<li>This formula is used by <code>SAS</code>, <code>SPSS</code>, <code>NCSS</code>, <code>Excel</code> (<code>KURT</code> function), and <code>Graphpad Prism</code>.</li>
</ul></li>
<li><p>Kurtosis <img src="https://latex.codecogs.com/png.latex?b_2">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ab_1%20=%20%5Cdisplaystyle%20%5Cfrac%7Bm_4%7D%7Bs%5E4%7D%20=%20(g_2%20+3)(1%20-%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bn%7D)%5E2%20-%203%0A"></p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?s"> is the sample standard deviation <img src="https://latex.codecogs.com/png.latex?%5Cbig%20%5Bs%20=%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bn-1%7D%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20(x_i%20-%20%5Cbar%7Bx%7D)%5E2%20%5Cbig%20%5D">.</p></li>
<li><p>This formula is used by <code>Minitab</code>.</p></li>
</ul></li>
</ol></li>
<li><p>The standard error of kurtosis is given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0ASE_%7Bkurtosis%7D%20=%20%5Csqrt%20%5Cfrac%7B24n(n-1)%5E2%7D%7B(n-3)(n-2)(n+3)(n+5)%7D%0A"></p></li>
</ul>
</section>
<section id="interpretation-1" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="interpretation-1"><span class="header-section-number">3.2</span> Interpretation</h3>
<ul>
<li><p>Normal distribution is usually used as a reference, which has a kurtosis of <img src="https://latex.codecogs.com/png.latex?3"> and is referred to as <code>mesokurtic</code>.</p></li>
<li><p>Unimodal distributions with kurtosis <img src="https://latex.codecogs.com/png.latex?%5Cgt%203"> possess heavier or thicker tails (i.e., more extreme values in the tails) relative to the normal distribution and are referred to as <code>leptokurtic</code>.</p></li>
<li><p>Unimodal distributions with kurtosis <img src="https://latex.codecogs.com/png.latex?%5Clt%203"> possess lighter or thinner tails relative to the normal distribution and are referred to as <code>platykurtic</code>.</p></li>
<li><p>The following figure shows different distributions and their kurtosis values:</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B08_distrib_shape_stats_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>As depicted in the above figure, the mesokuotic distribution is a normal distribution that has a kurtosis of <img src="https://latex.codecogs.com/png.latex?0"> because software packages express it as <strong>excess kurtosis</strong> <img src="https://latex.codecogs.com/png.latex?(Kurtosis%20-%203)">.</p></li>
<li><p>In this context, the leptokurtic distribution has a kurtosis <img src="https://latex.codecogs.com/png.latex?%5Cgt%200">, while the platykurtic distribution has a kurtosis <img src="https://latex.codecogs.com/png.latex?%5Clt%200">.</p></li>
</ul>
</section>
<section id="calculation-in-r-1" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="calculation-in-r-1"><span class="header-section-number">3.3</span> Calculation in R</h3>
<ul>
<li><p>Different functions in R can be used to calculate the kurtosis:</p>
<ul>
<li><p><code>kurtosis()</code> function from the <code>moments</code> package (uses formula 1 but as raw kurtosis, i.e., <img src="https://latex.codecogs.com/png.latex?m_4/m%5E2">).</p></li>
<li><p><code>Kurtosis()</code> function from the <code>sasLM</code> package (uses formula 2).</p></li>
<li><p><code>kurtosi()</code> function from the <code>psych</code> package or <code>kurtosis()</code> function from the <code>e1071</code> package can calculate skewness using the three formulas by setting the <code>type</code> argument to either <img src="https://latex.codecogs.com/png.latex?1">, <img src="https://latex.codecogs.com/png.latex?2">, or <img src="https://latex.codecogs.com/png.latex?3">.</p></li>
</ul></li>
<li><p>The skewness standard error can be calculated using the <code>KurtosisSE()</code> function from the <code>sasLM</code> package.</p></li>
<li><p>For example, the skewness of the <code>insulin</code> variable from the <code>PimaIndiansDiabetes</code> dataset can be calculated as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load the library and dataset</span></span>
<span id="cb6-2">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mlbench)</span>
<span id="cb6-3">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(PimaIndiansDiabetes)</span>
<span id="cb6-4"></span>
<span id="cb6-5">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># calculate kurtosis and its standard error</span></span>
<span id="cb6-6">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(psych)</span>
<span id="cb6-7">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sasLM)</span>
<span id="cb6-8">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(</span>
<span id="cb6-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Kurtosis ="</span>, </span>
<span id="cb6-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kurtosi</span>(PimaIndiansDiabetes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>insulin, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb6-11">        )</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Kurtosis = 7.214"</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(</span>
<span id="cb8-2">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Kurtosis SE ="</span>, </span>
<span id="cb8-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">KurtosisSE</span>(PimaIndiansDiabetes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>insulin), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb8-4">        )</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Kurtosis SE = 0.176"</code></pre>
</div>
</div></li>
<li><p>These results are similar to the results obtained by <code>SPSS</code> or <code>Graphpad Prism</code>:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true">SPSS</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" aria-controls="tabset-2-2" aria-selected="false">Graphpad Prism</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" aria-labelledby="tabset-2-1-tab">
<p><img src="https://www.amrbiostats.com/images/kurt_s.png" alt="SPSS" width="100%"></p>
</div>
<div id="tabset-2-2" class="tab-pane" aria-labelledby="tabset-2-2-tab">
<p><img src="https://www.amrbiostats.com/images/kurt_g.png" alt="Graphpad Prism" width="100%"></p>
</div>
</div>
</div></li>
</ul>
</section>
</section>
<section id="references" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="references"><span class="header-section-number">4</span> References</h2>
<ul>
<li><p>Daniel, W. W. and Cross, C. L. (2013). Biostatistics: A Foundation for Analysis in the Health Sciences, Tenth edition. Wiley</p></li>
<li><p>Heumann, C., Schomaker, M., and Shalabh (2022). Introduction to Statistics and Data Analysis: With Exercises, Solutions and Applications in R. Springer</p></li>
<li><p>Hoffman, J. (2019). Basic Biostatistics for Medical and Biomedical Practitioners, Second Edition. Academic Press</p></li>
<li><p>Lane, D. M. et al., (2019). Introduction to Statistics. Online Edition. Retrieved September 14, 2024, from https://openstax.org/details/introduction-statistics</p></li>
</ul>
<p><br></p>
</section>
<section id="add-your-comments" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="add-your-comments"><span class="header-section-number">5</span> Add your comments</h2>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <guid>https://www.amrbiostats.com/posts/biostats/B08_distrib_shape_stats.html</guid>
  <pubDate>Thu, 14 Nov 2024 20:00:00 GMT</pubDate>
  <media:content url="https://www.amrbiostats.com/images/biostats.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Demystifying sample variance formula</title>
  <link>https://www.amrbiostats.com/posts/biostats/B07_sample_variance_stats.html</link>
  <description><![CDATA[ 




<section id="background" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="background"><span class="header-section-number">1</span> Background</h2>
<ul>
<li><p>In the <a href="../../posts/biostats/B06_dispersion_stats.html">previous chapter</a>, we discussed the measures of variability.</p></li>
<li><p>Specifically, the variance was discussed as a measure of variability that quantifies how close the observations are to the mean.</p></li>
<li><p>Intuitively, this is achieved by calculating the average of deviations <img src="https://latex.codecogs.com/png.latex?(D">) of each observation from the mean:</p></li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0AD%20=%20%5Cfrac%7B1%7D%7Bn%7D%20%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20(x_i%20-%20%5Cbar%7Bx%7D)%0A"></p>
<ul>
<li>However, the sample variance <img src="https://latex.codecogs.com/png.latex?(s%5E2)"> is defined as the average of the squared differences (i.e., deviations) between each observation and the sample mean <img src="https://latex.codecogs.com/png.latex?(%5Cbar%7Bx%7D)">:</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0As%5E2%20=%20%5Cfrac%7B1%7D%7Bn-1%7D%20%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20(x_i%20-%20%5Cbar%7Bx%7D)%5E2%0A"></p>
<ul>
<li><p>The above formula has two distinct differences from the previous intuitive definition, namely:</p>
<p><i class="bi bi-1-circle-fill" style="color: #0171c3; font-size: 22px;"></i> <strong>Using squared deviations instead of the deviations themselves</strong>:</p>
<ul>
<li><p>In a <a href="../../posts/biostats/B03_cent_tendency_stats.html#sec-mean">previous chapter</a>, we described that the sum of deviations of the observations from the arithmetic mean is always zero because the negative deviations cancel out the positive deviations. This cuses the variance to be zero.</p></li>
<li><p>Therefore, squaring the deviations overcomes this issue by making all deviations positive.</p></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Cancelling out of positive and negative deviations can also be achieved by taking the absolute value of the deviations resulting in a measure called the mean absolute deviation from the mean.</p></li>
<li><p>However, squaring the deviations is preferred for many reasons, for instance:</p>
<ul>
<li><p>The squared function is differentiable everywhere, while the absolute value function is not differentiable at zero. Differentiability is important for many statistical and optimization algorithms.</p></li>
<li><p>The squared deviations give more weight to larger deviations.</p></li>
<li><p>The squaring used in the variance is closely linked to the normal distribution function (that also involves a squared deviation term), which is a cornerstone in most statistical methods.</p></li>
<li><p>The squared deviations of observations of any given value is minimized when the mean of the observations is used as the reference point, while the mean absolute deviation is minimized when the median is used as the reference point.</p></li>
</ul></li>
</ul>
</div>
</div>
<p><i class="bi bi-2-circle-fill" style="color: #0171c3; font-size: 22px;"></i> <strong>The denominator is</strong> <img src="https://latex.codecogs.com/png.latex?(n-1)"> instead of <img src="https://latex.codecogs.com/png.latex?(n)">:</p>
<ul>
<li><p>This is known as Bessel’s correction (obtained by multiplying the uncorrected sample variance <img src="https://latex.codecogs.com/png.latex?s%5E2_n%20=%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bn%7D%20%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20(x_i%20-%20%5Cbar%7Bx%7D)%5E2"> by <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cfrac%7Bn%7D%7Bn-1%7D">) and is used to correct the bias in the estimation of the population variance from the sample variance.</p></li>
<li><p>When using a sample to estimate the population variance, the population mean is unknown, in most of the cases, so the sample mean <img src="https://latex.codecogs.com/png.latex?(%5Cbar%7Bx%7D)"> is used to estimate the population mean <img src="https://latex.codecogs.com/png.latex?(%5Cmu)">.</p></li>
<li><p>Using <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D"> as an estimate of <img src="https://latex.codecogs.com/png.latex?%5Cmu"> results in underestimation of the population variance, <strong>particularly when the sample size is small</strong>. This happens because the sum of squares of the deviations of the observations from the sample mean will always be smaller than the sum of squares of the deviations of the observations from the population mean (except when <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D%20=%20%5Cmu">).</p></li>
<li><p>Therefore, using <img src="https://latex.codecogs.com/png.latex?(n-1)"> in the denominator corrects this underestimation and makes the sample variance an unbiased estimator of the population variance.</p></li>
<li><p>Let’s illustrate this concept with a simple simulation:</p>
<ul>
<li><p>Assume that we have a population of <img src="https://latex.codecogs.com/png.latex?1000"> observations:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb1-2">population <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb1-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(</span>
<span id="cb1-4">       <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, </span>
<span id="cb1-5">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, </span>
<span id="cb1-6">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb1-7">    )</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(</span>
<span id="cb1-9">   population, </span>
<span id="cb1-10">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population Distribution"</span>, </span>
<span id="cb1-11">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Values"</span>, </span>
<span id="cb1-12">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span></span>
<span id="cb1-13">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B07_sample_variance_stats_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>The population mean and variance are:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(</span>
<span id="cb2-2">   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population mean: "</span>, </span>
<span id="cb2-3">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(population), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb2-4">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Population mean:  50.16"</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">var.population <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb4-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((population <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(population))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(population)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(</span>
<span id="cb4-5">   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population variance: "</span>, </span>
<span id="cb4-6">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(var.population, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb4-7">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Population variance:  98.25"</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>In this particular example, the population mean and variance are known because this is a simulation and we generated the data.</p></li>
<li><p>In practice, the population mean and variance are <strong>unknown</strong> and we use the sample mean and variance to estimate them.</p></li>
</ul>
</div>
</div></li>
<li><p>Now, let’s draw a sample of <img src="https://latex.codecogs.com/png.latex?10"> observations from this population and calculate the uncorrected sample variance:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">sample <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(population, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(</span>
<span id="cb6-4">   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample mean: "</span>, </span>
<span id="cb6-5">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(sample), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb6-6">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sample mean:  50.45"</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">var.sample <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb8-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((sample <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(sample))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(sample)</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(</span>
<span id="cb8-5">   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Uncorrected sample variance: "</span>, </span>
<span id="cb8-6">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(var.sample, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb8-7">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Uncorrected sample variance:  89.63"</code></pre>
</div>
</div></li>
<li><p>As you can see that the <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D%20=%2050.45"> and is used as an unbiased estimator of the population mean <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%2050.16">, however, the uncorrected sample variance <img src="https://latex.codecogs.com/png.latex?s_n%5E2%20=%2089.63"> underestimates the population variance <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E2%20=%2098.25">.</p></li>
<li><p>Let’s apply Bessel’s correction to the sample variance:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">var.sample.corrected <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb10-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((sample <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(sample))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(sample) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The same result can be also obtained using var(sample)</span></span>
<span id="cb10-5"></span>
<span id="cb10-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(</span>
<span id="cb10-7">   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Corrected sample variance: "</span>, </span>
<span id="cb10-8">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(var.sample.corrected, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb10-9">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Corrected sample variance:  99.59"</code></pre>
</div>
</div></li>
<li><p>The corrected sample variance is <img src="https://latex.codecogs.com/png.latex?s%5E2%20=%2099.59"> is closer to the population variance than the uncorrected sample variance.</p></li>
<li><p>On repeated sampling (i.e., taking many samples with the same size and calculating the sample variance for each sample), the average of the corrected sample variances will be closer to the population variance than the average of the uncorrected sample variances (i.e., the corrected sample variance is an unbiased estimator of the population variance):</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb12-2">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb12-3">sample.var.uncor <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n)</span>
<span id="cb12-4"></span>
<span id="cb12-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n) {</span>
<span id="cb12-6">    sample <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(population, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb12-7">    sample.var.uncor[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb12-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((sample <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(sample))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(sample))</span>
<span id="cb12-9">}</span>
<span id="cb12-10"></span>
<span id="cb12-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(</span>
<span id="cb12-12">   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean of 1000 uncorrected sample variances: "</span>, </span>
<span id="cb12-13">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(sample.var.uncor), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb12-14">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean of 1000 uncorrected sample variances:  88.79"</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">sample.var.cor <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n)</span>
<span id="cb14-2"></span>
<span id="cb14-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n) {</span>
<span id="cb14-4">    sample <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(population, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb14-5">    sample.var.cor[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb14-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((sample <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(sample))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(sample) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb14-7">}</span>
<span id="cb14-8"></span>
<span id="cb14-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(</span>
<span id="cb14-10">   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean of 1000 corrected sample variances: "</span>, </span>
<span id="cb14-11">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(sample.var.cor), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb14-12">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean of 1000 corrected sample variances:  98.32"</code></pre>
</div>
</div></li>
</ul></li>
<li><p>The division by <img src="https://latex.codecogs.com/png.latex?(n-1)"> in the sample variance formula can also be viewed as a way to adjust for the loss of one <strong>degree of freedom</strong> when estimating the population variance from the sample variance:</p>
<ul>
<li><p>Degrees of freedom <img src="https://latex.codecogs.com/png.latex?(df)"> is a mathematical concept that refers to the number of independent pieces of information that are free to vary in the presence of a set of constraints.</p></li>
<li><p>This concept will be revisited in upcoming chapters.</p></li>
<li><p>Let’s consider a simple example to understand this concept:</p>
<ul>
<li><p>Assume that we have <img src="https://latex.codecogs.com/png.latex?5"> boxes that each needs to be filled with a real number such that the sum of the numbers is <img src="https://latex.codecogs.com/png.latex?10"> (this is referred to as a <strong>constraint</strong>) and we ask <img src="https://latex.codecogs.com/png.latex?5"> persons to choose the numbers they like as illustrated in the following image: <img src="https://www.amrbiostats.com/images/df.jpg" class="img-fluid"></p></li>
<li><p>The first person <i class="bi bi-person-fill" style="color: #0171c3; font-size: 22px;"></i> is free to choose any real number; he chooses <img src="https://latex.codecogs.com/png.latex?5"> to fill the first box without being constrained by the sum of the numbers.</p></li>
<li><p>The second person <i class="bi bi-person-fill" style="color: red; font-size: 22px;"></i> is also free to choose any real number; he chooses <img src="https://latex.codecogs.com/png.latex?2"> to fill the second box without being constrained by the sum of the numbers.</p></li>
<li><p>The third person <i class="bi bi-person-fill" style="color: darkgreen; font-size: 22px;"></i> is also free to choose any real number; he chooses <img src="https://latex.codecogs.com/png.latex?-3"> to fill the third box without being constrained by the sum of the numbers.</p></li>
<li><p>The fourth person <i class="bi bi-person-fill" style="color: orange; font-size: 22px;"></i> is also free to choose any real number; he chooses <img src="https://latex.codecogs.com/png.latex?7"> to fill the fourth box without being constrained by the sum of the numbers.</p></li>
<li><p>On the other contrary, the fifth person <i class="bi bi-person-fill" style="color: #89caf2; font-size: 22px;"></i> is not free to choose any real number; he must choose the number <img src="https://latex.codecogs.com/png.latex?-1"> to fill the fifth box in order to satisfy the constraint that the sum of the numbers is <img src="https://latex.codecogs.com/png.latex?10">.</p></li>
<li><p>Therefore, there are only <img src="https://latex.codecogs.com/png.latex?4"> independent pieces of information that are free to vary (i.e., the first four persons).</p></li>
<li><p>The fifth person is not free to choose any real number rather his choice is dependent on the choices of the first four persons due to the constraint imposed on the sum of the numbers.</p></li>
<li><p>Therefore, we say that we lose one degree of freedom (i.e., <img src="https://latex.codecogs.com/png.latex?df%20=%20n%20-%201">).</p></li>
<li><p>This concept is also applicable to the estimation of the sample variance; which involves the estimation of <img src="https://latex.codecogs.com/png.latex?%5Cmu"> from <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D">. Using <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D"> in the calculation of the sample variance implies that the pieces of informatios <img src="https://latex.codecogs.com/png.latex?(x_1%20-%20%5Cbar%7Bx%7D)%5E2,%20(x_2%20-%20%5Cbar%7Bx%7D)%5E2,%20%5Cldots,%20(x_n%20-%20%5Cbar%7Bx%7D)%5E2">, which are used for the computation of the variance, are not independent because they are constrained by the <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D">. Simply, there are only <img src="https://latex.codecogs.com/png.latex?n-1"> independent observations that are free to vary, while the last one can be determined by from the first <img src="https://latex.codecogs.com/png.latex?n-1"> observations and <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D">).</p></li>
</ul></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Generally, the degrees of freedom for an estimate is equal to the number of observations minus the number of population parameters estimated while calculating the estimate in question.</p></li>
<li><p>Applying this rule to the sample variance, we estimate the population mean <img src="https://latex.codecogs.com/png.latex?%5Cmu"> from the sample mean <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D">, which is one parameter estimated from the sample while computing the sample variance. Therefore, the degrees of freedom for the sample variance is <img src="https://latex.codecogs.com/png.latex?n%20-%201">.</p></li>
</ul>
</div>
</div>
</section>
<section id="references" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="references"><span class="header-section-number">2</span> References</h2>
<ul>
<li>Lane, D (2023). Introductory Statistics. Retrieved September 14, 2024, from https://stats.libretexts.org/Bookshelves/Introductory_Statistics/Introductory_Statistics_(Lane)</li>
</ul>
<p><br></p>
</section>
<section id="add-your-comments" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="add-your-comments"><span class="header-section-number">3</span> Add your comments</h2>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <guid>https://www.amrbiostats.com/posts/biostats/B07_sample_variance_stats.html</guid>
  <pubDate>Sat, 09 Nov 2024 20:00:00 GMT</pubDate>
  <media:content url="https://www.amrbiostats.com/images/biostats.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Measures of Variability</title>
  <link>https://www.amrbiostats.com/posts/biostats/B06_dispersion_stats.html</link>
  <description><![CDATA[ 




<section id="background" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="background"><span class="header-section-number">1</span> Background</h2>
<ul>
<li><p>Variability describes how the observations are dispersed around the center of the data.</p></li>
<li><p>The terms <code>variability</code> and <code>dispersion</code> are used interchangeably.</p></li>
<li><p>Two distributions can have the same mean but different variability (as depicted in the figure below).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B06_dispersion_stats_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Despite having the same mean represented by the red vertical line, the blue distribution has a higher variability than the green distribution (i.e., the observations are more dispersed around the mean).</li>
</ul></li>
<li><p>Therefore, it is important to report a measure of variability along with the measure of central tendency to provide a complete description of the data.</p></li>
</ul>
</section>
<section id="measures-of-variability" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="measures-of-variability"><span class="header-section-number">2</span> Measures of variability</h2>
<ul>
<li>In the following sections, we will discuss the most commonly used measures of variability.</li>
</ul>
<section id="range" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="range"><span class="header-section-number">2.1</span> Range</h3>
<ul>
<li>The range <img src="https://latex.codecogs.com/png.latex?(R)"> is defined as the difference between the maximum and minimum value of the data.</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0AR%20=%20x_%7B%5Ctext%7Bmax%7D%7D%20-%20x_%7B%5Ctext%7Bmin%7D%7D%0A"></p>
<ul>
<li><p>The range considers only two observations, so its use is limited.</p></li>
<li><p>It is sensitive to extreme values.</p></li>
<li><p>Because infinite number of distributions can have different maximum and minimum values but the same range, it can be helpful to report the range as the <img src="https://latex.codecogs.com/png.latex?%5Bx_%7B%5Ctext%7Bmin%7D%7D,%5C%20x_%7B%5Ctext%7Bmax%7D%7D%5D">. This approach conveys more information about the data.</p></li>
<li><p>Example: the range of the variable <code>mpg</code> in the <code>mtcars</code> dataset is calculated in R using the <code>range()</code> function:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.4 33.9</code></pre>
</div>
</div>
<ul>
<li>The output is a vector of two values representing the minimum and maximum values, respectively.</li>
</ul></li>
</ul>
</section>
<section id="interquartile-range-iqr" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="interquartile-range-iqr"><span class="header-section-number">2.2</span> Interquartile Range (IQR)</h3>
<ul>
<li>It is defined as the difference between the third quartile <img src="https://latex.codecogs.com/png.latex?(Q_3)"> and the first quartile <img src="https://latex.codecogs.com/png.latex?(Q_1)">;</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0AIQR%20=%20Q_3%20-%20Q_1%0A"></p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?IQR"> reflects the variability among the middle <img src="https://latex.codecogs.com/png.latex?50%5C%25"> of the observations:</p>
<ul>
<li><p>If <img src="https://latex.codecogs.com/png.latex?IQR"> is large, it inidicates a large amount of variability.</p></li>
<li><p>If <img src="https://latex.codecogs.com/png.latex?IQR"> is small, it indicates a small amount of variability.</p></li>
</ul></li>
<li><p>The IQR is calculated in R using the <code>IQR()</code> function as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">IQR</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.375</code></pre>
</div>
</div></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>The <code>summary()</code> function in R can be used to get the minimum, <img src="https://latex.codecogs.com/png.latex?Q_1">, median, <img src="https://latex.codecogs.com/png.latex?Q_3">, and maximum values of a variable. In addition, it provides the counts of missing values, if any.</p></li>
<li><p>For example, the summary of the variable <code>mpg</code> in the <code>mtcars</code> dataset is obtained as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  10.40   15.43   19.20   20.09   22.80   33.90 </code></pre>
</div>
</div></li>
</ul>
</div>
</div>
</section>
<section id="variance" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="variance"><span class="header-section-number">2.3</span> Variance</h3>
<ul>
<li>The variance measures the variability relative to the scatter of the observations about their mean.</li>
</ul>
<section id="population-variance" class="level4" data-number="2.3.1">
<h4 data-number="2.3.1" class="anchored" data-anchor-id="population-variance"><span class="header-section-number">2.3.1</span> Population variance</h4>
<ul>
<li>Finite population variance <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E2"> is defined as the mean of the squared differences (i.e., deviations) between each observation and the population mean <img src="https://latex.codecogs.com/png.latex?(%5Cmu)">:</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csigma%5E2%20=%5Cdisplaystyle%20%5Cfrac%7B1%7D%7BN%7D%20%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7BN%7D%20(x_i%20-%20%5Cmu)%5E2%20=%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7BN%7D%20%5CBig%20(%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7BN%7D%20x_i%5E2%20-%20%5Cfrac%20%7B%5Cdisplaystyle%20%5Cbig%20(%5Csum_%7Bi=1%7D%5E%7BN%7D%20x_i%20%5Cbig)%5E2%7D%7BN%7D%20%5CBig)%0A"></p>
</section>
<section id="sample-variance" class="level4" data-number="2.3.2">
<h4 data-number="2.3.2" class="anchored" data-anchor-id="sample-variance"><span class="header-section-number">2.3.2</span> Sample variance</h4>
<ul>
<li>Sample variance <img src="https://latex.codecogs.com/png.latex?(s%5E2)"> is defined as the mean of the squared differences (i.e., deviations) between each observation and the sample mean <img src="https://latex.codecogs.com/png.latex?(%5Cbar%7Bx%7D)">:</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0As%5E2%20=%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bn-1%7D%20%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20(x_i%20-%20%5Cbar%7Bx%7D)%5E2%20=%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bn-1%7D%20%5CBig%20(%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20x_i%5E2%20-%20%5Cfrac%20%7B%5Cdisplaystyle%20%5Cbig%20(%5Csum_%7Bi=1%7D%5E%7Bn%7D%20x_i%20%5Cbig)%5E2%7D%7Bn%7D%20%5CBig)%0A"></p>
<ul>
<li><p>More detailed discussion on the sample variance formula is provided <a href="../../posts/biostats/B07_sample_variance_stats.html">here</a>.</p></li>
<li><p>The sample variance is calculated in R using the <code>var()</code> function as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36.3241</code></pre>
</div>
</div></li>
<li><p>The above value is the same if we calculate the variance manually using the above formula:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span>
<span id="cb9-2">mean_mpg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> mean_mpg)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36.3241</code></pre>
</div>
</div></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" style="color:#0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>The expression <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7BN%7D%20(x_i%20-%20%5Cmu)%5E2"> or <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bn%7D(x_i%20-%20%5Cbar%7Bx%7D)%5E2"> is referred to as sum of squares <img src="https://latex.codecogs.com/png.latex?SS">.</p></li>
<li><p>The unit of the variance is the square of the units of the observations making interpretation difficult.</p></li>
</ul>
</div>
</div>
</section>
</section>
<section id="standard-deviation" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="standard-deviation"><span class="header-section-number">2.4</span> Standard Deviation</h3>
<ul>
<li>The standard deviation <img src="https://latex.codecogs.com/png.latex?(s)"> is the square root of the variance.</li>
</ul>
<section id="population-standard-deviation" class="level4" data-number="2.4.1">
<h4 data-number="2.4.1" class="anchored" data-anchor-id="population-standard-deviation"><span class="header-section-number">2.4.1</span> Population standard deviation</h4>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csigma%20=%20%5Csqrt%7B%5Csigma%5E2%7D%20=%20%5Csqrt%7B%5Cdisplaystyle%20%5Cfrac%7B1%7D%7BN%7D%20%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7BN%7D%20(x_i%20-%20%5Cmu)%5E2%7D%20%20%20%0A"></p>
</section>
<section id="sample-standard-deviation" class="level4" data-number="2.4.2">
<h4 data-number="2.4.2" class="anchored" data-anchor-id="sample-standard-deviation"><span class="header-section-number">2.4.2</span> Sample standard deviation</h4>
<p><img src="https://latex.codecogs.com/png.latex?%0As%20=%20%5Csqrt%7Bs%5E2%7D%20=%20%20%5Csqrt%7B%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bn-1%7D%20%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20(x_i%20-%20%5Cbar%7Bx%7D)%5E2%7D%20%20%20%0A"></p>
<ul>
<li><p>The sample standard deviation is calculated in R using the <code>sd()</code> function as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.026948</code></pre>
</div>
</div></li>
<li><p>The above value is the same if we take the square root of the sample variance:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.026948</code></pre>
</div>
</div></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" style="color:#0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>The standard deviation is more interpretable than the variance because it has the original unit of the observations.</p></li>
<li><p>Therefore, it is preferred as a measure of variability.</p></li>
<li><p>Similar to the variance, the standard deviation measures how much the observations are scattered around the mean (i.e., the average difference of the observations from the mean), therefore:</p>
<ul>
<li><p>A low value of the standard deviation implies that the observations are more concentrated around the mean (i.e., low variability).</p></li>
<li><p>A high value of the standard deviation implies that the observations are more scattered around the mean (i.e., high variability).</p></li>
</ul></li>
</ul>
</div>
</div>
</section>
</section>
<section id="coefficient-of-variation" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="coefficient-of-variation"><span class="header-section-number">2.5</span> Coefficient of Variation</h3>
<ul>
<li><p>Assume that we want to compare the variability of two or more variables.</p></li>
<li><p>Although the standard deviation is an appropriate measure of variability, it is not suitable for making this comparison directly because the variables might have different units causing the means to differ substantially. This also applies even if the variables are measured in the same units but have different means (differences in the standard deviation might be due to differences in the means not due to differences in the variability).</p></li>
<li><p>Therefore, a relative measure of variability is needed that is independent of the unit of measurement or the mean.</p></li>
<li><p>The coefficient of variation <img src="https://latex.codecogs.com/png.latex?(CV)"> is defined as the ratio of the standard deviation to the mean expressed as a percentage:</p></li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0ACV%20=%20%5Cdisplaystyle%20%5Cfrac%7Bs%7D%7B%5Cbar%7Bx%7D%7D%20%5Ctimes%20(100)%20%5C%25%0A"></p>
<ul>
<li>It is unitless and is independent of the mean.</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">Example B.6.1 <iconify-icon inline="" icon="ic:round-menu-book" style="font-size: 21px;" aria-label="Icon round-menu-book from ic Iconify.design set." title="Icon round-menu-book from ic Iconify.design set."></iconify-icon></a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false"><span style="color: #ba181b">Exercise B.6.1 <iconify-icon inline="" icon="fluent:chat-bubbles-question-20-filled" style="font-size: 21px;" aria-label="Icon chat-bubbles-question-20-filled from fluent Iconify.design set." title="Icon chat-bubbles-question-20-filled from fluent Iconify.design set."></iconify-icon></span></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<ul>
<li><p>The mean and standard deviation of the glucose and cholesterol levels of 10 subjects are given below:</p>
<ul>
<li><p>Glucose: <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D_%7B%5Ctext%7Bglucose%7D%7D%20=%20120"> mg/dL, <img src="https://latex.codecogs.com/png.latex?s_%7B%5Ctext%7Bglucose%7D%7D%20=%2015"> mg/dL</p></li>
<li><p>Cholesterol: <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D_%7B%5Ctext%7Bcholesterol%7D%7D%20=%20200"> mg/dL, <img src="https://latex.codecogs.com/png.latex?s_%7B%5Ctext%7Bcholesterol%7D%7D%20=%2020"> mg/dL</p></li>
</ul></li>
<li><p>The coefficient of variation for glucose and cholesterol levels can be calculated as follows:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?CV_%7B%5Ctext%7Bglucose%7D%7D%20=%20%5Cdisplaystyle%20%5Cfrac%7B15%7D%7B120%7D%20%5Ctimes%20100%5C%25%20=%2012.5%5C%25"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?CV_%7B%5Ctext%7Bcholesterol%7D%7D%20=%20%5Cdisplaystyle%20%5Cfrac%7B20%7D%7B200%7D%20%5Ctimes%20100%5C%25%20=%2010%5C%25"></p></li>
</ul></li>
<li><p>Based on the results, we can conclude that the cholesterol levels are less variable than the glucose levels (even though the standard deviation of cholesterol levels is higher than that of glucose levels).</p></li>
<li><p>Using the standard deviation to compare the variability would have led to the opposite conclusion.</p></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<ul>
<li><p>Load the <code>PimaIndiansDiabetes</code> dataset.</p>
<p>Which of the following variables has the highest variability??</p>
<div id="radio_RTZEGRRJEP" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_RTZEGRRJEP" value=""> <span>glucose</span></label><label><input type="radio" autocomplete="off" name="radio_RTZEGRRJEP" value="answer"> <span>pressure</span></label><label><input type="radio" autocomplete="off" name="radio_RTZEGRRJEP" value=""> <span>mass</span></label>
</div></li>
</ul>
</div>
</div>
</div>
</section>
<section id="median-absolute-deviation-mad" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="median-absolute-deviation-mad"><span class="header-section-number">2.6</span> Median Absolute Deviation (MAD)</h3>
<ul>
<li><p>The standard deviation is based on the mean, so it is also sensitive to outliers.</p></li>
<li><p>Median Absolute Deviation (MAD) is a more robust measure of variability than the standard deviation.</p></li>
<li><p>It is calculated based on the median of the observations and is defined as the median of the absolute deviations of the observations from the median:</p></li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7BMAD%7D%20=%20%5Ctext%7Bmedian%7D(%7Cx_i%20-%20%5Ctext%7Bmedian%7D(x)%7C)%0A"></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true">Example B.6.2 <iconify-icon inline="" icon="ic:round-menu-book" style="font-size: 21px;" aria-label="Icon round-menu-book from ic Iconify.design set." title="Icon round-menu-book from ic Iconify.design set."></iconify-icon></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" aria-labelledby="tabset-2-1-tab">
<ul>
<li><p>Calculate <img src="https://latex.codecogs.com/png.latex?MAD"> for the following observations: <img src="https://latex.codecogs.com/png.latex?2,%205,%206,%208,%2015">.</p></li>
<li><p>The median of the observations is <img src="https://latex.codecogs.com/png.latex?6">.</p></li>
<li><p>The absolute deviations from the median are <img src="https://latex.codecogs.com/png.latex?%7C2-6%7C%20=%204">, <img src="https://latex.codecogs.com/png.latex?%7C5-6%7C%20=%201">, <img src="https://latex.codecogs.com/png.latex?%7C6-6%7C%20=%200">, <img src="https://latex.codecogs.com/png.latex?%7C8-6%7C%20=%202">, and <img src="https://latex.codecogs.com/png.latex?%7C15-6%7C%20=%209">.</p></li>
<li><p>Arrange the absolute deviations in ascending order: <img src="https://latex.codecogs.com/png.latex?0,%201,%202,%204,%209">.</p></li>
<li><p>The median of the absolute deviations <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BMAD%7D%20=%202">.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" style="color:#0466c8;" title="MAD of normal distribution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
MAD of normal distribution
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>If the distribution of a variable is normal (i.e., Gaussian), the following relationships hold:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csigma%20%5Capprox%201.4826%20%5Ctimes%20%5Ctext%7BMAD%7D"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BIQR%7D%20%5Capprox%202%20%5Ctimes%20%5Ctext%7BMAD%7D"></p></li>
</ul></li>
</ul>
</div>
</div>
<ul>
<li><p>MAD can be calculated in R using the <code>mad()</code> function as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mad</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.9652</code></pre>
</div>
</div>
<ul>
<li>The result <img src="https://latex.codecogs.com/png.latex?(2.9652)"> is different from our manual calculation <img src="https://latex.codecogs.com/png.latex?(2)"> because the <code>mad()</code> function in R scales the <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BMAD%7D"> by a constant factor of <img src="https://latex.codecogs.com/png.latex?1.4826"> for a normal distribution <img src="https://latex.codecogs.com/png.latex?(2%20%5Ctimes%201.4826%20=%202.9652)">.</li>
</ul></li>
</ul>
</section>
</section>
<section id="references" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="references"><span class="header-section-number">3</span> References</h2>
<ul>
<li><p>Daniel, W. W. and Cross, C. L. (2013). Biostatistics: A Foundation for Analysis in the Health Sciences, Tenth edition. Wiley</p></li>
<li><p>Heumann, C., Schomaker, M., and Shalabh (2022). Introduction to Statistics and Data Analysis: With Exercises, Solutions and Applications in R. Springer</p></li>
<li><p>Hoffman, J. (2019). Basic Biostatistics for Medical and Biomedical Practitioners, Second Edition. Academic Press</p></li>
<li><p>Lane, D. M. et al., (2019). Introduction to Statistics. Online Edition. Retrieved September 14, 2024, from https://openstax.org/details/introduction-statistics</p></li>
</ul>
<p><br></p>
</section>
<section id="add-your-comments" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="add-your-comments"><span class="header-section-number">4</span> Add your comments</h2>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <guid>https://www.amrbiostats.com/posts/biostats/B06_dispersion_stats.html</guid>
  <pubDate>Tue, 05 Nov 2024 20:00:00 GMT</pubDate>
  <media:content url="https://www.amrbiostats.com/images/biostats.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Boxplot</title>
  <link>https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<ul>
<li><p>A boxplot is used to graphically represent the distribution of numerical and ordinal data.</p></li>
<li><p>In addition, it is helpful in identifying outliers.</p></li>
</ul>
</section>
<section id="components-of-boxplot" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="components-of-boxplot"><span class="header-section-number">2</span> Components of boxplot</h2>
<ul>
<li>It consists of a box and two vertical lines (whiskers) extending from the box.</li>
</ul>
<ul>
<li><p>For example, consider the following two boxplots:</p>
<p><img src="https://www.amrbiostats.com/images/boxplot.jpg" class="img-fluid"></p>
<ul>
<li><p><strong>The Box</strong>:</p>
<ul>
<li><p>It has has three horizontal lines (hinges).</p>
<ol type="1">
<li><p>The bottom line <i class="bi bi-1-circle-fill" style="color: #0171c3; font-size: 22px;"></i> represents the <img src="https://latex.codecogs.com/png.latex?25%5E%7Bth%7D"> percentile (first quartile, <img src="https://latex.codecogs.com/png.latex?Q_1">).</p></li>
<li><p>The middle line <i class="bi bi-2-circle-fill" style="color: #0171c3; font-size: 22px;"></i> represents the <img src="https://latex.codecogs.com/png.latex?50%5E%7Bth%7D"> percentile (median, <img src="https://latex.codecogs.com/png.latex?Q_2">).</p></li>
<li><p>The top line <i class="bi bi-3-circle-fill" style="color: #0171c3; font-size: 22px;"></i> represents the <img src="https://latex.codecogs.com/png.latex?75%5E%7Bth%7D"> percentile (third quartile, <img src="https://latex.codecogs.com/png.latex?Q_3">).</p></li>
</ol></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
IQR
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The difference between the <img src="https://latex.codecogs.com/png.latex?Q_3"> and <img src="https://latex.codecogs.com/png.latex?Q_1"> is referred to as the `interquartile range (IQR)’, which is a measure of the spread of the middle <img src="https://latex.codecogs.com/png.latex?50%5C%25"> of the data and will be discussed later under the measures of dispersion.</li>
</ul>
</div>
</div></li>
<li><p><strong>The Whiskers</strong>:</p>
<ul>
<li><p>The whiskers extend from the box to the minimum <i class="bi bi-4-circle-fill" style="color: darkgreen; font-size: 22px;"></i> and maximum <i class="bi bi-5-circle-fill" style="color: darkgreen; font-size: 22px;"></i> if they are contained within <img src="https://latex.codecogs.com/png.latex?Q1%20-%20(1.5%20%5Ctimes%20%5Ctext%7BIQR%7D)"> and <img src="https://latex.codecogs.com/png.latex?Q3%20+%20(1.5%20%5Ctimes%20%5Ctext%7BIQR%7D)"> as shown in the boxplot <img src="https://latex.codecogs.com/png.latex?A"> to the left panel.</p></li>
<li><p>On the other hand, the whiskers are capped by short horizontal lines <i class="bi bi-6-circle-fill" style="color: orange; font-size: 22px;"></i> and <i class="bi bi-7-circle-fill" style="color: orange; font-size: 22px;"></i> (inner fences, IF) at <img src="https://latex.codecogs.com/png.latex?Q1%20-%20(1.5%20%5Ctimes%20%5Ctext%7BIQR%7D)"> and <img src="https://latex.codecogs.com/png.latex?Q3%20+%20(1.5%20%5Ctimes%20%5Ctext%7BIQR%7D)"> if there are values outside this range as shown in the boxplot <img src="https://latex.codecogs.com/png.latex?B"> to the right panel. These fences are also referred to as <strong>Tukey’s fences</strong>.</p></li>
<li><p>Additionally, the boxplot <img src="https://latex.codecogs.com/png.latex?B"> shows short horizontal lines <i class="bi bi-8-circle-fill" style="color: red; font-size: 22px;"></i> and <i class="bi bi-9-circle-fill" style="color: red; font-size: 22px;"></i> that are referred to as outer fences (OF) and are located at <img src="https://latex.codecogs.com/png.latex?Q1%20-%20(3%20%5Ctimes%20%5Ctext%7BIQR%7D)"> and <img src="https://latex.codecogs.com/png.latex?Q3%20+%20(3%20%5Ctimes%20%5Ctext%7BIQR%7D)">. However, the outer fences are not shown on the boxplot by default in R.</p></li>
</ul></li>
<li><p><strong>Outliers</strong>:</p>
<ul>
<li><p>Grubbs defined outlier as “an observation that deviates markedly from other members of the sample in which it occurs.”</p></li>
<li><p>The values <img src="https://www.amrbiostats.com/images/10.svg" style="vertical-align: bottom; display: inline-block" width="30" height="30"> located between the inner and outer fences are termed minor outliers (Boxplot <img src="https://latex.codecogs.com/png.latex?B">).</p></li>
<li><p>The values <img src="https://www.amrbiostats.com/images/11.png" style="vertical-align: middle; display: inline-block" width="35" height="35"> located beyond the outer fences are termed major outliers (Boxplot <img src="https://latex.codecogs.com/png.latex?B">).</p></li>
<li><p>The function <code>identify_outliers()</code> from the <code>rstatix</code> package can be used to identify outliers based on Tukey’s method</p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="creating-boxplots-in-r" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="creating-boxplots-in-r"><span class="header-section-number">3</span> Creating Boxplots in R</h2>
<ul>
<li><p>As an example, we will use the <code>pressure</code> variable from the <code>PimaIndiansDiabetes</code> dataset which is available in the <code>mlbench</code> package or <code>Sepal.Width</code> variable from the <code>iris</code> dataset, which is available in base R.</p></li>
<li><p>So, the first step is to load the required libraries and datasets:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mlbench)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(PimaIndiansDiabetes)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(iris)</span></code></pre></div>
</details>
</div></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">Base R</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">ggplot2</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" aria-controls="tabset-1-3" aria-selected="false">car</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<ul>
<li>The following figure shows the default boxplot in R with the fences at <img src="https://latex.codecogs.com/png.latex?Q1%20-%20(1.5%20%5Ctimes%20%5Ctext%7BIQR%7D)"> and <img src="https://latex.codecogs.com/png.latex?Q3%20+%20(1.5%20%5Ctimes%20%5Ctext%7BIQR%7D)">.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(</span>
<span id="cb2-2">  PimaIndiansDiabetes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pressure, </span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb2-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Boxplot of the diastolic blood pressure"</span>,</span>
<span id="cb2-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diastolic blood pressure (mm Hg)"</span></span>
<span id="cb2-6">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>The outlying observation can be identified using the function <code>identify_outliers()</code> from the <code>rstatix</code> package as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rstatix)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'rstatix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">PimaIndiansDiabetes <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(pressure) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">identify_outliers</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    pressure is.outlier is.extreme
8          0       TRUE       TRUE
16         0       TRUE       TRUE
19        30       TRUE      FALSE
44       110       TRUE      FALSE
50         0       TRUE       TRUE
61         0       TRUE       TRUE
79         0       TRUE       TRUE
82         0       TRUE       TRUE
85       108       TRUE      FALSE
107      122       TRUE      FALSE
126       30       TRUE      FALSE
173        0       TRUE       TRUE
178      110       TRUE      FALSE
194        0       TRUE       TRUE
223        0       TRUE       TRUE
262        0       TRUE       TRUE
267        0       TRUE       TRUE
270        0       TRUE       TRUE
301        0       TRUE       TRUE
333        0       TRUE       TRUE
337        0       TRUE       TRUE
348        0       TRUE       TRUE
358        0       TRUE       TRUE
363      108       TRUE      FALSE
427        0       TRUE       TRUE
431        0       TRUE       TRUE
436        0       TRUE       TRUE
454        0       TRUE       TRUE
469        0       TRUE       TRUE
485        0       TRUE       TRUE
495        0       TRUE       TRUE
523        0       TRUE       TRUE
534        0       TRUE       TRUE
536        0       TRUE       TRUE
550      110       TRUE      FALSE
590        0       TRUE       TRUE
598       24       TRUE      FALSE
602        0       TRUE       TRUE
605        0       TRUE       TRUE
620        0       TRUE       TRUE
644        0       TRUE       TRUE
692      114       TRUE      FALSE
698        0       TRUE       TRUE
704        0       TRUE       TRUE
707        0       TRUE       TRUE</code></pre>
</div>
</div>
<ul>
<li>The output shows the index and the value of the outlying observation and wether it is a minor (<code>is.outlier</code>) or major (<code>is.extreme</code>) outlier.</li>
</ul></li>
<li><p>A <code>plus</code> sign <img src="https://latex.codecogs.com/png.latex?(+)"> is sometimes drawn on the boxplot to indicate the <code>mean</code> as in the following figure:</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(</span>
<span id="cb8-2">  PimaIndiansDiabetes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pressure, </span>
<span id="cb8-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb8-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Boxplot of the diastolic blood pressure"</span>,</span>
<span id="cb8-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diastolic blood pressure (mm Hg)"</span>,</span>
<span id="cb8-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb8-7">)</span>
<span id="cb8-8"></span>
<span id="cb8-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">points</span>(</span>
<span id="cb8-10">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb8-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(PimaIndiansDiabetes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pressure), </span>
<span id="cb8-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, </span>
<span id="cb8-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, </span>
<span id="cb8-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb8-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb8-16">  </span>
<span id="cb8-17">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Control fences location</strong></p>
<ul>
<li><p>The location of the fences can be controlled using the <code>range</code> argument:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(</span>
<span id="cb9-4">  PimaIndiansDiabetes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pressure, </span>
<span id="cb9-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb9-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> Fences range = 1.5 (Default)"</span></span>
<span id="cb9-7">)</span>
<span id="cb9-8"></span>
<span id="cb9-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(</span>
<span id="cb9-10">  PimaIndiansDiabetes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pressure, </span>
<span id="cb9-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb9-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> Fences range = 3"</span></span>
<span id="cb9-13">)</span>
<span id="cb9-14"></span>
<span id="cb9-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(</span>
<span id="cb9-16">  PimaIndiansDiabetes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pressure,</span>
<span id="cb9-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb9-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> Fences range = 0"</span></span>
<span id="cb9-19">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Figure <img src="https://latex.codecogs.com/png.latex?A"> shows the boxplot with the fences at <img src="https://latex.codecogs.com/png.latex?Q1%20-%20(1.5%20%5Ctimes%20%5Ctext%7BIQR%7D)"> and <img src="https://latex.codecogs.com/png.latex?Q3%20+%20(1.5%20%5Ctimes%20%5Ctext%7BIQR%7D)">, which is the default setting in R.</p></li>
<li><p>Figure <img src="https://latex.codecogs.com/png.latex?B"> shows the boxplot with the fences at <img src="https://latex.codecogs.com/png.latex?Q1%20-%20(3%20%5Ctimes%20%5Ctext%7BIQR%7D)"> and <img src="https://latex.codecogs.com/png.latex?Q3%20+%20(3%20%5Ctimes%20%5Ctext%7BIQR%7D)">.</p></li>
<li><p>Figure <img src="https://latex.codecogs.com/png.latex?C"> shows the boxplot with the fences at the minimum and maximum values.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Notch</strong></p>
<ul>
<li><p>The notches in a boxplot represent a rough estimate of the confidence interval around the median.</p></li>
<li><p>They extend to the <code>median</code> <img src="https://latex.codecogs.com/png.latex?%5Cpm%5C%201.58%20%5Ctimes%20%5Ctext%7BIQR%7D/%20%5Csqrt%7Bn%7D">.</p></li>
<li><p>Notches can be requested by setting the <code>notch</code> argument to <code>TRUE</code>.</p></li>
<li><p>The notches allow for the visual comparison of medians between two groups. If the notches of two boxplots do not overlap, it suggests that there is a statistically significant difference between the medians of the two groups at approximately the 95% confidence level. Conversely, if the notches overlap, the medians are not significantly different.</p></li>
<li><p>This is quoted from the help of <code>boxplot.stats()</code> “The notches (if requested) extend to <img src="https://latex.codecogs.com/png.latex?%5Cpm%201.58%20IQR/sqrt(n)">. This seems to be based on the same calculations as the formula with 1.57 in Chambers et al.&nbsp;(1983, p.&nbsp;62), given in McGill et al.&nbsp;(1978, p.&nbsp;16). They are based on asymptotic normality of the median and roughly equal sample sizes for the two medians being compared, and are said to be rather insensitive to the underlying distributions of the samples. The idea appears to be to give roughly a 95% confidence interval for the difference in two medians.”</p></li>
<li><p>For example, the following code will draw boxplot with notches for the <code>pressure</code> variable from the <code>PimaIndiansDiabetes</code> dataset grouped by <code>diabetes</code> status:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(</span>
<span id="cb10-2">      pressure <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> diabetes,</span>
<span id="cb10-3">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> PimaIndiansDiabetes,</span>
<span id="cb10-4">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">notch =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb10-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Boxplot with notch"</span>,</span>
<span id="cb10-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diabetes Status"</span>,</span>
<span id="cb10-7">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diastolic blood pressure (mm Hg)"</span></span>
<span id="cb10-8">    )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The notches of the two boxes do not overlap, indicating that the medians are significantly different between the two groups (this can be confirmed by a formal statistical test such as Mood’s median test).</li>
</ul></li>
</ul></li>
<li><p><strong>Box width</strong></p>
<ul>
<li><p>The argument <code>varwidth</code> can be set to <code>TRUE</code> to draw the boxes with widths proportional to the square root of the number of observations in the groups.</p></li>
<li><p>For example, the following code will draw boxplot with variable width for the <code>pressure</code> variable from the <code>PimaIndiansDiabetes</code> dataset grouped by <code>diabetes</code> status:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) </span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(</span>
<span id="cb11-4">PimaIndiansDiabetes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pressure <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> PimaIndiansDiabetes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>diabetes,</span>
<span id="cb11-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varwidth =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb11-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Equal width"</span>,</span>
<span id="cb11-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diabetes Status"</span>,</span>
<span id="cb11-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diastolic blood pressure (mm Hg)"</span></span>
<span id="cb11-9">)</span>
<span id="cb11-10"></span>
<span id="cb11-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(</span>
<span id="cb11-12">PimaIndiansDiabetes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pressure <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> PimaIndiansDiabetes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>diabetes,</span>
<span id="cb11-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varwidth =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb11-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable width"</span>,</span>
<span id="cb11-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diabetes Status"</span>,</span>
<span id="cb11-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diastolic blood pressure (mm Hg)"</span></span>
<span id="cb11-17">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ul></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb12-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> PimaIndiansDiabetes,</span>
<span id="cb12-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb12-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> diabetes, </span>
<span id="cb12-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> pressure</span>
<span id="cb12-7">  )</span>
<span id="cb12-8">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>(</span>
<span id="cb12-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb12-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0466c8"</span>,</span>
<span id="cb12-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outlier.colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>, </span>
<span id="cb12-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">staplewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># width of the horizontal lines relative to the box</span></span>
<span id="cb12-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_summary</span>(</span>
<span id="cb12-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> mean, </span>
<span id="cb12-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"point"</span>, </span>
<span id="cb12-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, </span>
<span id="cb12-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb12-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb12-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb12-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diabetes Status"</span>,</span>
<span id="cb12-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diastolic blood pressure (mm Hg)"</span>,</span>
<span id="cb12-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" aria-labelledby="tabset-1-3-tab">
<ul>
<li><p>The <code>Boxplot</code> function from the <code>car</code> package labels the outliers with the corresponding observation numbers.</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(car)</span>
<span id="cb13-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Boxplot</span>(iris<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Sepal.Width,</span>
<span id="cb13-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Boxplot of Sepal Width"</span>,</span>
<span id="cb13-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Iris Species"</span>,</span>
<span id="cb13-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sepal Width"</span></span>
<span id="cb13-6">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 61 16 33 34</code></pre>
</div>
</div></li>
<li><p>Observations <img src="https://latex.codecogs.com/png.latex?61,%2016,%2033"> and <img src="https://latex.codecogs.com/png.latex?34"> are considered as outliers.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="boxplots-by-base-r-vs.-ggplot2" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="boxplots-by-base-r-vs.-ggplot2"><span class="header-section-number">4</span> Boxplots by base R vs.&nbsp;ggplot2</h2>
<ul>
<li><p>The <code>boxplot()</code> function from base R and <code>geom_boxplot()</code> function from <code>ggplot2</code> produce different boxplots because they are based on different algoriths for calculating quantiles.</p></li>
<li><p>The following figure shows a side by side comparison of the boxplots produced by the two functions for the <code>mpg</code> variable from the <code>mtcars</code> dataset:</p></li>
</ul>
<p><img src="https://www.amrbiostats.com/images/box_compare.jpg" class="img-fluid"></p>
<ul>
<li><p>As depicted in the figure, the boxplot produced by <code>ggplot2</code> identifies one outlier that is not identified by the base R <code>boxplot()</code>.</p></li>
<li><p>To see the differences in calculations, we can extract the values used for constructing the boxplots using the <code>boxplot.stats()</code> function for base R and <code>ggplot_build()</code> function for <code>ggplot2</code> as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot.stats</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$stats
[1] 10.40 15.35 19.20 22.80 33.90

$n
[1] 32

$conf
[1] 17.11916 21.28084

$out
numeric(0)</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">box_ggplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb17-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars,</span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> mpg)</span>
<span id="cb17-4">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>() </span>
<span id="cb17-6"></span>
<span id="cb17-7"></span>
<span id="cb17-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot_build</span>(box_ggplot)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  ymin  lower middle upper ymax outliers notchupper notchlower x flipped_aes
1 10.4 15.425   19.2  22.8 32.4     33.9   21.25989   17.14011 0       FALSE
  PANEL group ymin_final ymax_final   xmin  xmax xid newx new_width weight
1     1    -1       10.4       33.9 -0.375 0.375   1    0      0.75      1
  colour  fill alpha shape linetype linewidth
1 grey20 white    NA    19    solid       0.5</code></pre>
</div>
</div>
<ul>
<li><p>The output shows different <img src="https://latex.codecogs.com/png.latex?Q_1">, <img src="https://latex.codecogs.com/png.latex?Q_3">, and consequently different IQR, fences and outliers.</p></li>
<li><p>In addition, the notches are different because the of different <img src="https://latex.codecogs.com/png.latex?IQR">.</p></li>
</ul></li>
</ul>
</section>
<section id="distribution-insights-from-boxplots" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="distribution-insights-from-boxplots"><span class="header-section-number">5</span> Distribution insights from boxplots</h2>
<ul>
<li><p>Boxplots can provide information about the distribution of data.</p></li>
<li><p>For example, consider the following boxplots:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb19-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb19-3">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rexp</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb19-4"></span>
<span id="cb19-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb19-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">density</span>(x), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density Plot of X"</span>)</span>
<span id="cb19-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">density</span>(y), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density Plot of Y"</span>)</span>
<span id="cb19-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Boxplot of X"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span>
<span id="cb19-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">points</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb19-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Boxplot of Y"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span>
<span id="cb19-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">points</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(y), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>The boxplot of <img src="https://latex.codecogs.com/png.latex?X"> is symmetric with the median at the center of the box, the whiskers are of equal length, and a few outliers on both sides of the whiskers. In addition, the mean and median appear to be identical.</p></li>
<li><p>On the other hand, the boxplot of <img src="https://latex.codecogs.com/png.latex?Y"> is skewed to the right with the median closer to the <img src="https://latex.codecogs.com/png.latex?Q_1">, the whisker on the right is longer than the whisker on the left with many outliers on the right side. The mean is greater than the median, which is due to the presence of outliers on the right side (right skewness).</p></li>
</ul></li>
</ul>
</section>
<section id="other-variations-of-boxplots" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="other-variations-of-boxplots"><span class="header-section-number">6</span> Other variations of boxplots</h2>
<ul>
<li><p>Boxplots can be misleading because they cannot capture the shape of the distribution accurately. For example, the fail to capture multimoality or kurtosis (i.e., peakedness of the distribution).</p></li>
<li><p>Therefore, other variants of boxplots have been used by overlaying the original observations on the boxplot as jittered points or dot plots or wrapping the boxplot in a violin plot that shows the density of the data. These approaches provide more insights about the distribution of the data.</p></li>
<li><p>Jittering means slightly displacing (spreading) the points horizontally to avoid overlapping, while in the dot plot, the points are stacked on top of each other.</p></li>
<li><p>The following figure shows that boxplot lacks the ability to capture the bimodal nature of the data, which is evident from the density plot or the boxplot with jittered points:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load necessary libraries</span></span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb20-3"></span>
<span id="cb20-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate Bimodal Data with clear separation</span></span>
<span id="cb20-5">data_bimodal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb20-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>), </span>
<span id="cb20-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb20-8">)</span>
<span id="cb20-9"></span>
<span id="cb20-10"></span>
<span id="cb20-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb20-12"></span>
<span id="cb20-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(</span>
<span id="cb20-14">  data_bimodal, </span>
<span id="cb20-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Boxplot of bimodal Data"</span>, </span>
<span id="cb20-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Values"</span>, </span>
<span id="cb20-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">horizontal =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb20-18"></span>
<span id="cb20-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb20-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">density</span>(data_bimodal), </span>
<span id="cb20-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density Plot of bimodal Data"</span></span>
<span id="cb20-22">)</span>
<span id="cb20-23"></span>
<span id="cb20-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(</span>
<span id="cb20-25">  data_bimodal, </span>
<span id="cb20-26">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Boxplot of bimodal Data"</span>,</span>
<span id="cb20-27">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">horizontal =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb20-28">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb20-29">)</span>
<span id="cb20-30"></span>
<span id="cb20-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stripchart</span>(</span>
<span id="cb20-32">  data_bimodal,</span>
<span id="cb20-33">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jitter"</span>,</span>
<span id="cb20-34">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># select the point type</span></span>
<span id="cb20-35">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">add =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add the points to the existing plot</span></span>
<span id="cb20-36">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0466c8"</span>,</span>
<span id="cb20-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vertical =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb20-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">jitter =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># control the amount of jittering</span></span>
<span id="cb20-39">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Both the density plot and the boxplot with jittered points show bimodality as two peaks in the former and two distinct clusters in the latter, which are not captured by the standard boxplot.</li>
</ul></li>
</ul>
<section id="creating-boxplot-with-jittered-points" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="creating-boxplot-with-jittered-points"><span class="header-section-number">6.1</span> Creating boxplot with jittered points</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true">Base R</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" aria-controls="tabset-2-2" aria-selected="false">ggplot2</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" aria-labelledby="tabset-2-1-tab">
<ul>
<li><p>Using <code>stripchart()</code> function to produce jittered points.</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(</span>
<span id="cb21-2">  Sepal.Width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Species,</span>
<span id="cb21-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> iris,</span>
<span id="cb21-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb21-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outline =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb21-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Boxplot of sepal width grouped by </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> species with jittered points"</span>,</span>
<span id="cb21-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Species"</span>,</span>
<span id="cb21-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sepal Width"</span></span>
<span id="cb21-9">)</span>
<span id="cb21-10"></span>
<span id="cb21-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stripchart</span>(</span>
<span id="cb21-12">  Sepal.Width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Species,</span>
<span id="cb21-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> iris,</span>
<span id="cb21-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jitter"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># select the jitter method</span></span>
<span id="cb21-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># select the point type</span></span>
<span id="cb21-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">add =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add the points to the existing plot</span></span>
<span id="cb21-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>, </span>
<span id="cb21-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vertical =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb21-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">jitter =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># control the amount of jittering</span></span>
<span id="cb21-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># control the size of the points</span></span>
<span id="cb21-21">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ul>
</div>
<div id="tabset-2-2" class="tab-pane" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb22-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb22-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> iris,</span>
<span id="cb22-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb22-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Species,</span>
<span id="cb22-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width</span>
<span id="cb22-7">  )</span>
<span id="cb22-8">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>(</span>
<span id="cb22-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb22-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0466c8"</span>,</span>
<span id="cb22-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outliers =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb22-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">staplewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb22-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(</span>
<span id="cb22-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb22-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>,</span>
<span id="cb22-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span></span>
<span id="cb22-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb22-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sepal Width"</span>,</span>
<span id="cb22-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Species"</span>,</span>
<span id="cb22-23">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Boxplot with jittered points"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="creating-boxplot-with-dot-plot" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="creating-boxplot-with-dot-plot"><span class="header-section-number">6.2</span> Creating boxplot with dot plot</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" aria-controls="tabset-3-1" aria-selected="true">Base R</a></li><li class="nav-item"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" aria-controls="tabset-3-2" aria-selected="false">ggplot2</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" aria-labelledby="tabset-3-1-tab">
<ul>
<li>Using <code>beeswarm</code> function from the <code>beeswarm</code> package that provides various methods to separate coincident points such that the points are stacked and do not overlap.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(beeswarm)</span>
<span id="cb23-2"></span>
<span id="cb23-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(</span>
<span id="cb23-4">  Sepal.Width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Species,</span>
<span id="cb23-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> iris,</span>
<span id="cb23-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb23-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outline =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb23-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Boxplot of sepal width grouped by </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> species with jittered points"</span>,</span>
<span id="cb23-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Species"</span>,</span>
<span id="cb23-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sepal Width"</span></span>
<span id="cb23-11">)</span>
<span id="cb23-12"></span>
<span id="cb23-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">beeswarm</span>(</span>
<span id="cb23-14">  Sepal.Width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Species,</span>
<span id="cb23-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> iris,</span>
<span id="cb23-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># select the point type</span></span>
<span id="cb23-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">add =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add the points to the existing plot</span></span>
<span id="cb23-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>,</span>
<span id="cb23-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># select the jitter method</span></span>
<span id="cb23-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># control the size of the points</span></span>
<span id="cb23-21">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb24-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> iris,</span>
<span id="cb24-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb24-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Species,</span>
<span id="cb24-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width</span>
<span id="cb24-6">  )</span>
<span id="cb24-7">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>(</span>
<span id="cb24-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb24-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0466c8"</span>,</span>
<span id="cb24-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outliers =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb24-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">staplewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb24-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dotplot</span>(</span>
<span id="cb24-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binaxis =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>,</span>
<span id="cb24-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stackdir =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>,</span>
<span id="cb24-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dotsize =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,</span>
<span id="cb24-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>,</span>
<span id="cb24-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>,</span>
<span id="cb24-20">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb24-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sepal Width"</span>,</span>
<span id="cb24-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Species"</span>,</span>
<span id="cb24-24">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Boxplot with dot plot"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="creating-boxplot-wrapped-in-violin-plot" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="creating-boxplot-wrapped-in-violin-plot"><span class="header-section-number">6.3</span> Creating boxplot wrapped in violin plot</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" aria-controls="tabset-4-1" aria-selected="true">Base R</a></li><li class="nav-item"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" aria-controls="tabset-4-2" aria-selected="false">Using ggpubr</a></li><li class="nav-item"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" aria-controls="tabset-4-3" aria-selected="false">ggplo2</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(vioplot)</span>
<span id="cb25-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vioplot</span>(</span>
<span id="cb25-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> data_bimodal, </span>
<span id="cb25-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rectCol =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># color of the box</span></span>
<span id="cb25-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineCol =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># color of the lines</span></span>
<span id="cb25-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colMed =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># color of the median point</span></span>
<span id="cb25-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">wex =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># relative expansion of the violin </span></span>
<span id="cb25-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rgb</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">212</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">73</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">76</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>),</span>
<span id="cb25-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bimodal distribution"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># label for variable</span></span>
<span id="cb25-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Violin plot of bimodal data"</span></span>
<span id="cb25-11">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggpubr)</span>
<span id="cb26-2">my_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb26-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> data_bimodal,</span>
<span id="cb26-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Binomial Distribution"</span></span>
<span id="cb26-5">)</span>
<span id="cb26-6"></span>
<span id="cb26-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggviolin</span>(</span>
<span id="cb26-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> my_data,</span>
<span id="cb26-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"group"</span>,</span>
<span id="cb26-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>,</span>
<span id="cb26-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>,</span>
<span id="cb26-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb26-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>,</span>
<span id="cb26-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb26-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Values"</span>,</span>
<span id="cb26-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Violin plot of bimodal data"</span>,</span>
<span id="cb26-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">add =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"boxplot"</span>,</span>
<span id="cb26-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">add.params =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb26-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb26-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb26-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.04</span></span>
<span id="cb26-22">  ),</span>
<span id="cb26-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ggtheme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span>
<span id="cb26-24">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb27-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> data_bimodal),</span>
<span id="cb27-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bimodal distribution"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> x)</span>
<span id="cb27-4">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_violin</span>(</span>
<span id="cb27-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>,</span>
<span id="cb27-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb27-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span></span>
<span id="cb27-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>(</span>
<span id="cb27-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb27-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb27-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.04</span></span>
<span id="cb27-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb27-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb27-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Values"</span></span>
<span id="cb27-18">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Violin plot of bimodal data"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="references" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="references"><span class="header-section-number">7</span> References</h2>
<ul>
<li><p>Daniel, W. W. and Cross, C. L. (2013). Biostatistics: A Foundation for Analysis in the Health Sciences, Tenth edition. Wiley</p></li>
<li><p>Heumann, C., Schomaker, M., and Shalabh (2022). Introduction to Statistics and Data Analysis: With Exercises, Solutions and Applications in R. Springer</p></li>
<li><p>Lane, D. M. et al., (2019). Introduction to Statistics. Online Edition. Retrieved September 14, 2024, from https://openstax.org/details/introduction-statistics</p></li>
</ul>
<p><br></p>
</section>
<section id="add-your-comments" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="add-your-comments"><span class="header-section-number">8</span> Add your comments</h2>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <guid>https://www.amrbiostats.com/posts/biostats/B05_boxplot_stats.html</guid>
  <pubDate>Thu, 31 Oct 2024 20:00:00 GMT</pubDate>
  <media:content url="https://www.amrbiostats.com/images/biostats.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Quantile algorithms</title>
  <link>https://www.amrbiostats.com/posts/biostats/B04_quantile_algorithms_stats.html</link>
  <description><![CDATA[ 




<section id="steps-to-calculate-quantiles-in-r" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="steps-to-calculate-quantiles-in-r"><span class="header-section-number">1</span> Steps to calculate quantiles in R</h2>
<ul>
<li><p>The help of the <code>quantile()</code> function in R describes the different algorithms used to calculate quantiles. However, I find the details very technical and not easy to understand for casual readers.</p></li>
<li><p>Therefore, I tried to simplify the algorithms as discussed below.</p></li>
<li><p>R provides <strong>nine</strong> algorithms to calculate the quantiles, which can be specified using the <code>type</code> argument:</p>
<ul>
<li><p>Types <img src="https://latex.codecogs.com/png.latex?1-3"> are used for discontinuous data, while types <img src="https://latex.codecogs.com/png.latex?4-9"> are used for continuous data.</p></li>
<li><p>Type <img src="https://latex.codecogs.com/png.latex?1"> and <img src="https://latex.codecogs.com/png.latex?3"> are used for class “Date” and for ordered factors.</p></li>
<li><p>Type <img src="https://latex.codecogs.com/png.latex?7"> is the default method for continuous data in R.</p></li>
<li><p>Type <img src="https://latex.codecogs.com/png.latex?6"> is used to get results similar to <code>SPSS</code>, <code>Minitab</code>, or <code>Graphpad Prism</code>.</p></li>
</ul></li>
<li><p>Let <img src="https://latex.codecogs.com/png.latex?n"> be the number of observations in the dataset.</p></li>
<li><p>Let <img src="https://latex.codecogs.com/png.latex?p"> a number between <img src="https://latex.codecogs.com/png.latex?0"> and <img src="https://latex.codecogs.com/png.latex?1">, where <img src="https://latex.codecogs.com/png.latex?(p%20%5Ctimes%20100)%5C%25"> is the quantile to be calculated, denoted by <img src="https://latex.codecogs.com/png.latex?Q_p">.</p></li>
<li><p>The first step is to calculate the product <img src="https://latex.codecogs.com/png.latex?np">.</p></li>
<li><p>Next, calculate the <img src="https://latex.codecogs.com/png.latex?j%5E%7Bth%7D"> rank and <img src="https://latex.codecogs.com/png.latex?Q_p"> as follows:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 31%">
<col style="width: 30%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Algorithm</th>
<th style="text-align: center;"><span style="color: #0466c8;"><img src="https://latex.codecogs.com/png.latex?j"></span></th>
<th style="text-align: center;"><span style="color: darkgreen;">Condition</span></th>
<th style="text-align: center;"><span style="color: #ba181b;">Quantile <img src="https://latex.codecogs.com/png.latex?(Q_p)"></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?1"></td>
<td style="text-align: center;"><span style="color: #0466c8;"><img src="https://latex.codecogs.com/png.latex?%5Clfloor%20np%20%5Crfloor"></span></td>
<td style="text-align: center;"><p><img src="https://latex.codecogs.com/png.latex?np%20=%20j"></p>
<p><img src="https://latex.codecogs.com/png.latex?np%20%5Cne%20j"></p></td>
<td style="text-align: center;"><p><span style="color: #ba181b;"><img src="https://latex.codecogs.com/png.latex?x_j"></span></p>
<p><span style="color: #ba181b;"><img src="https://latex.codecogs.com/png.latex?x_%7Bj+1%7D"></span></p></td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?2"></td>
<td style="text-align: center;"><span style="color: #0466c8;"><img src="https://latex.codecogs.com/png.latex?%5Clfloor%20np%20%5Crfloor"></span></td>
<td style="text-align: center;"><p><img src="https://latex.codecogs.com/png.latex?np%20=%20j"></p>
<p><img src="https://latex.codecogs.com/png.latex?np%20%5Cne%20j"></p></td>
<td style="text-align: center;"><p><span style="color: #ba181b;"><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B2%7D(x_j%20+%20x_%7Bj+1%7D)"></span></p>
<p><span style="color: #ba181b;"><img src="https://latex.codecogs.com/png.latex?x_%7Bj+1%7D"></span></p></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?3"></td>
<td style="text-align: center;"><span style="color: #0466c8;"><img src="https://latex.codecogs.com/png.latex?%5Clfloor%20np%20-%20%5Clarge%20%5Cfrac%7B1%7D%7B2%7D%5Crfloor"></span></td>
<td style="text-align: center;"><p><img src="https://latex.codecogs.com/png.latex?np%20=%20j%20+%20%5Cfrac%7B1%7D%7B2%7D"> and <img src="https://latex.codecogs.com/png.latex?j"> even</p>
<p><img src="https://latex.codecogs.com/png.latex?np%20%5Cne%20j+%20%5Cfrac%7B1%7D%7B2%7D"></p></td>
<td style="text-align: center;"><p><img src="https://latex.codecogs.com/png.latex?x_j"></p>
<p><img src="https://latex.codecogs.com/png.latex?x_%7Bj+1%7D"></p></td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?4"></td>
<td style="text-align: center;"><span style="color: #0466c8;"><img src="https://latex.codecogs.com/png.latex?%5Clfloor%20np%20%5Crfloor"></span></td>
<td style="text-align: center;"><hr></td>
<td style="text-align: center;"><span style="color: #ba181b;"><img src="https://latex.codecogs.com/png.latex?x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np-j)"></span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?5"></td>
<td style="text-align: center;"><span style="color: #0466c8;"><img src="https://latex.codecogs.com/png.latex?%5Clfloor%20np%20+%20%5Clarge%20%5Cfrac%7B1%7D%7B2%7D%5Crfloor"></span></td>
<td style="text-align: center;"><hr></td>
<td style="text-align: center;"><span style="color: #ba181b;"><img src="https://latex.codecogs.com/png.latex?x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np-j%20+%20%5Cfrac%7B1%7D%7B2%7D)"></span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?6"></td>
<td style="text-align: center;"><span style="color: #0466c8;"><img src="https://latex.codecogs.com/png.latex?%5Clfloor%20np%20+%20p%20%5Crfloor"></span></td>
<td style="text-align: center;"><hr></td>
<td style="text-align: center;"><span style="color: #ba181b;"><img src="https://latex.codecogs.com/png.latex?x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np-j%20+p)"></span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?7"></td>
<td style="text-align: center;"><span style="color: #0466c8;"><img src="https://latex.codecogs.com/png.latex?%5Clfloor%20np%20-p%20+1%20%5Crfloor"></span></td>
<td style="text-align: center;"><hr></td>
<td style="text-align: center;"><span style="color: #ba181b;"><img src="https://latex.codecogs.com/png.latex?x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np%20-j%20-%20p%20+%201)"></span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?8"></td>
<td style="text-align: center;"><span style="color: #0466c8;"><img src="https://latex.codecogs.com/png.latex?%5Clfloor%20np%20+%20%5Clarge%20%5Cfrac%7B(p+1)%7D%7B3%7D%20%5Crfloor"></span></td>
<td style="text-align: center;"><hr></td>
<td style="text-align: center;"><span style="color: #ba181b;"><img src="https://latex.codecogs.com/png.latex?x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np%20-%20j%20+%20%5Cfrac%7B(p+1)%7D%7B3%7D)"></span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?9"></td>
<td style="text-align: center;"><span style="color: #0466c8;"><img src="https://latex.codecogs.com/png.latex?%5Clfloor%20np%20+%20%5Clarge%20%5Cfrac%7B(2p+3)%7D%7B8%7D%20%5Crfloor"></span></td>
<td style="text-align: center;"><hr></td>
<td style="text-align: center;"><span style="color: #ba181b;"><img src="https://latex.codecogs.com/png.latex?x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np%20-%20j%20+%20%5Cfrac%7B(2p+3)%7D%7B8%7D)"></span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>The symbol <img src="https://latex.codecogs.com/png.latex?%5Clfloor%20x%20%5Crfloor"> reads as the floor of <img src="https://latex.codecogs.com/png.latex?x">. This function returns the largest <strong>integer</strong> not greater than <img src="https://latex.codecogs.com/png.latex?x"> (i.e., <strong>rounds down</strong> <img src="https://latex.codecogs.com/png.latex?x"> to the nearest integer). For example, <img src="https://latex.codecogs.com/png.latex?%5Clfloor%203.9%20%5Crfloor%20=%203">.</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?x_j"> and <img src="https://latex.codecogs.com/png.latex?x_%7Bj+1%7D"> are the <img src="https://latex.codecogs.com/png.latex?j%5E%7Bth%7D"> and <img src="https://latex.codecogs.com/png.latex?(j+1)%5E%7Bth%7D"> order statistics, respectively (i.e., the observations having the rank <img src="https://latex.codecogs.com/png.latex?j"> and <img src="https://latex.codecogs.com/png.latex?j+1"> in the ordered array of the observations).</p></li>
</ul></li>
<li><p>Let’s illustrate the above algorithms with some examples.</p></li>
<li><p><span style="color: #ba181b;">Example <img src="https://latex.codecogs.com/png.latex?1"> (ordered factor):</span> consider the following set of observations pertaining to the pain severity (<img src="https://latex.codecogs.com/png.latex?1">: mild, <img src="https://latex.codecogs.com/png.latex?2">: moderate, <img src="https://latex.codecogs.com/png.latex?3">: severe) of <img src="https://latex.codecogs.com/png.latex?10"> patients: <img src="https://latex.codecogs.com/png.latex?1,%201,%201,%202,%202,%203,%203,%203,%203,%203">. The <img src="https://latex.codecogs.com/png.latex?50%5E%7Bth%7D%5C%20(Q_%7B0.5%7D)"> and <img src="https://latex.codecogs.com/png.latex?75%5E%7Bth%7D%5C%20(Q_%7B0.75%7D)"> quantiles can be calculated using algorithms <img src="https://latex.codecogs.com/png.latex?1-3"> as follows:</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">Algorithm 1</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">Algorithm 2</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" aria-controls="tabset-1-3" aria-selected="false">Algorithm 3</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2050%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.5">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%2010%20%5Ctimes%200.5%20=%205">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20%5Crfloor%20=%20%5Clfloor%205%20%5Crfloor%20=%205"></p></li>
<li><p>Since <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%20j">, then <img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.5%7D%20=%20x_j%20=%20x_5"> (the observation having the rank <img src="https://latex.codecogs.com/png.latex?%5Csmall%205"> in the ordered array), which has the value <img src="https://latex.codecogs.com/png.latex?%5Csmall%202"></p></li>
</ul></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2075%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.75">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%2010%20%5Ctimes%200.75%20=%207.5">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20%5Crfloor%20=%20%5Clfloor%207.5%20%5Crfloor%20=%207"></p></li>
<li><p>Since <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20%5Cne%20j">, then <img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.75%7D%20=%20x_%7Bj+1%7D%20=%20x_8"> (the observation having the rank <img src="https://latex.codecogs.com/png.latex?%5Csmall%208"> in the ordered array), which has the value <img src="https://latex.codecogs.com/png.latex?%5Csmall%203"></p></li>
</ul></li>
<li><p>Check the result using the <code>quantile()</code> function in R:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb1-2">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(</span>
<span id="cb1-3"> x, </span>
<span id="cb1-4"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>), </span>
<span id="cb1-5"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-6">   )</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>50% 75% 
  2   3 </code></pre>
</div>
</div></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2050%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.5">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%2010%20%5Ctimes%200.5%20=%205">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20%5Crfloor%20=%20%5Clfloor%205%20%5Crfloor%20=%205"></p></li>
<li><p>Since <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%20j">, then <img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.5%7D%20=%20%5Cfrac%7B1%7D%7B2%7D(x_j%20+%20x_%7Bj+1%7D)%20="> <img src="https://latex.codecogs.com/png.latex?%5Csmall%20%5Cfrac%7B1%7D%7B2%7D(x_5%20+%20x_6)%20=%20%5Cfrac%7B1%7D%7B2%7D(2%20+%203)%20=%202.5"></p></li>
</ul></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2075%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.75">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%2010%20%5Ctimes%200.75%20=%207.5">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20%5Crfloor%20=%20%5Clfloor%207.5%20%5Crfloor%20=%207"></p></li>
<li><p>Since <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20%5Cne%20%5Clfloor%20np%20%5Crfloor">, then <img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.75%7D%20=%20%20x_%7Bj+1%7D%20=%20x_8%20=%203"></p></li>
</ul></li>
<li><p>Check the result using the <code>quantile()</code> function in R:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(</span>
<span id="cb3-2">  x, </span>
<span id="cb3-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>), </span>
<span id="cb3-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb3-5">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>50% 75% 
2.5 3.0 </code></pre>
</div>
</div></li>
</ul>
</div>
<div id="tabset-1-3" class="tab-pane" aria-labelledby="tabset-1-3-tab">
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2050%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.5">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%2010%20%5Ctimes%200.5%20=%205">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20-%200.5%20%5Crfloor%20=%20%5Clfloor%205%20-%200.5%20%5Crfloor%20=%204"></p></li>
<li><p>Since <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20%5Cne%20j%20+%200.5">, then <img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.5%7D%20=%20x_%7Bj+1%7D%20=%20x_5%20=%202"></p></li>
</ul></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2075%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.75">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%2010%20%5Ctimes%200.75%20=%207.5">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20-%200.5%20%5Crfloor%20=%20%5Clfloor%207.5%20-%200.5%20%5Crfloor%20=%207"></p></li>
<li><p>Since <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%20j%20+%200.5"> but <img src="https://latex.codecogs.com/png.latex?j"> is not even, then <img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.75%7D%20=%20x_%7Bj+1%7D%20=%20x_8%20=%203"></p></li>
</ul></li>
<li><p>Check the result using the <code>quantile()</code> function in R:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(</span>
<span id="cb5-2">  x, </span>
<span id="cb5-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>), </span>
<span id="cb5-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb5-5">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>50% 75% 
  2   3 </code></pre>
</div>
</div></li>
</ul>
</div>
</div>
</div>
<ul>
<li><span style="color: #ba181b;">Example <img src="https://latex.codecogs.com/png.latex?2"> (continuous data):</span> consider the following ordered set of observations: <img src="https://latex.codecogs.com/png.latex?(10.2,%5C%2010.4,%5C%2011.6,%5C%2012.3,%5C%2013.2,%5C%2014.7,%5C%2015.4,%5C%2016.1)">. The <img src="https://latex.codecogs.com/png.latex?25%5E%7Bth%7D%5C%20(Q_%7B0.25%7D)"> and <img src="https://latex.codecogs.com/png.latex?75%5E%7Bth%7D%5C%20(Q_%7B0.75%7D)"> quantiles can be calculated using algorithms <img src="https://latex.codecogs.com/png.latex?4-9"> as follows:</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true">Algorithm 4</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" aria-controls="tabset-2-2" aria-selected="false">Algorithm 5</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" aria-controls="tabset-2-3" aria-selected="false">Algorithm 6</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" aria-controls="tabset-2-4" aria-selected="false">Algorithm 7</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" aria-controls="tabset-2-5" aria-selected="false">Algorithm 8</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" aria-controls="tabset-2-6" aria-selected="false">Algorithm 9</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" aria-labelledby="tabset-2-1-tab">
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2025%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.25">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%208%20%5Ctimes%200.25%20=%202">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20%5Crfloor%20=%20%5Clfloor%202%20%5Crfloor%20=%202"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.25%7D%20=%20x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np%20-%20j)%20=%20x_2%20+%20(x_3%20-%20x_2)(2%20-%202)%20=%2010.4"></p></li>
</ul></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2075%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.75">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%208%20%5Ctimes%200.75%20=%206">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20%5Crfloor%20=%20%5Clfloor%206%20%5Crfloor%20=%206"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.75%7D%20=%20x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np%20-%20j)%20=%20x_6%20+%20(x_7%20-%20x_6)(6%20-%206)%20=%2014.7"></p></li>
</ul></li>
<li><p>Check the result using the <code>quantile()</code> function in R:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">11.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">14.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">16.1</span>)</span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(</span>
<span id="cb7-3">  y, </span>
<span id="cb7-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>), </span>
<span id="cb7-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb7-6">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> 25%  75% 
10.4 14.7 </code></pre>
</div>
</div></li>
</ul>
</div>
<div id="tabset-2-2" class="tab-pane" aria-labelledby="tabset-2-2-tab">
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2025%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.25">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%208%20%5Ctimes%200.25%20=%202">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20+%200.5%20%5Crfloor%20=%20%5Clfloor%202.5%20%5Crfloor%20=%202"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.25%7D%20=%20x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np%20-%20j%20+%200.5)%20=%20x_2%20+%20(x_3%20-%20x_2)(2%20-%202%20+%200.5)%20="></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20%2010.4%20+%20(11.6%20-%2010.4)%20%5Ctimes%200.5%20=%2011"></p></li>
</ul></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2075%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.75">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%208%20%5Ctimes%200.75%20=%206">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20+%200.5%20%5Crfloor%20=%20%5Clfloor%206.5%20%5Crfloor%20=%206"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.75%7D%20=%20x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np%20-%20j%20+%200.5)%20=%20x_6%20+%20(x_7%20-%20x_6)(6%20-%206%20+%200.5)%20="> <img src="https://latex.codecogs.com/png.latex?%5Csmall%2014.7%20+%20(15.4%20-%2014.7)%20%5Ctimes%200.5%20=%2015.05"></p></li>
</ul></li>
<li><p>Check the result using the <code>quantile()</code> function in R:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(</span>
<span id="cb9-2">  y, </span>
<span id="cb9-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>), </span>
<span id="cb9-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb9-5">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  25%   75% 
11.00 15.05 </code></pre>
</div>
</div></li>
</ul>
</div>
<div id="tabset-2-3" class="tab-pane" aria-labelledby="tabset-2-3-tab">
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2025%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.25">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%208%20%5Ctimes%200.25%20=%202">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20+%20p%20%5Crfloor%20=%20%5Clfloor%202%20+%200.25%20%5Crfloor%20=%202"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.25%7D%20=%20x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np%20-%20j%20+%20p)%20=%20x_2%20+%20(x_3%20-%20x_2)(2%20-%202%20+%200.25)%20="></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20%2010.4%20+%20(11.6%20-%2010.4)%20%5Ctimes%200.25%20=%2010.7"></p></li>
</ul></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2075%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.75">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%208%20%5Ctimes%200.75%20=%206">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20+%20p%20%5Crfloor%20=%20%5Clfloor%206%20+%200.75%20%5Crfloor%20=%206"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.75%7D%20=%20x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np%20-%20j%20+%200.75)%20=%20x_6%20+%20(x_7%20-%20x_6)(6%20-%206%20+%200.75)%20="> <img src="https://latex.codecogs.com/png.latex?%5Csmall%2014.7%20+%20(15.4%20-%2014.7)%20%5Ctimes%200.75%20=%2015.225"></p></li>
</ul></li>
<li><p>Check the result using the <code>quantile()</code> function in R:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(</span>
<span id="cb11-2">  y, </span>
<span id="cb11-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>), </span>
<span id="cb11-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb11-5">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   25%    75% 
10.700 15.225 </code></pre>
</div>
</div></li>
</ul>
</div>
<div id="tabset-2-4" class="tab-pane" aria-labelledby="tabset-2-4-tab">
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2025%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.25">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%208%20%5Ctimes%200.25%20=%202">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20-%20p%20+%201%20%5Crfloor%20=%20%5Clfloor%202%20-%200.25%20+%201%20%5Crfloor%20=%202"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.25%7D%20=%20x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np%20-%20j%20-%20p%20+%201)%20=%20x_2%20+%20(x_3%20-%20x_2)(2%20-%202%20-%200.25%20+%201)%20="></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20%2010.4%20+%20(11.6%20-%2010.4)%20%5Ctimes%200.75%20=%2011.3"></p></li>
</ul></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2075%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.75">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%208%20%5Ctimes%200.75%20=%206">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20-%20p%20+%201%20%5Crfloor%20=%20%5Clfloor%206%20-%200.75%20+%201%20%5Crfloor%20=%206"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.75%7D%20=%20x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np%20-%20j%20-%200.75%20+%201)%20=%20x_6%20+%20(x_7%20-%20x_6)(6%20-%206%20-%200.75%20+%201)%20="> <img src="https://latex.codecogs.com/png.latex?%5Csmall%2014.7%20+%20(15.4%20-%2014.7)%20%5Ctimes%200.25%20=%2014.875"></p></li>
</ul></li>
<li><p>Check the result using the <code>quantile()</code> function in R:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(</span>
<span id="cb13-2">  y, </span>
<span id="cb13-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>), </span>
<span id="cb13-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb13-5">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   25%    75% 
11.300 14.875 </code></pre>
</div>
</div></li>
</ul>
</div>
<div id="tabset-2-5" class="tab-pane" aria-labelledby="tabset-2-5-tab">
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2025%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.25">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%208%20%5Ctimes%200.25%20=%202">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20+%20%5Cfrac%7Bp%20+%201%7D%7B3%7D%20%5Crfloor%20=%20%5Clfloor%202%20+%20%5Cfrac%7B0.25%20+%201%7D%7B3%7D%20%5Crfloor%20=%202"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.25%7D%20=%20x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np%20-%20j%20+%20%5Cfrac%7Bp%20+%201%7D%7B3%7D)%20=%20x_2%20+%20(x_3%20-%20x_2)(2%20-%202%20+%20%5Cfrac%7B0.25%20+%201%7D%7B3%7D)%20="></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20%2010.4%20+%20(11.6%20-%2010.4)%20%5Ctimes%200.41667%20=%2010.9"></p></li>
</ul></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2075%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.75">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%208%20%5Ctimes%200.75%20=%206">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20+%20%5Cfrac%7Bp%20+%201%7D%7B3%7D%20%5Crfloor%20=%20%5Clfloor%206%20+%20%5Cfrac%7B0.75%20+%201%7D%7B3%7D%20%5Crfloor%20=%206"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.75%7D%20=%20x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np%20-%20j%20+%20%5Cfrac%7Bp%20+%201%7D%7B3%7D)%20=%20x_6%20+%20(x_7%20-%20x_6)(6%20-%206%20+%20%5Cfrac%7B0.75%20+%201%7D%7B3%7D)%20="> <img src="https://latex.codecogs.com/png.latex?%5Csmall%2014.7%20+%20(15.4%20-%2014.7)%20%5Ctimes%200.58333%20=%2015.10833"></p></li>
</ul></li>
<li><p>Check the result using the <code>quantile()</code> function in R:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(</span>
<span id="cb15-2">  y, </span>
<span id="cb15-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>), </span>
<span id="cb15-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb15-5">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     25%      75% 
10.90000 15.10833 </code></pre>
</div>
</div></li>
</ul>
</div>
<div id="tabset-2-6" class="tab-pane" aria-labelledby="tabset-2-6-tab">
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2025%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.25">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%208%20%5Ctimes%200.25%20=%202">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20+%20%5Cfrac%7B2p%20+%203%7D%7B8%7D%20%5Crfloor%20=%20%5Clfloor%202%20+%20%5Cfrac%7B2%20%5Ctimes%200.25%20+%203%7D%7B8%7D%20%5Crfloor%20=%202"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.25%7D%20=%20x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np%20-%20j%20+%20%5Cfrac%7B2p%20+%203%7D%7B8%7D)%20=%20x_2%20+%20(x_3%20-%20x_2)(2%20-%202%20+%20%5Cfrac%7B2%20%5Ctimes%200.25%20+%203%7D%7B8%7D)%20="></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20%2010.4%20+%20(11.6%20-%2010.4)%20%5Ctimes%200.4375%20=%2010.925"></p></li>
</ul></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%2075%5E%7Bth%7D"> Quantile:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20p%20=%200.75">, <img src="https://latex.codecogs.com/png.latex?%5Csmall%20np%20=%208%20%5Ctimes%200.75%20=%206">, and <img src="https://latex.codecogs.com/png.latex?%5Csmall%20j%20=%20%20%5Clfloor%20np%20+%20%5Cfrac%7B2p%20+%203%7D%7B8%7D%20%5Crfloor%20=%20%5Clfloor%206%20+%20%5Cfrac%7B2%20%5Ctimes0.75%20+%203%7D%7B8%7D%20%5Crfloor%20=%206"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Csmall%20Q_%7B0.75%7D%20=%20x_j%20+%20(x_%7Bj+1%7D%20-%20x_j)(np%20-%20j%20+%20%5Cfrac%7B2p%20+%203%7D%7B8%7D)%20=%20x_6%20+%20(x_7%20-%20x_6)(6%20-%206%20+%20%5Cfrac%7B2%20%5Ctimes%200.75%20+%203%7D%7B8%7D)%20="> <img src="https://latex.codecogs.com/png.latex?%5Csmall%2014.7%20+%20(15.4%20-%2014.7)%20%5Ctimes%200.5625%20=%2015.09375"></p></li>
</ul></li>
<li><p>Check the result using the <code>quantile()</code> function in R:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(</span>
<span id="cb17-2">  y, </span>
<span id="cb17-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>), </span>
<span id="cb17-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span></span>
<span id="cb17-5">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     25%      75% 
10.92500 15.09375 </code></pre>
</div>
</div></li>
</ul>
</div>
</div>
</div>
</section>
<section id="references" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="references"><span class="header-section-number">2</span> References</h2>
<p><strong>quantile</strong>: Sample Quantiles. Retrieved October 20, 2024, from <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/quantile" class="uri">https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/quantile</a></p>
<p><br></p>
</section>
<section id="add-your-comments" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="add-your-comments"><span class="header-section-number">3</span> Add your comments</h2>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <guid>https://www.amrbiostats.com/posts/biostats/B04_quantile_algorithms_stats.html</guid>
  <pubDate>Sat, 19 Oct 2024 20:00:00 GMT</pubDate>
  <media:content url="https://www.amrbiostats.com/images/biostats.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Measures of Central Tendency</title>
  <link>https://www.amrbiostats.com/posts/biostats/B03_cent_tendency_stats.html</link>
  <description><![CDATA[ 




<section id="background" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="background"><span class="header-section-number">1</span> Background</h2>
<ul>
<li><p>Collected data possess many observations that we are not interested in each one individually.</p></li>
<li><p>Instead, we are interested in summarizing the data in a concise and informative way.</p></li>
<li><p>Descriptive measures are single numbers that summarize the data.</p></li>
<li><p>They are used to describe the <code>center</code> and <code>spread</code> of the data.</p></li>
<li><p>They can be calculated from the data of a sample or a population.</p></li>
<li><p>Descriptive measures calculated from the sample are referred to as sample <code>statistics</code>, while those calculated from the population are referred to as population <code>parameters</code>.</p></li>
</ul>
</section>
<section id="measures-of-central-tendency" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="measures-of-central-tendency"><span class="header-section-number">2</span> Measures of central tendency</h2>
<ul>
<li><p>Measures of central tendency are used to describe the center of the data (i.e., the average or typical value).</p></li>
<li><p>They are also referred to as measures of location.</p></li>
<li><p>The most common measures of central tendency are the <code>mean</code>, <code>median</code>, and <code>mode</code>.</p></li>
</ul>
<section id="arithmetic-mean" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="arithmetic-mean"><span class="header-section-number">2.1</span> Arithmetic Mean</h3>
<ul>
<li><p>It is calculated by summing all observations and dividing by the total number of observations.</p></li>
<li><p>Let <img src="https://latex.codecogs.com/png.latex?X"> is a random variable:</p>
<ul>
<li><p>The mean of a finite population of size <img src="https://latex.codecogs.com/png.latex?N"> is denoted by <img src="https://latex.codecogs.com/png.latex?%5Cmu">, which reads as <code>mu</code>, while the mean of a sample of size <img src="https://latex.codecogs.com/png.latex?n"> is denoted by <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D">, which reads as <code>x-bar</code>.</p></li>
<li><p>The population and sample means can be calculated as follows:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Population mean</th>
<th style="text-align: center;">Sample mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%20%5Cdisplaystyle%20%5Cfrac%7Bx_1%20+%20x_2%20+%20%5Cldots%20+%20x_N%7D%7BN%7D%20=%20%5Cdisplaystyle%20%20%20%20%20%5Cfrac%7B%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7BN%7D%20x_i%7D%7BN%7D"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D%20=%20%5Cdisplaystyle%20%5Cfrac%7Bx_1%20+%20x_2%20+%20%5Cldots%20+%20x_n%7D%7Bn%7D%20=%20%5Cdisplaystyle%20%5Cfrac%7B%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20x_i%7D%7Bn%7D"></td>
</tr>
</tbody>
</table></li>
</ul></li>
<li><p>Example: consider the variable <code>mpg</code> in the <code>mtcars</code> dataset that we discussed in earlier chapters:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 15.2 10.4
[16] 10.4 14.7 32.4 30.4 33.9 21.5 15.5 15.2 13.3 19.2 27.3 26.0 30.4 15.8 19.7
[31] 15.0 21.4</code></pre>
</div>
</div>
<ul>
<li><p>The number of observations can be calculated using the <code>length()</code> function:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32</code></pre>
</div>
</div></li>
<li><p>The sum of all values can be calculated using the <code>sum()</code> function:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 642.9</code></pre>
</div>
</div></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D%20=%20%5Cdisplaystyle%20%5Cfrac%7B21%20+%2021%20+%2022.8%20+%20%5Cldots%20+%2021.4%7D%7B32%7D%20=%20%5Cfrac%7B642.9%7D%7B32%7D%20%5Capprox%2020.09"></p></li>
<li><p>The mean can be calculated directly using the built-in R function <code>mean()</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.09062</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>If the variable contains missing values, the <code>na.rm</code> argument should be set to <code>TRUE</code> to exclude them before calculating the mean, otherwise, the result will be <code>NA</code>.</p></li>
<li><p>For example, consider the following variable with some missing values <img src="https://latex.codecogs.com/png.latex?(1,%5C%202,%5C%203,%5C%20%5Ctext%7BNA%7D,%5C%205)">:</p>
<ul>
<li>Using the <code>mean()</code> function without the <code>na.rm</code> argument will return <code>NA</code>:</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<ul>
<li>This error can be avoided by setting the <code>na.rm</code> argument to <code>TRUE</code>:</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.75</code></pre>
</div>
</div></li>
</ul>
</div>
</div></li>
</ul></li>
<li><p>The mean can be calculated if the values are given along with their frequencies as weighted mean:</p>
<ul>
<li>Let <img src="https://latex.codecogs.com/png.latex?x_1,%20x_2,%20%5Cldots,%20x_k"> be the values of a variable with frequencies <img src="https://latex.codecogs.com/png.latex?f_1,%20f_2,%20%5Cldots,%20f_k">, then the weighted mean is calculated as:</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbar%7Bx%7D%20=%20%5Cdisplaystyle%20%5Cfrac%7Bf_1x_1%20+%20f_2x_2%20+%20%5Cldots%20+%20f_kx_k%7D%7Bf_1%20+%20f_2%20+%20%5Cldots%20+%20f_k%7D%20=%20%5Cdisplaystyle%20%5Cfrac%7B%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bk%7D%20f_ix_i%7D%7B%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bk%7D%20f_i%7D%0A"></p>
<ul>
<li><p>The <strong>weight</strong> of each observation <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20w_i%20=%20%20%20%5Cfrac%7Bf_i%7D%7B%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bk%7D%20f_i%7D">, therefore, the above equation can also be written as <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D%20=%20%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bk%7D%20w_ix_i"></p></li>
<li><p>Example: consider the following variable with values <img src="https://latex.codecogs.com/png.latex?(1.3,%5C%202.1,%5C%203.5,%5C%204.1,%5C%205.2)"> and frequencies <img src="https://latex.codecogs.com/png.latex?(2,%5C%203,%5C%201,%5C%204,%5C%202)">:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DT)</span>
<span id="cb13-2"></span>
<span id="cb13-3">Value <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.2</span>)</span>
<span id="cb13-4">Frequency <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb13-5"></span>
<span id="cb13-6">my_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb13-7">  Value,</span>
<span id="cb13-8">  Frequency,</span>
<span id="cb13-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Weight =</span> Frequency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(Frequency)</span>
<span id="cb13-10">)</span>
<span id="cb13-11"></span>
<span id="cb13-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">datatable</span>(</span>
<span id="cb13-13">  my_data, </span>
<span id="cb13-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb13-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>,</span>
<span id="cb13-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columnDefs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb13-17">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb13-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">className =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dt-center"</span>,</span>
<span id="cb13-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">targets =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_all"</span></span>
<span id="cb13-20">      )</span>
<span id="cb13-21">    )</span>
<span id="cb13-22">  ),</span>
<span id="cb13-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb13-24">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-ebcc9764f8035ee2e6e6" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ebcc9764f8035ee2e6e6">{"x":{"filter":"none","vertical":false,"data":[[1.3,2.1,3.5,4.1,5.2],[2,3,1,4,2],[0.1666666666666667,0.25,0.08333333333333333,0.3333333333333333,0.1666666666666667]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Value<\/th>\n      <th>Frequency<\/th>\n      <th>Weight<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-center","targets":"_all"},{"name":"Value","targets":0},{"name":"Frequency","targets":1},{"name":"Weight","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><br></p>
<ul>
<li>The weighted mean is calculated as:</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbar%7Bx%7D%20=%20%5Cdisplaystyle%20%5Cfrac%7B2%20%5Ctimes%201.3%20+%203%20%5Ctimes%202.1%20+%201%20%5Ctimes%203.5%20+%204%20%5Ctimes%204.1%20+%202%20%5Ctimes%205.2%7D%7B2%20+%203%20+%201%20+%204%20+%202%7D%20=%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B2.6%20+%206.3%20+%203.5%20+%2016.4%20+%2010.4%7D%7B12%7D%20=%20%5Cfrac%7B39.2%7D%7B12%7D%20%5Capprox%203.27%0A"></p>
<ul>
<li><p>It can also be calculated using the <code>weights</code> as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(my_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(Value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Weight))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.266667</code></pre>
</div>
</div></li>
<li><p>The built-in R function <code>weighted.mean()</code> can be used for direct calculation:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weighted.mean</span>(</span>
<span id="cb16-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> my_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Value, </span>
<span id="cb16-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> my_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Frequency)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># w represents the weights which can be given as frequencies or weights</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.266667</code></pre>
</div>
</div></li>
</ul></li>
</ul></li>
</ul>
<section id="sec-mean" class="level4" data-number="2.1.1">
<h4 data-number="2.1.1" class="anchored" data-anchor-id="sec-mean"><span class="header-section-number">2.1.1</span> Characteristics of the mean</h4>
<ol type="1">
<li>The sum of deviations of the observations from the arithmetic mean is always zero:</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20(x_i%20-%20%5Cbar%7Bx%7D)%20=%200%0A"></p>
<ol start="2" type="1">
<li><p>The sum of the squared deviations of the observations from a certain value is the least (i.e., minimized) when this value is the mean (this is referred to as the <code>least squares principle</code>).</p></li>
<li><p>If a constant <img src="https://latex.codecogs.com/png.latex?c"> is added to each observation, the mean is also increased by <img src="https://latex.codecogs.com/png.latex?c">, i.e., the mean of <img src="https://latex.codecogs.com/png.latex?x_i%20+%20c%20=%20%5Cbar%7Bx%7D%20+%20c">.</p></li>
<li><p>If the observations are multiplied by a constant <img src="https://latex.codecogs.com/png.latex?c">, then the mean is also multiplied by <img src="https://latex.codecogs.com/png.latex?c">, i.e., the mean of <img src="https://latex.codecogs.com/png.latex?cx_i%20=%20c%5Cbar%7Bx%7D">.</p></li>
<li><p>If the observations <img src="https://latex.codecogs.com/png.latex?x_1,%20x_2,%20%5Cldots%20x_n"> are linearly transformed, where <img src="https://latex.codecogs.com/png.latex?y_i%20=%20a%20+%20bx_i"> (<img src="https://latex.codecogs.com/png.latex?a"> and <img src="https://latex.codecogs.com/png.latex?b"> are known constants), then it holds that <img src="https://latex.codecogs.com/png.latex?%5Cbar%7By%7D%20=%20a%20+%20b%5Cbar%7Bx%7D">.</p></li>
<li><p>The mean is sensitive to extreme values (outliers), and it may not be a good measure of central tendency in the presence of outliers.</p>
<div id="lst-outlier" class="listing quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-outlier-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;1: Impact of outliers on the mean
</figcaption>
<div aria-describedby="lst-outlier-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<ul>
<li><p>Example: consider the following variable with values <img src="https://latex.codecogs.com/png.latex?(32.1,%5C%2034.5,%5C%2033.6,%5C%2037.2,%5C%2039.4)"> the mean is calculated as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">32.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">34.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">33.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">39.4</span>)</span>
<span id="cb18-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35.36</code></pre>
</div>
</div>
<ul>
<li><p>Lets replace the last value with an extreme value of <img src="https://latex.codecogs.com/png.latex?250.1">, so the values would be:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">250.1</span></span>
<span id="cb20-2">x</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  32.1  34.5  33.6  37.2 250.1</code></pre>
</div>
</div></li>
<li><p>The mean of the new values with the outlier would be:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 77.5</code></pre>
</div>
</div></li>
<li><p>The presence of the outlier affected the mean that it is no longer a good measure of central tendency for this variable.</p></li>
</ul></li>
</ul>
</div>
</figure>
</div></li>
</ol>
</section>
</section>
<section id="median" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="median"><span class="header-section-number">2.2</span> Median</h3>
<ul>
<li><p>The median, denoted by <img src="https://latex.codecogs.com/png.latex?%5Clarge%20%5Ctilde%7Bx%7D_%7B0.5%7D">, is the value which divides the ordered observations into two equal parts (i.e., at least 50% of the values <img src="https://latex.codecogs.com/png.latex?%5Cge"> the median and at least 50% of the values <img src="https://latex.codecogs.com/png.latex?%5Cle"> the median).</p></li>
<li><p>The median is calculated as follows:</p>
<ul>
<li><p>If the number of observations is odd, the median is the middle value of the ordered observations.</p></li>
<li><p>If the number of observations is even, the median is the arithmetic mean of the two middle observations.</p></li>
</ul></li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctilde%7Bx%7D_%7B0.5%7D%20=%20%5Cbegin%7Bcases%7D%20x_%7B%5Cfrac%7Bn+1%7D%7B2%7D%7D%20&amp;%20%5Ctext%7Bif%20$n$%20is%20odd%7D%20%5C%5C%20%5C%5C%20%5Cfrac%7B1%7D%7B2%7D(x_%7B%5Cfrac%7Bn%7D%7B2%7D%7D%20+%20x_%7B%5Cfrac%7Bn%7D%7B2%7D+1%7D)%20&amp;%20%5Ctext%7Bif%20$n$%20is%20even%7D%20%5Cend%7Bcases%7D%0A"></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">Example B.3.1 <iconify-icon inline="" icon="ic:round-menu-book" style="font-size: 21px;" aria-label="Icon round-menu-book from ic Iconify.design set." title="Icon round-menu-book from ic Iconify.design set."></iconify-icon></a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">Example B.3.2 <iconify-icon inline="" icon="ic:round-menu-book" style="font-size: 21px;" aria-label="Icon round-menu-book from ic Iconify.design set." title="Icon round-menu-book from ic Iconify.design set."></iconify-icon></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<ul>
<li><p>Consider the following set of observations: <img src="https://latex.codecogs.com/png.latex?(3,%205,%207,%207,%207,%209,%2011)">.</p>
<ul>
<li><p>There is an odd number of observations <img src="https://latex.codecogs.com/png.latex?n%20=%207">, so the median is the middle value of the ordered observations, which is ranked <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cfrac%7Bn+1%7D%7B2%7D%20=%20%5Cfrac%7B7+1%7D%7B2%7D=4%5E%7Bth%7D"> and its value is <img src="https://latex.codecogs.com/png.latex?7">.</p></li>
<li><p>Half of the measurements <img src="https://latex.codecogs.com/png.latex?(3,%205,%207)"> are below or equal to <img src="https://latex.codecogs.com/png.latex?7">, and half of the measurements <img src="https://latex.codecogs.com/png.latex?(7,%209,%2011)"> are equal to or above <img src="https://latex.codecogs.com/png.latex?7">.</p></li>
<li><p>Therefore, the previous defintion of the median contains “equal to” to cover the case of having repeated, similar values.</p></li>
</ul></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<ul>
<li><p>Example: the variable <code>mpg</code> has <img src="https://latex.codecogs.com/png.latex?32"> observations, so the median is the arithmetic mean of the two middle observations (i.e., the mean of the ordered observations ranked <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cfrac%7B32%7D%7B2%7D%20=%2016%5E%7Bth%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cfrac%7B32%7D%7B2%7D%20+%201%20=17%5E%7Bth%7D">):</p>
<ul>
<li><p>The ordered observations are:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">mpg_ordered <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span>
<span id="cb24-2">mpg_ordered</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 10.4 10.4 13.3 14.3 14.7 15.0 15.2 15.2 15.5 15.8 16.4 17.3 17.8 18.1 18.7
[16] 19.2 19.2 19.7 21.0 21.0 21.4 21.4 21.5 22.8 22.8 24.4 26.0 27.3 30.4 30.4
[31] 32.4 33.9</code></pre>
</div>
</div></li>
<li><p>The <img src="https://latex.codecogs.com/png.latex?16%5E%7Bth%7D"> and <img src="https://latex.codecogs.com/png.latex?17%5E%7Bth%7D"> ordered observations are:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">mpg_ordered[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>]</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.2 19.2</code></pre>
</div>
</div></li>
<li><p>The median is the arithmetic mean of these two values:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(mpg_ordered[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>])</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.2</code></pre>
</div>
</div></li>
<li><p>The median can also be calculated using the built-in R function <code>median()</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.2</code></pre>
</div>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>
<section id="characteristics-of-the-median" class="level4" data-number="2.2.1">
<h4 data-number="2.2.1" class="anchored" data-anchor-id="characteristics-of-the-median"><span class="header-section-number">2.2.1</span> Characteristics of the median</h4>
<ul>
<li><p>Unlike the mean, the median is not drastically affected by extreme values (outliers).</p></li>
<li><p>Consider the example discussed above Listing&nbsp;1:</p>
<ul>
<li><p>The median of the original set of observations is:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">32.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">34.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">33.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">39.4</span>))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 34.5</code></pre>
</div>
</div></li>
<li><p>The median of the set of observations with the outlier is:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">32.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">34.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">33.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">250.1</span>))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 34.5</code></pre>
</div>
</div></li>
<li><p>Because the median is concerned with the middle value, it is less affected by the presence of the outliers than the mean.</p></li>
</ul></li>
<li><p>The median is a robust measure of central tendency, and it is preferred when the data is skewed or contains outliers.</p></li>
</ul>
</section>
</section>
<section id="quantiles" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="quantiles"><span class="header-section-number">2.3</span> Quantiles</h3>
<ul>
<li><p>Quantiles are a generalization of of the concept of the median.</p></li>
<li><p>A quantile is defined as the value that divides the ordered observations into two parts such that a certain proportion of the observations are less than or equal to the quantile.</p></li>
<li><p>In this sense, the median is the <img src="https://latex.codecogs.com/png.latex?50%5E%7Bth%7D"> quantile because at least <img src="https://latex.codecogs.com/png.latex?50%5C%25"> of the observations are less than or equal to the median.</p></li>
<li><p>Similarly, the <img src="https://latex.codecogs.com/png.latex?20%5E%7Bth%7D"> quantile is the value that divides the ordered observations into two parts such that at least <img src="https://latex.codecogs.com/png.latex?20%5C%25"> of the observations are less than or equal to the that quantile, while at least <img src="https://latex.codecogs.com/png.latex?80%5C%25"> of the observations are greater than or equal to that quantile.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;" title="General definition of quantiles">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
General definition of quantiles
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Let <img src="https://latex.codecogs.com/png.latex?%5Calpha"> be a number between <img src="https://latex.codecogs.com/png.latex?0"> and <img src="https://latex.codecogs.com/png.latex?1">.</p></li>
<li><p>The <img src="https://latex.codecogs.com/png.latex?%5B(%5Calpha%20%5Ctimes%20100)%5C%25"> quantile is denoted by <img src="https://latex.codecogs.com/png.latex?%5Clarge%20%5Ctilde%7Bx%7D_%7B%5Calpha%7D">.</p></li>
<li><p>It is defined as the value that splits the data into two parts such that at least <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Ctimes%20100%5C%25"> of the observations are less than or equal to the quantile, while at least <img src="https://latex.codecogs.com/png.latex?(1%20-%20%5Calpha)%20%5Ctimes%20100%5C%25"> of the observations are greater than or equal to the quantile.</p></li>
</ul>
</div>
</div>
<ul>
<li><p><strong>Deciles</strong> divide the data into <img src="https://latex.codecogs.com/png.latex?10"> parts, corresponding to quantiles at <img src="https://latex.codecogs.com/png.latex?%5Calpha%20=%200.1,%200.2,%20%5Cldots,%200.9">.</p></li>
<li><p><strong>Quintiles</strong> divide the data into <img src="https://latex.codecogs.com/png.latex?5"> parts, corresponding to quantiles at <img src="https://latex.codecogs.com/png.latex?%5Calpha%20=%200.2,%200.4,%200.6,%200.8">.</p></li>
<li><p><strong>Quartiles</strong> divide the data into <img src="https://latex.codecogs.com/png.latex?4"> parts, corresponding to quantiles at <img src="https://latex.codecogs.com/png.latex?%5Calpha%20=%200.25,%200.5,%200.75">.</p></li>
<li><p><strong>Percentiles</strong>: if <img src="https://latex.codecogs.com/png.latex?(%5Calpha%20%5Ctimes%20100)"> takes an integer value, the quantile is referred to as a percentile (i.e, divide the data into <img src="https://latex.codecogs.com/png.latex?100"> equal parts).</p></li>
</ul>
<section id="calculation-of-quantiles" class="level4" data-number="2.3.1">
<h4 data-number="2.3.1" class="anchored" data-anchor-id="calculation-of-quantiles"><span class="header-section-number">2.3.1</span> Calculation of quantiles</h4>
<ul>
<li><p>The quantiles can be obtained in R using the <code>quantile()</code> function.</p></li>
<li><p>For example, the quantiles of the variable <code>mpg</code> in the <code>mtcars</code> dataset can be calculated as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    0%    25%    50%    75%   100% 
10.400 15.425 19.200 22.800 33.900 </code></pre>
</div>
</div></li>
<li><p>By default, The function outputs the <img src="https://latex.codecogs.com/png.latex?0%5E%7Bth%7D">, <img src="https://latex.codecogs.com/png.latex?25%5E%7Bth%7D">, <img src="https://latex.codecogs.com/png.latex?50%5E%7Bth%7D">, <img src="https://latex.codecogs.com/png.latex?75%5E%7Bth%7D">, and <img src="https://latex.codecogs.com/png.latex?100%5E%7Bth%7D"> quantiles (i.e., the minimum, first quartile, median, third quartile, and maximum).</p></li>
<li><p>To get a specific quantile, use the <code>probs</code> argument to add a vector of the desired probabilities (i.e., <img src="https://latex.codecogs.com/png.latex?%5Calpha">). For example, the following code can be used to get the <img src="https://latex.codecogs.com/png.latex?5%5E%7Bth%7D"> and <img src="https://latex.codecogs.com/png.latex?95%5E%7Bth%7D"> quantiles:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(</span>
<span id="cb38-2">  mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg, </span>
<span id="cb38-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span>
<span id="cb38-4">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    5%    95% 
11.995 31.300 </code></pre>
</div>
</div></li>
<li><p>R provides <strong>nine</strong> algorithms to calculate the quantiles, which can be specified using the <code>type</code> argument:</p>
<ul>
<li><p>Types <img src="https://latex.codecogs.com/png.latex?1-3"> are used for discontinuous data, while types <img src="https://latex.codecogs.com/png.latex?4-9"> are used for continuous data.</p></li>
<li><p>Type <img src="https://latex.codecogs.com/png.latex?1"> and <img src="https://latex.codecogs.com/png.latex?3"> are used for class “Date” and for ordered factors.</p></li>
<li><p>Type <img src="https://latex.codecogs.com/png.latex?7"> is the default method for continous data.</p></li>
<li><p>Type <img src="https://latex.codecogs.com/png.latex?6"> is used to get results similar to <code>SPSS</code>, <code>Minitab</code>, or <code>Graphpad Prism</code>.</p></li>
<li><p>For example, the of <img src="https://latex.codecogs.com/png.latex?25%5E%7Bth%7D"> and <img src="https://latex.codecogs.com/png.latex?75%5E%7Bth%7D"> quantiles of the variable <code>mpg</code> in the <code>mtcars</code> dataset using <code>R</code> (type <img src="https://latex.codecogs.com/png.latex?6"> or <img src="https://latex.codecogs.com/png.latex?7">), <code>SPSS</code>, and, <code>Graphpad Prism</code> are as follows:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true">R</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" aria-controls="tabset-2-2" aria-selected="false">SPSS</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" aria-controls="tabset-2-3" aria-selected="false">Graphpad Prism</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" aria-labelledby="tabset-2-1-tab">
<ul>
<li>Using type <img src="https://latex.codecogs.com/png.latex?6">:</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(</span>
<span id="cb40-2">mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg, </span>
<span id="cb40-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>),</span>
<span id="cb40-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb40-5">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   25%    75% 
15.275 22.800 </code></pre>
</div>
</div>
<ul>
<li>Using type <img src="https://latex.codecogs.com/png.latex?7">:</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(</span>
<span id="cb42-2">mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg, </span>
<span id="cb42-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>),</span>
<span id="cb42-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb42-5">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   25%    75% 
15.425 22.800 </code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" aria-labelledby="tabset-2-2-tab">
<p><img src="https://www.amrbiostats.com/images/quantile_A.png" alt="SPSS" width="100%"></p>
</div>
<div id="tabset-2-3" class="tab-pane" aria-labelledby="tabset-2-3-tab">
<p><img src="https://www.amrbiostats.com/images/quantile_B.png" alt="Graphpad Prism" width="80%"></p>
</div>
</div>
</div></li>
<li><p>Detailed discussion of the algorithms used to calculate the quantiles can be found <a href="../../posts/biostats/B04_quantile_algorithms_stats.html">here</a>.</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="trimean" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="trimean"><span class="header-section-number">2.4</span> Trimean</h3>
<ul>
<li>The trimean is defined as weighted average of the first quartile <img src="https://latex.codecogs.com/png.latex?(Q_1)">, the median <img src="https://latex.codecogs.com/png.latex?(Q_2)">, and the third quartile <img src="https://latex.codecogs.com/png.latex?(Q_3)">:</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%20%7BTrimean%7D%20=%20%5Cfrac%7BQ_1%20+%20(2%20%5Ctimes%20Q_2)%20+%20Q_3%7D%7B4%7D%0A"></p>
<ul>
<li>The trimean is a robust measure of central tendency and has the advantage that it uses more information than the median, which is based on only one value and ignores the overall distribution.</li>
</ul>
</section>
<section id="mode" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="mode"><span class="header-section-number">2.5</span> Mode</h3>
<ul>
<li><p>The mode of a set of observations is the observation that occurs most frequently compared with all other values.</p></li>
<li><p>A set of observations can have:</p>
<ul>
<li><p>No mode (if all observations occur with the same frequency).</p></li>
<li><p>One mode (if one observation occurs most frequently).</p></li>
<li><p>More than one mode (if two or more observations occur with the same highest frequency).</p></li>
</ul></li>
<li><p>Example: consider the variable <code>cyl</code> (number of car cylinders) in the <code>mtcars</code> dataset:</p>
<ul>
<li><p>R has no direct built-in function to calculate the mode, but it can be calculated from the frequency table as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb44-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create table of the frequencies of the values</span></span>
<span id="cb44-3">freq_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cyl)</span>
<span id="cb44-4"></span>
<span id="cb44-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># convert to adata frame</span></span>
<span id="cb44-6">freq_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(freq_tbl)</span>
<span id="cb44-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(freq_df)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cyl"</span></span>
<span id="cb44-8"></span>
<span id="cb44-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># arrange the values in descending order of frequency</span></span>
<span id="cb44-10">freq_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb44-11">  freq_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb44-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(Freq))</span>
<span id="cb44-13"></span>
<span id="cb44-14">freq_df</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  cyl Freq
1   8   14
2   4   11
3   6    7</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(</span>
<span id="cb46-2">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The mode is"</span>, </span>
<span id="cb46-3">  freq_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cyl[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which.max</span>(freq_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Freq)], </span>
<span id="cb46-4">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cyliners"</span></span>
<span id="cb46-5">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The mode is 8 cyliners"</code></pre>
</div>
</div></li>
<li><p>The mode can also be calculated directly using the <code>Mode()</code> function from the <code>DescTools</code> package:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DescTools)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'DescTools' was built under R version 4.4.1</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Mode</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cyl)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8
attr(,"freq")
[1] 14</code></pre>
</div>
</div>
<ul>
<li>The first line of the output shows the mode (<img src="https://latex.codecogs.com/png.latex?8"> cylinders) and the last line shows the frequency of the mode.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>R has a built-in function <code>mode()</code> that returns the storage mode of an object (e.g., numeric, character, etc.) rather than the mode.</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mode</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cyl)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
</div></li>
</ul>
</div>
</div>
<ul>
<li><p>For numerical data which contains many unique values, the mode may not be a good measure of central tendency. However, if the observations are summarized in groups (e.g., frequency table or histogram), the mode can be calculated as the class interval with the highest frequency.</p>
<ul>
<li><p>Example: consider the histogram of the variable <code>mpg</code> in the <code>mtcars</code> dataset:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B03_cent_tendency_stats_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The class interval <img src="https://latex.codecogs.com/png.latex?(15,%2020%5D"> has the highest frequency of <img src="https://latex.codecogs.com/png.latex?12"> observations, so the mode is the interval <img src="https://latex.codecogs.com/png.latex?(15,%2020%5D"> (others may also consider the midpoint of the interval, <img src="https://latex.codecogs.com/png.latex?17.5">, as the mode).</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="geometric-mean" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="geometric-mean"><span class="header-section-number">2.6</span> Geometric mean</h3>
<ul>
<li><p>Let <img src="https://latex.codecogs.com/png.latex?X"> a quantitative random variable with <code>positive</code> and <code>non-zero</code> values <img src="https://latex.codecogs.com/png.latex?x_1,%20x_2,%20%5Cldots,%20x_n">, then the geometric mean <img src="https://latex.codecogs.com/png.latex?(%5Cbar%7Bx%7D_G)"> is computed by multiplying all the values and then taking the <img src="https://latex.codecogs.com/png.latex?n%5E%7Bth%7D"> root of the product:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbar%7Bx%7D_G%20=%20%5Clarge%20%5Csqrt%5Bn%5D%7Bx_1%20%5Ctimes%20x_2%20%5Ctimes%20%5Cldots%20%5Ctimes%20x_n%7D%20=%20%5Cleft(%20%5Cdisplaystyle%20%5Cprod_%7Bi=1%7D%5E%7Bn%7D%20x_i%20%5Cright)%5E%7B%5Cfrac%7B1%7D%7Bn%7D%7D%0A"></p></li>
<li><p>It is less sensitive to extreme values in skewed distributions than the arithmetic mean.</p></li>
<li><p>Geometric mean is used for averaging data that are <code>multiplicative</code> in nature (e.g., percentage change and rates).</p>
<ul>
<li><p><strong>Percentage change</strong> is calculated as the difference between the final <img src="https://latex.codecogs.com/png.latex?(x_1)"> and initial <img src="https://latex.codecogs.com/png.latex?(x_0)"> values divided by the initial value, then multiplied by <img src="https://latex.codecogs.com/png.latex?100">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20%20%20%5Cdisplaystyle%20%5Ctext%7BPercentage%20change%7D%20=%20%5Cleft(%20%5Cfrac%7Bx_1%20-%20x_0%7D%7Bx_0%7D%20%5Cright)%20%5Ctimes%20100%0A"></p>
<ul>
<li>If the sign of the percentage change is positive, it indicates an increase, while a negative sign indicates a decrease.</li>
</ul></li>
<li><p><strong>Rate</strong> is the ratio of two quantities that describes how one quantity changes with respect to another (e.g., speed, growth rate, and interest rate).</p></li>
</ul></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" aria-controls="tabset-3-1" aria-selected="true">Example B.3.3 <iconify-icon inline="" icon="ic:round-menu-book" style="font-size: 21px;" aria-label="Icon round-menu-book from ic Iconify.design set." title="Icon round-menu-book from ic Iconify.design set."></iconify-icon></a></li><li class="nav-item"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" aria-controls="tabset-3-2" aria-selected="false">Example B.3.4 <iconify-icon inline="" icon="ic:round-menu-book" style="font-size: 21px;" aria-label="Icon round-menu-book from ic Iconify.design set." title="Icon round-menu-book from ic Iconify.design set."></iconify-icon></a></li><li class="nav-item"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" aria-controls="tabset-3-3" aria-selected="false"><span style="color: #ba181b">Exercise B.3.1 <iconify-icon inline="" icon="fluent:chat-bubbles-question-20-filled" style="font-size: 21px;" aria-label="Icon chat-bubbles-question-20-filled from fluent Iconify.design set." title="Icon chat-bubbles-question-20-filled from fluent Iconify.design set."></iconify-icon></span></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" aria-labelledby="tabset-3-1-tab">
<ul>
<li><p>Consider the following set of observations: <img src="https://latex.codecogs.com/png.latex?(4,%2016,%2064,%20256)">.</p></li>
<li><p>The geometric mean is calculated as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20%5Csqrt%5B4%5D%7B4%20%5Ctimes%2016%20%5Ctimes%2064%20%5Ctimes%20256%7D%20=%20%5Csqrt%5B4%5D%7B1048576%7D%20=%2032%0A"></p></li>
<li><p>The geometric mean can be calculated using the <code>Gmean()</code> function from the <code>DescTools</code> package or the <code>geometric.mean()</code> function from the <code>psych</code> package:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DescTools)</span>
<span id="cb54-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(psych)</span>
<span id="cb54-3">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>)</span>
<span id="cb54-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Gmean</span>(x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geometric.mean</span>(x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32</code></pre>
</div>
</div></li>
</ul>
</div>
<div id="tabset-3-2" class="tab-pane" aria-labelledby="tabset-3-2-tab">
<ul>
<li><p>Assume a bank provides the following interest rates for a three-year plan: <img src="https://latex.codecogs.com/png.latex?3.3%5C%25"> in the first year, <img src="https://latex.codecogs.com/png.latex?4.5%5C%25"> in the second year, and <img src="https://latex.codecogs.com/png.latex?5.2%5C%25"> in the third year.</p></li>
<li><p>If a client deposits <img src="https://latex.codecogs.com/png.latex?%5Ctextdollar%7B500%7D">, the change in the amount can be calculated as follows:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Time</th>
<th style="text-align: center;">Year</th>
<th style="text-align: center;">Amount <img src="https://latex.codecogs.com/png.latex?(%5Ctextdollar)"></th>
<th style="text-align: center;">Rate <img src="https://latex.codecogs.com/png.latex?(%5C%25)"></th>
<th style="text-align: center;">Interest <img src="https://latex.codecogs.com/png.latex?(%5Ctextdollar)"> <img src="https://latex.codecogs.com/png.latex?(%5Ctext%7BRate%7D_t%20%5Ctimes%20%5Ctext%7BAmount%7D_%7Bt-1%7D)"></th>
<th style="text-align: center;">Growth factor <img src="https://latex.codecogs.com/png.latex?(%5Ctext%7BAmount%7D_t/%5Ctext%7BAmount%7D_%7Bt-1%7D)"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?t_0"></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?500.0"></td>
<td style="text-align: center;">–</td>
<td style="text-align: center;">–</td>
<td style="text-align: center;">–</td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?t_1"></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?516.5"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?3.3"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?16.5"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?1.033"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?t_2"></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?539.7"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?4.5"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?23.2"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?1.045"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?t_3"></td>
<td style="text-align: center;">3</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?567.8"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?5.2"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?28.1"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?1.052"></td>
</tr>
</tbody>
</table></li>
<li><p>The interest rate is also known as the <code>growth rate</code>.</p></li>
<li><p>The growth rate <img src="https://latex.codecogs.com/png.latex?=%20(%5Ctext%7Bgrowth%20factor%7D%20-%201)%20%5Ctimes%20100">.</p></li>
<li><p>The average growth factor is calculated as the geometric mean of the growth factors:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1">growth_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.033</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.045</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.052</span>)</span>
<span id="cb58-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Gmean</span>(growth_factors)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.043304</code></pre>
</div>
</div></li>
<li><p>So, the average growth rate per year <img src="https://latex.codecogs.com/png.latex?=%20(1.043%20-%201)%20%5Ctimes%20100%20=%204.3%5C%25">.</p></li>
<li><p>This average growth rate can also be obtained by calculating the geometric mean of the interest (growth) rates:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1">interest_rates <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.2</span>)</span>
<span id="cb60-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Gmean</span>(interest_rates)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.258369</code></pre>
</div>
</div></li>
<li><p>However, this approach is not recommended because the interest rates can be negative (the rate decreases), which results in error while computing the geometric mean.</p></li>
<li><p>The total amount of money (<img src="https://latex.codecogs.com/png.latex?A">) can be calculated at any year using the formula: <img src="https://latex.codecogs.com/png.latex?A_t%20=%20A_%7Bt_0%7D%20%5Ctimes%20(%5Ctext%7Baverage%20growth%20factor%7D)%20%5Clarge%20%5Et">. For example, the amount at the end of the third year <img src="https://latex.codecogs.com/png.latex?=%20500%20%5Ctimes%201.043304%5E3%20=%20%5Ctextdollar567.8">.</p></li>
</ul>
</div>
<div id="tabset-3-3" class="tab-pane" aria-labelledby="tabset-3-3-tab">
<ul>
<li><p>Calculate the average interest rate for the following four-year plan: <img src="https://latex.codecogs.com/png.latex?10%5C%25">, <img src="https://latex.codecogs.com/png.latex?14%5C%25">, <img src="https://latex.codecogs.com/png.latex?15%5C%25">, and <img src="https://latex.codecogs.com/png.latex?-5%5C%25">.</p>
<p>The average rate per year is <input class="webex-solveme nospaces" size="3" data-answer="[&quot;8.2&quot;]"> <img src="https://latex.codecogs.com/png.latex?%5C%25"> (to one decimal place)</p></li>
</ul>
<div class="webex-solution">
<button>
Click to show/hide answer
</button>
<ul>
<li><p>The average interest rate can not be computed directly by calculating the geometric mean of the interest rates because the last rate is negative.</p></li>
<li><p>Therefore, we calculate the average growth factor as the geometric mean of the growth factors.</p></li>
<li><p>Growth factor <img src="https://latex.codecogs.com/png.latex?=%20%5Cdisplaystyle%20%5Cfrac%7B%5Ctext%7Brate%7D%7D%7B100%7D%20+%201"></p></li>
<li><p>So, the growth factors are <img src="https://latex.codecogs.com/png.latex?(1.1,%201.14,%201.15,%200.95)">.</p></li>
<li><p>The average growth factor is equal to:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1">growth_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.14</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.15</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span>
<span id="cb62-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Gmean</span>(growth_factors)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.081882</code></pre>
</div>
</div></li>
<li><p>Therefore, the average interest rate per year is <img src="https://latex.codecogs.com/png.latex?8.2%5C%25">.</p></li>
</ul>
</div>
</div>
</div>
</div>
<section id="geometric-mean-and-logarihmic-transformation" class="level4" data-number="2.6.1">
<h4 data-number="2.6.1" class="anchored" data-anchor-id="geometric-mean-and-logarihmic-transformation"><span class="header-section-number">2.6.1</span> Geometric mean and logarihmic transformation</h4>
<ul>
<li><p>If the observations are transformed by taking the logarithm (common or natural), <span style="color: #0466c8">the antilogarithm of the arithmetic mean of the transformed values</span> is equal to <span style="color: #ba181b">the geometric mean of the original values</span>.</p>
<ul>
<li><p>Let <img src="https://latex.codecogs.com/png.latex?X"> be a random variable with positive, non-zero values <img src="https://latex.codecogs.com/png.latex?x_1,%20x_2,%20%5Cldots,%20x_n">, and <img src="https://latex.codecogs.com/png.latex?Y"> is the transformed variable with values <img src="https://latex.codecogs.com/png.latex?y_1,%20y_2,%20%5Cldots,%20y_n"> such that <img src="https://latex.codecogs.com/png.latex?y_i%20=%20%5Clog_%7B10%7D(x_i)">:</p></li>
<li><p>The arithmetic mean of the transformed values is calculated as:</p></li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbar%7By%7D%20=%20%5Cdisplaystyle%20%5Cfrac%7By_1%20+%20y_2%20+%20%5Cldots%20+%20y_n%7D%7Bn%7D%20=%20%5Cdisplaystyle%20%5Cfrac%7B%5Clog_%7B10%7D(x_1)%20+%20%5Clog_%7B10%7D(x_2)%20+%20%5Cldots%20+%20%5Clog_%7B10%7D(x_n)%7D%7Bn%7D%20=%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clog_%7B10%7D%20%5Cleft(%20%5Csqrt%5Bn%5D%7Bx_1%20%5Ctimes%20x_2%20%5Ctimes%20%5Cldots%20%5Ctimes%20x_n%7D%20%5Cright)%0A"></p>
<ul>
<li>The antilogarithm of the arithmetic mean of the transformed values is:</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A10%5E%7B%5Cbar%7By%7D%7D%20=%2010%5E%7B%5Clog_%7B10%7D%20%5Cleft(%20%5Csqrt%5Bn%5D%7Bx_1%20%5Ctimes%20x_2%20%5Ctimes%20%5Cldots%20%5Ctimes%20x_n%7D%20%5Cright)%7D%20=%20%5Csqrt%5Bn%5D%7Bx_1%20%5Ctimes%20x_2%20%5Ctimes%20%5Cldots%20%5Ctimes%20x_n%7D%0A"></p>
<ul>
<li>The last equation represents the geometric mean of the original values.</li>
</ul></li>
<li><p>Example: consider the following set of observations <img src="https://latex.codecogs.com/png.latex?(5,%5C%209,%5C%2010,%5C%2022,%5C%2013,%2050)">, the following table shows the original and <img src="https://latex.codecogs.com/png.latex?log_%7B10%7D"> transformed values:</p>
<div class="grid">
<div class="g-col-2">

</div>
<div class="g-col-8">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DT)</span>
<span id="cb64-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb64-3">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(x), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb64-4"></span>
<span id="cb64-5">my_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb64-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Original =</span> x,</span>
<span id="cb64-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Log10_transformed =</span> y</span>
<span id="cb64-8">)</span>
<span id="cb64-9"></span>
<span id="cb64-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">datatable</span>(</span>
<span id="cb64-11">  my_data, </span>
<span id="cb64-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb64-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>,</span>
<span id="cb64-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columnDefs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb64-15">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb64-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">className =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dt-center"</span>,</span>
<span id="cb64-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">targets =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_all"</span></span>
<span id="cb64-18">      )</span>
<span id="cb64-19">    )</span>
<span id="cb64-20">  ),</span>
<span id="cb64-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb64-22">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-4214a8320c8399a4bcbf" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4214a8320c8399a4bcbf">{"x":{"filter":"none","vertical":false,"data":[[5,9,10,22,13,50],[0.69897,0.95424,1,1.34242,1.11394,1.69897]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Original<\/th>\n      <th>Log10_transformed<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-center","targets":"_all"},{"name":"Original","targets":0},{"name":"Log10_transformed","targets":1}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div class="g-col-2">

</div>
</div>
<p><br></p>
<ul>
<li><p>The arithmetic mean of the transformed values is:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(y)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.134757</code></pre>
</div>
</div></li>
<li><p>The antilogarithm of the arithmetic mean of the transformed values is:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(y)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.63819</code></pre>
</div>
</div></li>
<li><p>The geometric mean of the original values is:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Gmean</span>(x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.63823</code></pre>
</div>
</div></li>
<li><p>The antilogarithm of the arithmetic mean of the transformed values is equal to the geometric mean of the original values.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>When the original values are log transformed, the back-transformed mean is not the same as the original mean but it is the geometric mean of the original values.</p></li>
<li><p>On the other hand, back-transforming the median of the log-transformed values gives the median of the original values:</p>
<ul>
<li><p>For the <code>mpg</code> variable from the <code>mtcars</code> dataset, the median of the log-transformed values is:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1">med_log <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(</span>
<span id="cb71-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg))</span>
<span id="cb71-3">med_log</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.95491</code></pre>
</div>
</div></li>
<li><p>The antilogarithm of the median (back transformation) of the log-transformed values is:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(med_log) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># exponentiation to back transform</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.2</code></pre>
</div>
</div></li>
<li><p>The median of the original values is:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb75" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.2</code></pre>
</div>
</div></li>
<li><p>The antilogarithm of the median of the log-transformed values is equal to the median of the original values.</p></li>
</ul></li>
</ul>
</div>
</div></li>
</ul>
</section>
</section>
<section id="harmonic-mean" class="level3" data-number="2.7">
<h3 data-number="2.7" class="anchored" data-anchor-id="harmonic-mean"><span class="header-section-number">2.7</span> Harmonic mean</h3>
<ul>
<li><p>The harmonic mean <img src="https://latex.codecogs.com/png.latex?(%5Cbar%7Bx%7D_H)"> is the reciprocal of the arithmetic mean of the reciprocals of the observations:</p>
<ul>
<li>Let <img src="https://latex.codecogs.com/png.latex?X"> be a random variable with values <img src="https://latex.codecogs.com/png.latex?x_1,%20x_2,%20%5Cldots,%20x_n">, then the reciprocals of the observations are <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bx_1%7D,%20%5Cfrac%7B1%7D%7Bx_2%7D,%20%5Cldots,%20%5Cfrac%7B1%7D%7Bx_n%7D">, and their arithmetic mean is calculated as:</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bn%7D%20%5Cleft(%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bx_1%7D%20+%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bx_2%7D%20+%20%5Cldots%20+%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7Bx_n%7D%20%5Cright)%20=%20%5Cdisplaystyle%20%5Cfrac%7B%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20%5Cfrac%7B1%7D%7Bx_i%7D%7D%7Bn%7D%0A"></p>
<ul>
<li>The harmonic mean is the reciprocal of the arithmetic mean of the reciprocals:</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbar%7Bx%7D_H%20=%20%5Cdisplaystyle%20%5Cfrac%7Bn%7D%7B%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20%5Cfrac%7B1%7D%7Bx_i%7D%7D%0A"></p></li>
<li><p>It is used for averaging data that are <code>ratios</code> or <code>rates</code> (e.g., speed or financial ratios).</p></li>
<li><p>If the observations do not contribute equally towards the calculation of the mean (i.e., the observations have different weights), the harmonic mean can be weighted:</p>
<ul>
<li>Let <img src="https://latex.codecogs.com/png.latex?X"> be a random variable with values <img src="https://latex.codecogs.com/png.latex?x_1,%20x_2,%20%5Cldots,%20x_n"> that have coressponding weights <img src="https://latex.codecogs.com/png.latex?w_1,%20w_2,%20%5Cldots,%20w_n">, then the harmonic mean is calculated as:</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7BWeighted%7D%5C%20%5Cbar%7Bx%7D_H%20=%20%5Cdisplaystyle%20%5Cfrac%7Bw_1%20+%20w_2%20+%20%5Cldots%20+%20w_n%7D%7B%5Cdisplaystyle%20%5Cfrac%7Bw_1%7D%7Bx_1%7D%20+%20%5Cfrac%7Bw_2%7D%7Bx_2%7D%20+%20%5Cldots%20+%20%5Cfrac%7Bw_n%7D%7Bx_n%7D%7D%20=%20%5Cdisplaystyle%20%5Cfrac%7B%5Cdisplaystyle%20%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20w_i%7D%7B%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20%5Cfrac%7Bw_i%7D%7Bx_i%7D%7D%20=%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7B%5Cdisplaystyle%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20%5Cfrac%7Bw_i%7D%7Bx_i%7D%7D%0A"></p></li>
<li><p>Example: consider the following set of observations <img src="https://latex.codecogs.com/png.latex?(2,%204,%206,%208)">:</p>
<ul>
<li><p>The harmonic mean is calculated as:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb77" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span>
<span id="cb77-2">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x)</span>
<span id="cb77-3">harmonic_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> x)</span>
<span id="cb77-4">harmonic_mean</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.84</code></pre>
</div>
</div></li>
<li><p>The harmonic mean can also be calculated using the <code>Hmean()</code> function from the <code>DescTools</code> package or <code>harmonic.mean()</code> function from the <code>psych</code> package:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb79" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DescTools)</span>
<span id="cb79-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Hmean</span>(x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.84</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb81" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(psych)</span>
<span id="cb81-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">harmonic.mean</span>(x)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.84</code></pre>
</div>
</div></li>
</ul></li>
<li><p>The harmonic mean is used to calculate some statistical measures such as F1 score used to assess the performance of logistic regression models. In addition, it is used during pairwise multiple comparisons.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" aria-controls="tabset-4-1" aria-selected="true">Example B.3.5 <iconify-icon inline="" icon="ic:round-menu-book" style="font-size: 21px;" aria-label="Icon round-menu-book from ic Iconify.design set." title="Icon round-menu-book from ic Iconify.design set."></iconify-icon></a></li><li class="nav-item"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" aria-controls="tabset-4-2" aria-selected="false">Example B.3.6 <iconify-icon inline="" icon="ic:round-menu-book" style="font-size: 21px;" aria-label="Icon round-menu-book from ic Iconify.design set." title="Icon round-menu-book from ic Iconify.design set."></iconify-icon></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" aria-labelledby="tabset-4-1-tab">
<p>A car travels <img src="https://latex.codecogs.com/png.latex?100%5C%20%5Ctext%7Bkm%7D"> at a speed <img src="https://latex.codecogs.com/png.latex?60%5C%20%5Ctext%7Bkm/h%7D">, <img src="https://latex.codecogs.com/png.latex?100%5C%20%20%5Ctext%7Bkm%7D"> at <img src="https://latex.codecogs.com/png.latex?70%5C%20%5Ctext%7Bkm/h%7D">, <img src="https://latex.codecogs.com/png.latex?100%5C%20%5Ctext%7Bkm%7D"> at <img src="https://latex.codecogs.com/png.latex?90%5C%20%5Ctext%7Bkm/h%7D">, and <img src="https://latex.codecogs.com/png.latex?100%5C%20%5Ctext%7Bkm%7D"> at <img src="https://latex.codecogs.com/png.latex?100%5C%20%5Ctext%7Bkm/h%7D">. Calculate the average speed of the car.</p>
<ul>
<li><p>The arithmetic mean of the speed <img src="https://latex.codecogs.com/png.latex?=%20%5Cdisplaystyle%20%5Cfrac%7B60%20+%2070%20+%2090%20+100%7D%7B4%7D%20=%20%5Cfrac%7B320%7D%7B4%7D%20=%2080"> km/h.</p></li>
<li><p>However, this method ignores the time taken to travel each distance.</p></li>
<li><p>The time taken to travel each distance is given in the following table:</p></li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Speed (km/h)</th>
<th style="text-align: center;">Distanc (km)</th>
<th style="text-align: center;">Time (h) [Distance/Speed]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?60"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?100"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?1.666667"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?70"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?100"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?1.428571"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?90"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?100"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?1.111111"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?100"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?100"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?1"></td>
</tr>
</tbody>
</table>
<ul>
<li><p>The total distance traveled is <img src="https://latex.codecogs.com/png.latex?400"> km, and the total time taken is <img src="https://latex.codecogs.com/png.latex?5.21%5C%20%5Ctext%7Bh%7D"> So, the actual average speed <img src="https://latex.codecogs.com/png.latex?=%20%5Cdisplaystyle%20%5Cfrac%7B400%7D%7B5.206349%7D%20%5Capprox%2076.83%5C%20%5Ctext%7Bkm/h%7D">.</p></li>
<li><p>This average can be found using the harmonic mean of the speeds:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb83" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1">speeds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb83-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Hmean</span>(speeds)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.82927</code></pre>
</div>
</div></li>
<li><p>The average speed can also be calculated as the weighted arithmetic mean using weights based on the time taken to travel each distance:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb85" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1">times <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use times as weights</span></span>
<span id="cb85-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weighted.mean</span>(speeds, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> times)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.82927</code></pre>
</div>
</div></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>To find the average of rates with different numerators but the same denominator use the arithmetic mean or weighted harmonic mean (weights are based on numerators).</p></li>
<li><p>To find the average of rates with same numerators but different denominators use the harmonic mean or weighted arithmetic mean (weights are based on denominators).</p></li>
<li><p>To find the average of rates with different numerators and denominators use the weighted arithmetic mean (weights are based on denominators) or weighted harmonic mean (weights are based on numerators).</p></li>
</ul>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" aria-labelledby="tabset-4-2-tab">
<p>Suppose that you invested <img src="https://latex.codecogs.com/png.latex?%5Ctextdollar%7B2550%7D"> in stock market. In the first year, you spent <img src="https://latex.codecogs.com/png.latex?%5Ctextdollar%7B1000%7D"> to purchase <img src="https://latex.codecogs.com/png.latex?40"> shares of stock <img src="https://latex.codecogs.com/png.latex?A">. In the second year, you spent <img src="https://latex.codecogs.com/png.latex?%5Ctextdollar%7B1550%7D"> to purchase <img src="https://latex.codecogs.com/png.latex?78"> shares of the same stock. Calculate the average price per share.</p>
<ul>
<li><p>The rate here is the price <img src="https://latex.codecogs.com/png.latex?(%5Ctextdollar)"> per share.</p></li>
<li><p>The total amount of the shares bought <img src="https://latex.codecogs.com/png.latex?=%2040%20+%2078%20=%20118"> shares, so the actual average price per share <img src="https://latex.codecogs.com/png.latex?=%20%5Cdisplaystyle%20%5Cfrac%7B2550%7D%7B118%7D%20%5Capprox%20%5Ctextdollar%7B21.61%7D">.</p></li>
<li><p>In the first year, the price per share <img src="https://latex.codecogs.com/png.latex?=%20%5Cdisplaystyle%20%5Cfrac%7B1000%7D%7B40%7D%20=%20%5Ctextdollar%7B25%7D">.</p></li>
<li><p>In the second year, the price per share <img src="https://latex.codecogs.com/png.latex?=%20%5Cdisplaystyle%20%5Cfrac%7B1550%7D%7B78%7D%20%5Capprox%20%5Ctextdollar%7B19.87%7D">.</p></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Year</th>
<th style="text-align: center;">Price per share <img src="https://latex.codecogs.com/png.latex?(%5Ctextdollar/%5Ctext%7Bshare%7D)"></th>
<th style="text-align: center;">Amount invested <img src="https://latex.codecogs.com/png.latex?(%5Ctextdollar)"></th>
<th style="text-align: center;">Number of shares</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?1"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?25.00"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?1000"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?40"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?2"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?19.87"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?1550"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?78"></td>
</tr>
</tbody>
</table>
<ul>
<li><p>The arithmetic mean of the price per share <img src="https://latex.codecogs.com/png.latex?=%20%5Cdisplaystyle%20%5Cfrac%7B25%20+%2019.87%7D%7B2%7D%20=%20%5Cdisplaystyle%20%5Cfrac%7B44.87%7D%7B2%7D%20=%20%5Ctextdollar%7B22.44%7D">, which is higher than the actual average price per share.</p></li>
<li><p>Because both the numerator (amount invested) and denominator (number of shares) are different, the weighted arithmetic or weighted harmonic mean should be used to calculate the average price per share:</p>
<ul>
<li><p>The weighted arithmetic mean using denominator (number of shares) as weights:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb87" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1">weights_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">118</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">78</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">118</span>)</span>
<span id="cb87-2">price_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span></span>
<span id="cb87-3">price_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1550</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">78</span></span>
<span id="cb87-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weighted.mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(price_1, price_2), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> weights_1)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.61017</code></pre>
</div>
</div></li>
<li><p>The weighted harmonic mean using numerators (amount invested) as weights:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb89" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1">weights_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2550</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1550</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2550</span>)</span>
<span id="cb89-2">h_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weights_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(price_1, price_2))</span>
<span id="cb89-3">h_mean</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.61017</code></pre>
</div>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="trimmed-mean" class="level3" data-number="2.8">
<h3 data-number="2.8" class="anchored" data-anchor-id="trimmed-mean"><span class="header-section-number">2.8</span> Trimmed mean</h3>
<ul>
<li><p>The observations are arranged based on magnitude, then a certain percentage of the observations are removed from both ends of the ordered observations.</p></li>
<li><p>The trimmed mean <img src="https://latex.codecogs.com/png.latex?(%5Cbar%7Bx%7D_T)"> is then calculated as the arithmetic mean of the remaining observations.</p></li>
<li><p>Typically, <img src="https://latex.codecogs.com/png.latex?5%5C%25"> to <img src="https://latex.codecogs.com/png.latex?25%5C%25"> of the observations are trimmed from each end.</p></li>
<li><p>The trimmed mean is less sensitive to outliers than the arithmetic mean becuase the extreme values are removed.</p></li>
<li><p>Some robust statistical tests use the trimmed mean such as <strong>Yuen’s test</strong>, which is used to compare the trimmed means of two groups when the assumption of normality is violated.</p></li>
<li><p>Trimmed mean can be calculated in R using the <code>mean()</code> function with the <code>trim</code> argument set to the percentage of observations to be trimmed.</p>
<ul>
<li><p>Example: the <img src="https://latex.codecogs.com/png.latex?5%5C%25"> trimmed mean of the variable <code>mpg</code> in the <code>mtcars</code> dataset is calculated as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb91" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trim =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.95333</code></pre>
</div>
</div>
<ul>
<li><p><code>DescTools</code> package has a function <code>Trim()</code> that is an excerpt from the base function <code>mean()</code> but returns the trimmed data without calculating the mean:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb93" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DescTools)</span>
<span id="cb93-2">mpg_ordered <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span>
<span id="cb93-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Trim</span>(mpg_ordered, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 10.4 13.3 14.3 14.7 15.0 15.2 15.2 15.5 15.8 16.4 17.3 17.8 18.1 18.7 19.2
[16] 19.2 19.7 21.0 21.0 21.4 21.4 21.5 22.8 22.8 24.4 26.0 27.3 30.4 30.4 32.4
attr(,"trim")
[1]  1 32</code></pre>
</div>
</div>
<ul>
<li><p>The output shows the cleaned data after trimming <img src="https://latex.codecogs.com/png.latex?5%5C%25"> of the observations from each end and the location of the trimmed observations (the <img src="https://latex.codecogs.com/png.latex?1%5E%7B%5Ctext%7Bst%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?32%5E%7B%5Ctext%7Bnd%7D%7D"> observations that were removed).</p></li>
<li><p>The percentage of trimming is multiplied by the number of observations to get the number of observations to be trimmed from each end (i.e., <img src="https://latex.codecogs.com/png.latex?0.05%20%5Ctimes%2032%20=%201.6"> observations, which R rounds down to <img src="https://latex.codecogs.com/png.latex?1">).</p></li>
<li><p>Therefore, one observation has been removed from each end.</p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p><img src="https://latex.codecogs.com/png.latex?50%5C%25"> trimming is equivalent to the median:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb95" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trim =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.2</code></pre>
</div>
</div></li>
<li><p>Discarding the extreme values leads to loss of information that can introduce bias in the estimation of the mean. Therefore, trimming should be used cautiously. It can be safely used to discard extreme values (outliers) that might be due to errors during measurement or data collection or when the extreme values are irrelevant to the rest of the data.</p></li>
</ul>
</section>
<section id="winsorized-mean" class="level3" data-number="2.9">
<h3 data-number="2.9" class="anchored" data-anchor-id="winsorized-mean"><span class="header-section-number">2.9</span> Winsorized mean</h3>
<ul>
<li><p>The observations are arranged based on magnitude, then the extreme values beyond a certain percentile threshold are replaced by these threshold values.</p></li>
<li><p>For example, <img src="https://latex.codecogs.com/png.latex?5%5C%25"> Winsorization involves replacing the values smaller than the <img src="https://latex.codecogs.com/png.latex?5%5E%7Bth%7D"> percentile with the <img src="https://latex.codecogs.com/png.latex?5%5E%7Bth%7D"> percentile value and the values larger than the <img src="https://latex.codecogs.com/png.latex?95%5E%7Bth%7D"> percentile with the <img src="https://latex.codecogs.com/png.latex?95%5E%7Bth%7D"> percentile value.</p></li>
<li><p>The Winsorized mean <img src="https://latex.codecogs.com/png.latex?(%5Cbar%7Bx%7D_W)"> is then calculated as the arithmetic mean of the modified observations.</p></li>
<li><p>The Winsorized mean is less sensitive to outliers than the arithmetic mean.</p></li>
<li><p>To Winsorize data, the <code>Winsorize()</code> function from the <code>DescTools</code> package can be used:</p>
<ul>
<li><p>The function has <code>probs</code> argument that takes a vector of two values representing the lower and upper percentiles to be Winsorized (e.g., <code>probs = c(0.05, 0.95)</code> for <img src="https://latex.codecogs.com/png.latex?5%5C%25"> Winsorization).</p></li>
<li><p>In addition, there is <code>type</code> argument that specifies the algorithm to be used for calculating the perecentiles (discussed in details <a href="../../posts/biostats/B04_quantile_algorithms_stats.html">here</a>).</p></li>
<li><p>Example: the variable <code>mpg</code> in the <code>mtcars</code> dataset is <img src="https://latex.codecogs.com/png.latex?5%5C%25"> Winsorized as follows:</p>
<ul>
<li><p>Calculate the <img src="https://latex.codecogs.com/png.latex?5%5E%7Bth%7D"> and <img src="https://latex.codecogs.com/png.latex?95%5E%7Bth%7D"> percentiles of the variable <code>mpg</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb97" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(</span>
<span id="cb97-2">mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg, </span>
<span id="cb97-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>),</span>
<span id="cb97-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb97-5">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    5%    95% 
11.995 31.300 </code></pre>
</div>
</div></li>
<li><p>The <code>quantile()</code> function has been used to calculate the <img src="https://latex.codecogs.com/png.latex?5%5E%7Bth%7D"> and <img src="https://latex.codecogs.com/png.latex?95%5E%7Bth%7D"> percentiles of the variable <code>mpg</code>, which are <img src="https://latex.codecogs.com/png.latex?11.995"> and <img src="https://latex.codecogs.com/png.latex?31.3">, respectively. The <code>type</code> argument is set to <img src="https://latex.codecogs.com/png.latex?7">, which is the default algorithm for calculating the percentiles in R for continuous data.</p></li>
<li><p>Display the original values in order:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb99" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1">mpg_ordered</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 10.4 10.4 13.3 14.3 14.7 15.0 15.2 15.2 15.5 15.8 16.4 17.3 17.8 18.1 18.7
[16] 19.2 19.2 19.7 21.0 21.0 21.4 21.4 21.5 22.8 22.8 24.4 26.0 27.3 30.4 30.4
[31] 32.4 33.9</code></pre>
</div>
</div></li>
<li><p>Winsorize the variable <code>mpg</code> using the <img src="https://latex.codecogs.com/png.latex?5%5E%7Bth%7D"> and <img src="https://latex.codecogs.com/png.latex?95%5E%7Bth%7D"> percentiles:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb101" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DescTools)</span>
<span id="cb101-2">mpg_win <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Winsorize</span>(</span>
<span id="cb101-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mpg_ordered, </span>
<span id="cb101-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">val =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(</span>
<span id="cb101-5">      mpg_ordered,</span>
<span id="cb101-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>)</span>
<span id="cb101-7">  )</span>
<span id="cb101-8">)</span>
<span id="cb101-9"></span>
<span id="cb101-10">mpg_win</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 11.995 11.995 13.300 14.300 14.700 15.000 15.200 15.200 15.500 15.800
[11] 16.400 17.300 17.800 18.100 18.700 19.200 19.200 19.700 21.000 21.000
[21] 21.400 21.400 21.500 22.800 22.800 24.400 26.000 27.300 30.400 30.400
[31] 31.300 31.300</code></pre>
</div>
</div></li>
<li><p>The output of the <code>Winsorize()</code> function shows that the two smallest values <img src="https://latex.codecogs.com/png.latex?(10.4%5C%20%5Ctext%7Band%7D%5C%2010.4)"> that are smaller than the <img src="https://latex.codecogs.com/png.latex?5%5E%7Bth%7D"> percentile <img src="https://latex.codecogs.com/png.latex?(11.995)"> have been replaced by the <img src="https://latex.codecogs.com/png.latex?5%5E%7Bth%7D"> percentile. Whereas, the two largest values <img src="https://latex.codecogs.com/png.latex?32.4%5C%20%5Ctext%7Band%7D%5C%2033.9"> that are larger than the <img src="https://latex.codecogs.com/png.latex?95%5E%7Bth%7D"> percentile <img src="https://latex.codecogs.com/png.latex?(31.3)"> have been replaced by the <img src="https://latex.codecogs.com/png.latex?95%5E%7Bth%7D"> percentile.</p></li>
<li><p>Calculate the Winsorized mean of the variable <code>mpg</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb103" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(mpg_win)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.07469</code></pre>
</div>
</div></li>
<li><p>The Winsorized mean can be calculated directly using the function <code>winsor.mean()</code> function from the <code>psych</code> package:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb105" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(psych)</span>
<span id="cb105-2"></span>
<span id="cb105-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">winsor.mean</span>(</span>
<span id="cb105-4">mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg, </span>
<span id="cb105-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trim =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span></span>
<span id="cb105-6">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.07469</code></pre>
</div>
</div></li>
</ul></li>
</ul></li>
<li><p>Unlike trimming, Winsorization preserves some of the original information in the data. The extreme values are not totally discarded but their weight (impact) is reduced.</p></li>
</ul>
</section>
</section>
<section id="references" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="references"><span class="header-section-number">3</span> References</h2>
<ul>
<li><p>Daniel, W. W. and Cross, C. L. (2013). Biostatistics: A Foundation for Analysis in the Health Sciences, Tenth edition. Wiley</p></li>
<li><p>Heumann, C., Schomaker, M., and Shalabh (2022). Introduction to Statistics and Data Analysis: With Exercises, Solutions and Applications in R. Springer</p></li>
<li><p>Hoffman, J. (2019). Basic Biostatistics for Medical and Biomedical Practitioners, Second Edition. Academic Press</p></li>
<li><p>Lane, D. M. et al., (2019). Introduction to Statistics. Online Edition. Retrieved September 14, 2024, from https://openstax.org/details/introduction-statistics</p></li>
</ul>
<p><br></p>
</section>
<section id="add-your-comments" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="add-your-comments"><span class="header-section-number">4</span> Add your comments</h2>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <guid>https://www.amrbiostats.com/posts/biostats/B03_cent_tendency_stats.html</guid>
  <pubDate>Mon, 07 Oct 2024 20:00:00 GMT</pubDate>
  <media:content url="https://www.amrbiostats.com/images/biostats.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Frequency distribution 2</title>
  <link>https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats.html</link>
  <description><![CDATA[ 




<section id="frequency-distribution-of-quantitative-variables" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="frequency-distribution-of-quantitative-variables"><span class="header-section-number">1</span> Frequency distribution of quantitative variables</h2>
<ul>
<li><p>Quantitative variables have many unique values, which can lead to an extremely large number of categories.</p></li>
<li><p>Therefore, these variables can be summarized by grouping the data into class intervals and counting the number of observations in each class interval.</p></li>
<li><p>The class intervals are selected to be contiguous, non-overlapping, and exhaustive in a way that each observation can be assigned to one and only one class interval.</p></li>
<li><p>Constructing few class intervals may result in loss of information, while constructing too many class intervals may not satisfy the purpose of summarizing the data.</p></li>
<li><p>A rule of thumb is to have between 5 and 15 class intervals.</p></li>
<li><p>There are different methods used as a guide to determine the number of class intervals, such as Sturges’ rule, square root method, Freedman-Diaconis’ rule, etc. For instance:</p>
<ul>
<li><strong>Sturges’ rule</strong>: <img src="https://latex.codecogs.com/png.latex?k%20=%201%20+%203.322%20%5Clog_%7B10%7D(n)">, where <img src="https://latex.codecogs.com/png.latex?k"> is the number of class intervals and <img src="https://latex.codecogs.com/png.latex?n"> is the number of observations.</li>
</ul></li>
<li><p>Example: Consider the variable <code>mpg</code> (miles per gallon) in the <code>mtcars</code> dataset:</p>
<ul>
<li><p>First, let’s load the dataset and have a look at the variable:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load the mtcars dataset</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(mtcars)</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display the values of the mpg variable</span></span>
<span id="cb1-5">mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 15.2 10.4
[16] 10.4 14.7 32.4 30.4 33.9 21.5 15.5 15.2 13.3 19.2 27.3 26.0 30.4 15.8 19.7
[31] 15.0 21.4</code></pre>
</div>
</div></li>
<li><p>The number of class intervals based on Sturges’ rule can be calculated by either of the following methods:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">Stepwise calculation</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">Direct calculation</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># determine the number of observations</span></span>
<span id="cb3-2">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># calculate the number of class intervals using Sturges' rule   </span></span>
<span id="cb3-5">k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.322</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(n)</span>
<span id="cb3-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'The number of class intervals = '</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(k))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The number of class intervals = 6"</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use nclass.Sturges() function </span></span>
<span id="cb5-2">k1  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nclass.Sturges</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'The number of class intervals = '</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(k1))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The number of class intervals = 6"</code></pre>
</div>
</div>
</div>
</div>
</div></li>
<li><p>The number of class intervals is <img src="https://latex.codecogs.com/png.latex?6"> as suggested by Sturges’ rule.</p>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>These rules including Sturges’ rule are not strict but rather provide guidance to determine the number of class intervals.</p></li>
<li><p>The actual number of class intervals can vary based on the researcher’s judgment and the purpose of the analysis.</p></li>
</ul>
</div>
</div></li>
<li><p>Then, let’s calculate the range, which is the difference between the maximum and minimum values of the variable:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># determine the minimum value of the mpg variable</span></span>
<span id="cb7-2">min_mpg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># determine the maximum value of the mpg variable</span></span>
<span id="cb7-5">max_mpg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># calculate the range of the mpg variable by subtracting the minimum from the maximum</span></span>
<span id="cb7-8">r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> max_mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> min_mpg</span>
<span id="cb7-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Range = '</span>, r)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Range = 23.5"</code></pre>
</div>
</div></li>
<li><p>R has a built-in function <code>range()</code> that returns the maximum and minimum values directly:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.4 33.9</code></pre>
</div>
</div></li>
<li><p>The width of each class interval is approximately equal to <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cfrac%20%7B%5Ctext%7BRange%7D%7D%7Bk%7D%20=%20%5Cfrac%7B23.5%7D%7B6%7D%20=%203.9%20%5Capprox%204">.</p></li>
<li><p>As a rule of thumb, when appropriate, the width of the class interval is recommended to be of of 5 units, 10 units, or multiples of 10.</p></li>
<li><p>The first class interval should encompass the minimum (in this example <img src="https://latex.codecogs.com/png.latex?=%2010.4">), while the last class interval should encompass the maximum (in this example <img src="https://latex.codecogs.com/png.latex?=%2033.9">).</p></li>
<li><p>A good starting point would be <img src="https://latex.codecogs.com/png.latex?10"> and considering a width of <img src="https://latex.codecogs.com/png.latex?5"> units, the boundaries of the class intervals would be <img src="https://latex.codecogs.com/png.latex?10,%2015,%2020,%2025,%2030,%20%5Ctext%20%7Band%7D%5C%2035">.</p></li>
<li><p>Because each value should be assigned to one and only one class interval, the class intervals should be closed on one end and open on the other end, e.g., <img src="https://latex.codecogs.com/png.latex?%5B10,%2015%5D,%20(15,%2020%5D,%20(20,%2025%5D,%20(25,%2030%5D,%20(30,%2035%5D">.</p>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>The square bracket [ ] denotes that the interval includes the corresponding lower or upper bound, while the parenthesis ( ) denotes that the interval excludes the corresponding lower or upper bound.</p></li>
<li><p>For instance, the second class interval <img src="https://latex.codecogs.com/png.latex?(15,%2020%5D"> includes values greater than but not equal to <img src="https://latex.codecogs.com/png.latex?15"> and less than or equal to <img src="https://latex.codecogs.com/png.latex?20"> (i.e., <img src="https://latex.codecogs.com/png.latex?15%20%3C%20x%20%5Cleq%2020">).</p></li>
<li><p>This type is called exclusive-inclusive (also known as half-open, half-closed) interval.</p></li>
<li><p>The first class interval should have a closed lower bound to include the minimum value, if coincidentally the minimum value is equal to the lower bound of the first class interval.</p></li>
</ul>
</div>
</div></li>
<li><p>The class interval boundaries (i.e., breakpoints) can also be determined directly using the <code>pretty()</code> function in R:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">bp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pretty</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg)</span>
<span id="cb11-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb11-3">   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'The class interval breakpoints = '</span>, </span>
<span id="cb11-4">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(bp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>)</span>
<span id="cb11-5">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The class interval breakpoints = 10, 15, 20, 25, 30, 35"</code></pre>
</div>
</div></li>
<li><p>We can use R to create a frequency distribution table for the <code>mpg</code> variable as follows:</p></li>
</ul></li>
</ul>
<div class="grid">
<div class="g-col-2">

</div>
<div class="g-col-8">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DT)</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a vector to assign each value to a class interval</span></span>
<span id="cb13-4">mpg_class <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb13-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(</span>
<span id="cb13-6">    mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg,</span>
<span id="cb13-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb13-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include.lowest =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb13-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb13-10">  )</span>
<span id="cb13-11"></span>
<span id="cb13-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># include.lowest = TRUE ensures that the minimum value is included in the first class interval or the maximum value is included in the last class interval if right argument is set to FALSE.</span></span>
<span id="cb13-13"></span>
<span id="cb13-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># right = TRUE ensures that the intervals are left-open and right-closed.</span></span>
<span id="cb13-15"></span>
<span id="cb13-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a frequency distribution table for the mpg variable</span></span>
<span id="cb13-17">freq_tbl_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(mpg_class)</span>
<span id="cb13-18"></span>
<span id="cb13-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a data frame from the frequency table</span></span>
<span id="cb13-20">freq_tbl_df_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(freq_tbl_1)</span>
<span id="cb13-21"></span>
<span id="cb13-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># convert the mpg_class column to character</span></span>
<span id="cb13-23">freq_tbl_df_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg_class <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(freq_tbl_df_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg_class)</span>
<span id="cb13-24"></span>
<span id="cb13-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add a row for the total frequency</span></span>
<span id="cb13-26">freq_tbl_df_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb13-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(</span>
<span id="cb13-28">    freq_tbl_df_1, </span>
<span id="cb13-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total"</span>, </span>
<span id="cb13-30">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(freq_tbl_df_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Freq)</span>
<span id="cb13-31">     )</span>
<span id="cb13-32">  )</span>
<span id="cb13-33"></span>
<span id="cb13-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display the frequency distribution table (optional)</span></span>
<span id="cb13-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">datatable</span>(</span>
<span id="cb13-36">  freq_tbl_df_1,</span>
<span id="cb13-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colnames =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb13-38">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Class Interval"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mpg_class"</span>,</span>
<span id="cb13-39">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Freq"</span></span>
<span id="cb13-40">  ),</span>
<span id="cb13-41">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb13-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>,</span>
<span id="cb13-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columnDefs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb13-44">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb13-45">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">className =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dt-center"</span>,</span>
<span id="cb13-46">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">targets =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_all"</span></span>
<span id="cb13-47">      )</span>
<span id="cb13-48">    )</span>
<span id="cb13-49">  ),</span>
<span id="cb13-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb13-51">)</span></code></pre></div>
</details>
<div id="tbl-mpg-freq" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mpg-freq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Frequency distribution of the mpg variable
</figcaption>
<div aria-describedby="tbl-mpg-freq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-bb54db0d860dbfb85ee2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bb54db0d860dbfb85ee2">{"x":{"filter":"none","vertical":false,"data":[["[10,15]","(15,20]","(20,25]","(25,30]","(30,35]","Total"],["6","12","8","2","4","32"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Class Interval<\/th>\n      <th>Frequency<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-center","targets":"_all"},{"name":"mpg_class","targets":0},{"name":"Freq","targets":1}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</figure>
</div>
</div>
</div>
<div class="g-col-2">

</div>
</div>
<section id="relative-and-cumulative-frequencies" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="relative-and-cumulative-frequencies"><span class="header-section-number">1.1</span> Relative and cumulative frequencies</h3>
<ul>
<li><p><strong>Relative frequency of a class interval</strong>:</p>
<ul>
<li><p>It is the proportion of observations that fall within that class interval relative to the total number of observations.</p></li>
<li><p>It is simply calculated by dividing the frequency of that class interval by the total number of observations.</p></li>
</ul></li>
<li><p><strong>Cumulative frequency</strong>:</p>
<ul>
<li><p>As the name implies, it is the frequency of values falling within two or more class intervals.</p></li>
<li><p>At each class interval, we calculate the sum of the frequency of that class interval and all previous class intervals.</p></li>
</ul></li>
<li><p><strong>Cumulative relative frequency</strong>:</p>
<ul>
<li>It is calculated by dividing the cumulative frequency by the total number of observations.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The relative frequency, cumulative frequency, and cumulative relative frequency are calculated for categorical variables in the same way as for numerical variables.</li>
</ul>
</div>
</div>
<ul>
<li><p>The relative frequency, cumulative frequency, and cumulative relative frequency of the <code>mpg</code> variable can be calculated as follows:</p>
<ul>
<li><p>The relative frequencies:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># calculate the relative frequency</span></span>
<span id="cb14-2">rel_freq_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prop.table</span>(freq_tbl_1)</span>
<span id="cb14-3">rel_freq_1</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>mpg_class
[10,15] (15,20] (20,25] (25,30] (30,35] 
 0.1875  0.3750  0.2500  0.0625  0.1250 </code></pre>
</div>
</div></li>
<li><p>The cumulative frequencies:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># calculate the cumulative frequency</span></span>
<span id="cb16-2">cum_freq_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(freq_tbl_1)</span>
<span id="cb16-3">cum_freq_1</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[10,15] (15,20] (20,25] (25,30] (30,35] 
      6      18      26      28      32 </code></pre>
</div>
</div></li>
<li><p>The cumulative relative frequencies:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># calculate the cumulative relative frequency</span></span>
<span id="cb18-2">cum_rel_freq_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(rel_freq_1)</span>
<span id="cb18-3">cum_rel_freq_1</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[10,15] (15,20] (20,25] (25,30] (30,35] 
 0.1875  0.5625  0.8125  0.8750  1.0000 </code></pre>
</div>
</div></li>
<li><p>The frequency distribution table with relative and cumulative frequencies can be displayed collectively as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a data frame from the cumulative frequency table</span></span>
<span id="cb20-2">cum_freq_df_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb20-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb20-4">    freq_tbl_1, </span>
<span id="cb20-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cum_freq_1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(cum_freq_1),</span>
<span id="cb20-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rel_freq_1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(rel_freq_1),</span>
<span id="cb20-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cum_rel_freq_1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(cum_rel_freq_1)</span>
<span id="cb20-8">  )</span>
<span id="cb20-9"></span>
<span id="cb20-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># convert the mpg_class column to character</span></span>
<span id="cb20-11">cum_freq_df_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg_class <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(cum_freq_df_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg_class)</span>
<span id="cb20-12"></span>
<span id="cb20-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add a row for the total frequency</span></span>
<span id="cb20-14">cum_freq_df_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb20-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(</span>
<span id="cb20-16">       cum_freq_df_1,</span>
<span id="cb20-17">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb20-18">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total"</span>,</span>
<span id="cb20-19">         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(cum_freq_df_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Freq),</span>
<span id="cb20-20">         <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb20-21">         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(cum_freq_df_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rel_freq),</span>
<span id="cb20-22">         <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb20-23">       )</span>
<span id="cb20-24">    )  </span>
<span id="cb20-25"></span>
<span id="cb20-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display the cumulative frequency distribution table</span></span>
<span id="cb20-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">datatable</span>(</span>
<span id="cb20-28">    cum_freq_df_1,</span>
<span id="cb20-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colnames =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb20-30">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Class Interval"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mpg_class"</span>, </span>
<span id="cb20-31">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Freq"</span>,</span>
<span id="cb20-32">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cumulative Frequency"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cum_freq_1"</span>,</span>
<span id="cb20-33">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Relative Frequency"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rel_freq_1"</span>,</span>
<span id="cb20-34">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cumulative Relative Frequency"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cum_rel_freq_1"</span></span>
<span id="cb20-35">    ),</span>
<span id="cb20-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb20-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>, </span>
<span id="cb20-38">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columnDefs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb20-39">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb20-40">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">className =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dt-center"</span>, </span>
<span id="cb20-41">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">targets =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_all"</span>          </span>
<span id="cb20-42">        )</span>
<span id="cb20-43">      )</span>
<span id="cb20-44">    ),</span>
<span id="cb20-45">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb20-46">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb20-47"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">formatRound</span>(</span>
<span id="cb20-48">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), </span>
<span id="cb20-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb20-50">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">formatStyle</span>(</span>
<span id="cb20-52">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb20-53">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">backgroundColor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">styleRow</span>(</span>
<span id="cb20-54">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb20-55">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgreen"</span></span>
<span id="cb20-56">  ) </span>
<span id="cb20-57">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-58"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">formatStyle</span>(</span>
<span id="cb20-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb20-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">backgroundColor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">styleEqual</span>(</span>
<span id="cb20-61">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb20-62">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>)</span>
<span id="cb20-63">  )</span>
<span id="cb20-64">)</span></code></pre></div>
</details>
<div id="tbl-mpg-cum-freq" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mpg-cum-freq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Cumulative frequency distribution of the mpg variable
</figcaption>
<div aria-describedby="tbl-mpg-cum-freq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-ad6f29f51743f226c795" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ad6f29f51743f226c795">{"x":{"filter":"none","vertical":false,"data":[["[10,15]","(15,20]","(20,25]","(25,30]","(30,35]","Total"],["6","12","8","2","4","32"],["6","18","26","28","32",null],["0.1875","0.375","0.25","0.0625","0.125","1"],["0.1875","0.5625","0.8125","0.875","1",null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Class Interval<\/th>\n      <th>Frequency<\/th>\n      <th>Cumulative Frequency<\/th>\n      <th>Relative Frequency<\/th>\n      <th>Cumulative Relative Frequency<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 5, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 5, 3, \",\", \".\", null);\n  }"},{"className":"dt-center","targets":"_all"},{"name":"mpg_class","targets":0},{"name":"Freq","targets":1},{"name":"cum_freq_1","targets":2},{"name":"rel_freq_1","targets":3},{"name":"cum_rel_freq_1","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[0]; $(this.api().cell(row, 0).node()).css({'background-color':$.inArray(dataIndex + 1, [3]) >= 0 ? \"lightgreen\" : null});\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'background-color':$.inArray(dataIndex + 1, [3]) >= 0 ? \"lightgreen\" : null});\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'background-color':$.inArray(dataIndex + 1, [3]) >= 0 ? \"lightgreen\" : null});\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'background-color':$.inArray(dataIndex + 1, [3]) >= 0 ? \"lightgreen\" : null});\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background-color':$.inArray(dataIndex + 1, [3]) >= 0 ? \"lightgreen\" : null});\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'background-color':value == 1 ? \"skyblue\" : null});\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background-color':value == 1 ? \"skyblue\" : null});\n}"}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.rowCallback"],"jsHooks":[]}</script>
</div>
</div>
</figure>
</div>
</div></li>
</ul></li>
<li><p>As you can see from Table&nbsp;2:</p>
<ul>
<li><p>The relative frequency of the class interval <img src="https://latex.codecogs.com/png.latex?(20,%2025%5D%20=%20%5Cdisplaystyle%20%5Cfrac%7B8%7D%7B32%7D%20=%200.25">.</p></li>
<li><p>The cumulative frequency at the class interval <img src="https://latex.codecogs.com/png.latex?(20,%2025%5D%20=%206%20+%2012%20+%208%20=%2026">, which represents the number of observations that fall within the wider class interval <img src="https://latex.codecogs.com/png.latex?%5B10,%2025%5D"> that incorporates the class intervals <img src="https://latex.codecogs.com/png.latex?%5B10,%2015%5D">, <img src="https://latex.codecogs.com/png.latex?(15,%2020%5D">, and <img src="https://latex.codecogs.com/png.latex?(20,%2025%5D">.</p></li>
<li><p>The cumulative relative frequency at the class interval <img src="https://latex.codecogs.com/png.latex?(20,%2025%5D%20=%20%5Cdisplaystyle%20%5Cfrac%7B6%7D%7B32%7D%20+%20%5Cfrac%7B12%7D%7B32%7D%20+%20%5Cfrac%7B8%7D%7B32%7D%20=%20%5Cfrac%7B26%7D%7B32%7D%20=%200.8125">.</p></li>
<li><p>Notice:</p>
<ul>
<li><p>The relative frequencies should sum up to <img src="https://latex.codecogs.com/png.latex?1">.</p></li>
<li><p>The cumulative relative frequency at the last class interval should be <img src="https://latex.codecogs.com/png.latex?1">.</p></li>
</ul></li>
</ul></li>
<li><p>The above frequency distribution table can constructed directly using <code>freq()</code> function from the <code>summarytools</code> package as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(summarytools)</span>
<span id="cb21-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DT)</span>
<span id="cb21-3"></span>
<span id="cb21-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">datatable</span>(</span>
<span id="cb21-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">freq</span>(</span>
<span id="cb21-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(</span>
<span id="cb21-7">      mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg, </span>
<span id="cb21-8">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pretty</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg), </span>
<span id="cb21-9">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include.lowest =</span> T, </span>
<span id="cb21-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right =</span> T</span>
<span id="cb21-11">    )</span>
<span id="cb21-12">  ),   </span>
<span id="cb21-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb21-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>,</span>
<span id="cb21-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columnDefs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb21-16">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb21-17">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">className =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dt-center"</span>, </span>
<span id="cb21-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">targets =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_all"</span></span>
<span id="cb21-19">      )</span>
<span id="cb21-20">    )</span>
<span id="cb21-21"> )</span>
<span id="cb21-22">   )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-df4fcd1e2953bdba211e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-df4fcd1e2953bdba211e">{"x":{"filter":"none","vertical":false,"data":[["[10,15]","(15,20]","(20,25]","(25,30]","(30,35]","&lt;NA&gt;","Total"],[6,12,8,2,4,0,32],[18.75,37.5,25,6.25,12.5,null,100],[18.75,56.25,81.25,87.5,100,null,100],[18.75,37.5,25,6.25,12.5,0,100],[18.75,56.25,81.25,87.5,100,100,100]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Freq<\/th>\n      <th>% Valid<\/th>\n      <th>% Valid Cum.<\/th>\n      <th>% Total<\/th>\n      <th>% Total Cum.<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-center","targets":"_all"},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Freq","targets":1},{"name":"% Valid","targets":2},{"name":"% Valid Cum.","targets":3},{"name":"% Total","targets":4},{"name":"% Total Cum.","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div></li>
</ul>
</section>
<section id="graphical-representation" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="graphical-representation"><span class="header-section-number">1.2</span> Graphical representation</h3>
<section id="stem-and-leaf-plot" class="level4" data-number="1.2.1">
<h4 data-number="1.2.1" class="anchored" data-anchor-id="stem-and-leaf-plot"><span class="header-section-number">1.2.1</span> Stem and leaf plot</h4>
<ul>
<li><p>It is a graphical way to display the distribution of quantitative variables.</p></li>
<li><p>It can be used when the number of observations is not too large.</p></li>
<li><p>It is similar to the histogram (will be discussed shortly) but retains the original data values.</p></li>
<li><p>The stem-and-leaf plot is constructed by dividing each observation into two parts, the stem and the leaf separated by a vertical line <img src="https://latex.codecogs.com/png.latex?(%7C)">.</p></li>
<li><p>Stem:</p>
<ul>
<li><p>The stem is the leftmost digit(s) of the observation.</p></li>
<li><p>Form a column to the left of the vertical line arranged in ascending order from top to bottom.</p></li>
</ul></li>
<li><p>Leaf:</p>
<ul>
<li><p>The leaf is the rightmost digit(s) of the observation.</p></li>
<li><p>They are ordered and placed to the right of the vertical line with the corresponding stem.</p></li>
</ul></li>
<li><p>Even though R has a bulit in function to create stem-and-leaf plots, the <code>stem.leaf()</code> function from the <code>aplpack</code> package provides more informative output and is more flexible with regard to customization:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(aplpack)</span>
<span id="cb22-2"></span>
<span id="cb22-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stem.leaf</span>(</span>
<span id="cb22-4">mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg,</span>
<span id="cb22-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bare"</span>, </span>
<span id="cb22-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of parts (rows) to which the stem is divided</span></span>
<span id="cb22-7">)</span></code></pre></div>
</details>
</div></li>
</ul>
<p><img src="https://www.amrbiostats.com/images/stem_leaf.png" class="img-fluid"></p>
<ul>
<li><p>The above output can be interpreted as follows:</p>
<p><i class="bi bi-1-circle-fill" style="color: #4479fb; font-size: 22px;"></i> This header indicates that stem should be interpreted as tens (or hundreds, etc), whereas leaf should be interpreted as ones not as tenth decimal place (i.e., interpret <img src="https://latex.codecogs.com/png.latex?1%5C%20%7C%5C%202"> as <img src="https://latex.codecogs.com/png.latex?12"> not <img src="https://latex.codecogs.com/png.latex?1.2">). This can be controlled using the argument <code>unit</code>, which accepts numbers as power of 10 (e.g., 2, 1, 0.1, 0.01, etc).</p>
<p><i class="bi bi-2-circle-fill" style="color: #4479fb; font-size: 22px;"></i> This shows that the leaf unit is 1 (i.e., the leaf represents the ones place).</p>
<p><i class="bi bi-3-circle-fill" style="color: #4479fb; font-size: 22px;"></i> This shows the ntotal number of observations.</p>
<p><i class="bi bi-4-circle-fill" style="color: #4479fb; font-size: 22px;"></i> This column shows the stem values (i.e., the tens place); Each stem is separated into two parts (rows), the first contains leaves from 0 to 4, and the second contains leaves from 5 to 9.</p>
<p><i class="bi bi-5-circle-fill" style="color: #4479fb; font-size: 22px;"></i> This shows the leaves (i.e., the ones place) corresponding to the stem values.</p>
<p><i class="bi bi-6-circle-fill" style="color: #4479fb; font-size: 22px;"></i> This column is referred to as the <code>depths</code>, which shows the accumulated frequencies from the top and bottom of the plot until reaching the row that contains the middle value (i.e., the median). So, the last <img src="https://latex.codecogs.com/png.latex?(5%5E%7B%5Ctext%7Bth%7D%7D)"> row has depth of <img src="https://latex.codecogs.com/png.latex?4"> because there are <img src="https://latex.codecogs.com/png.latex?4"> observations (leaves) with stem value <img src="https://latex.codecogs.com/png.latex?3">. The second row from the bottom <img src="https://latex.codecogs.com/png.latex?(4%5E%7B%5Ctext%7Bth%7D%7D)"> has a depth of <img src="https://latex.codecogs.com/png.latex?6"> because there are <img src="https://latex.codecogs.com/png.latex?4"> leaves in the <img src="https://latex.codecogs.com/png.latex?5%5E%7B%5Ctext%7Bth%7D%7D"> row and <img src="https://latex.codecogs.com/png.latex?2"> leaves in the <img src="https://latex.codecogs.com/png.latex?4%5E%7B%5Ctext%7Bth%7D%7D"> row.</p>
<p><i class="bi bi-7-circle-fill" style="color: #4479fb; font-size: 22px;"></i> This shows the row containing the middle value (i.e., the median). The frequency of leaves in this row is placed in parentheses to indicate that the median is in this row. For example, the median of the <code>mpg</code> variable is <img src="https://latex.codecogs.com/png.latex?19.2">, which is in the <img src="https://latex.codecogs.com/png.latex?2%5E%7B%5Ctext%7Bnd%7D%7D"> row that contains <img src="https://latex.codecogs.com/png.latex?13"> leaves.</p>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>In the above example, the decimals have been omitted from the leaves because the <code>unit</code> argument is set to 1 (i.e., the leaves represent the ones place).</p></li>
<li><p>Sometimes, a plus <img src="https://latex.codecogs.com/png.latex?(+)"> is added at the end of one or more rows to indicate that the leaves exceed the row capacity, and thus, the leaves are not shown in the plot.</p></li>
</ul>
</div>
</div></li>
</ul>
</section>
<section id="histogram" class="level4" data-number="1.2.2">
<h4 data-number="1.2.2" class="anchored" data-anchor-id="histogram"><span class="header-section-number">1.2.2</span> Histogram</h4>
<ul>
<li><p>It is used to graphically represent the distribution of values of quantitative variables, particularly when there are a large number of observations.</p></li>
<li><p>It can be used to get insights about the underlying shape of the distribution that generated the data based on the sample.</p></li>
<li><p>The class intervals are represented on the horizontal axis, whereas the vertical axis represents the frequency of the values or the relative frequency <code>density</code> scale.</p></li>
<li><p>Each class interval on the horizontal axis has a rectangular vertical bar.</p></li>
<li><p>If the vertical axis scale is the <code>frequency</code>, the height <img src="https://latex.codecogs.com/png.latex?(h_i)"> of the bar corresponds to the frequency <img src="https://latex.codecogs.com/png.latex?(n_i)"> of that class interval (i.e., <img src="https://latex.codecogs.com/png.latex?h_i%20=%20n_i">).</p></li>
<li><p>If the vertical axis scale is the <code>density</code>, the height of the bar corresponds to relative frequency <img src="https://latex.codecogs.com/png.latex?%5Cleft%20(%20f_i%20=%20%5Cdisplaystyle%20%5Cfrac%7Bn_i%7D%7B%5Csum%20n_i%7D%20%5Cright)"> of that class interval divided by the width <img src="https://latex.codecogs.com/png.latex?(d_i)"> of the class interval (i.e., <img src="https://latex.codecogs.com/png.latex?h_i%20=%20%5Cdisplaystyle%20%5Cfrac%7Bf_i%7D%7Bd_i%7D">):</p>
<ul>
<li><p>Therefore, the area of each bar <img src="https://latex.codecogs.com/png.latex?=%20%5Ctext%20%7Bheight%7D%20%5Ctimes%20%5Ctext%20%7Bwidth%7D%20=%20%5Cdisplaystyle%20%5Cfrac%7Bf_i%7D%7B%5Ccancel%7Bd_i%7D%7D%20%5Ctimes%20%5Ccancel%7Bd%7D_i%20=%20f_i"> (i.e., the relative frequency).</p></li>
<li><p>In this context, the bars can have different widths because the area of each bar is proportional to the relative frequency (however, usually the bars have equal width).</p></li>
</ul></li>
<li><p>The bars are contiguous, non-overlapping, and possess no gaps.</p></li>
<li><p>The histogram of the <code>mpg</code> variable can be created as follows:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true">Base R</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" aria-controls="tabset-2-2" aria-selected="false">Using <code>ggplot2</code></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># adjust the plot layout to display two plots side by side</span></span>
<span id="cb23-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb23-3"></span>
<span id="cb23-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a histogram based on frequency</span></span>
<span id="cb23-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(</span>
<span id="cb23-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg,</span>
<span id="cb23-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histogram based </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> on frequency"</span>,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># \n is used to create a new line</span></span>
<span id="cb23-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles per Gallon (MPG)"</span>,</span>
<span id="cb23-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span>,</span>
<span id="cb23-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>,</span>
<span id="cb23-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">border =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb23-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb23-13">)</span>
<span id="cb23-14"></span>
<span id="cb23-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The breaks were determined automatically but it can be changed using the breaks  argument</span></span>
<span id="cb23-16"></span>
<span id="cb23-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># hist() uses left-open and right-closed intervals by default.</span></span>
<span id="cb23-18"></span>
<span id="cb23-19"></span>
<span id="cb23-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a histogram based on relative frequency</span></span>
<span id="cb23-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(</span>
<span id="cb23-22"> mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg,</span>
<span id="cb23-23"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this is equivalent to freq = FALSE</span></span>
<span id="cb23-24"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histogram based on </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> relative frequency"</span>,</span>
<span id="cb23-25"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles per Gallon (MPG)"</span>,</span>
<span id="cb23-26"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>,</span>
<span id="cb23-27"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>,</span>
<span id="cb23-28"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">border =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb23-29"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>),</span>
<span id="cb23-30">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb24-2"></span>
<span id="cb24-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a histogram based on frequency</span></span>
<span id="cb24-4"></span>
<span id="cb24-5">h1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb24-6"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb24-7">   mtcars, </span>
<span id="cb24-8">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mpg)</span>
<span id="cb24-9"> ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># aes() needs x argument only</span></span>
<span id="cb24-10"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(</span>
<span id="cb24-11">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>,</span>
<span id="cb24-12">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span></span>
<span id="cb24-13"> ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-14"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb24-15">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histogram based on frequency (bins = 30)"</span>,</span>
<span id="cb24-16">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles per Gallon (MPG)"</span>,</span>
<span id="cb24-17">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span></span>
<span id="cb24-18"> ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-19"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span>
<span id="cb24-20"></span>
<span id="cb24-21"> h1</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>The histogram is different from the base R histogram because <code>ggplot()</code> uses 30 bins (bars) by default, which might not be appropriate all the time.</p></li>
<li><p>This can be changed by modifying the <code>bins</code> argument in <code>geom_histogram()</code>.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">h2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb25-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(mtcars, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mpg)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb25-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(</span>
<span id="cb25-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>,</span>
<span id="cb25-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb25-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb25-7">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb25-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histogram based on frequency (bins = 5)"</span>,</span>
<span id="cb25-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles per Gallon (MPG)"</span>,</span>
<span id="cb25-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span></span>
<span id="cb25-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span>
<span id="cb25-14"></span>
<span id="cb25-15"> h2</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Now, we have 5 bins like the histogram created by base R, however, the ticks on the <img src="https://latex.codecogs.com/png.latex?x-">axis and bin width are different.</p></li>
<li><p>We can check the breaks created by <code>ggplot()</code> using the following code:</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot_build</span>(h2)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>xmin</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  8.8125 14.6875 20.5625 26.4375 32.3125</code></pre>
</div>
</div>
<ul>
<li>To get the same breaks as in the base R histogram, we can adjust the arguments <code>binwidth</code>, <code>boundary</code>, and <code>closed</code> in the <code>geom_histogram()</code> as follows</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">h3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb28-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(mtcars, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mpg)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb28-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(</span>
<span id="cb28-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>,</span>
<span id="cb28-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, </span>
<span id="cb28-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, </span>
<span id="cb28-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">boundary =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb28-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">closed =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span></span>
<span id="cb28-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb28-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histogram based on frequency (adjusted boundaries)"</span>,</span>
<span id="cb28-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles per Gallon (MPG)"</span>,</span>
<span id="cb28-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span></span>
<span id="cb28-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb28-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb28-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb28-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb28-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() </span>
<span id="cb28-21">h3</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The histogram based on relative frequency can be created as follows:</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># histogram based on relative frequency using after_stat(density) as argument insides aes() </span></span>
<span id="cb29-2">h4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb29-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(mtcars, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mpg, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">after_stat</span>(density))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb29-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(</span>
<span id="cb29-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>,</span>
<span id="cb29-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, </span>
<span id="cb29-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, </span>
<span id="cb29-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">boundary =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb29-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">closed =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, </span>
<span id="cb29-10">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb29-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histogram based on relative frequency"</span>,</span>
<span id="cb29-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles per Gallon (MPG)"</span>,</span>
<span id="cb29-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Desnsity"</span></span>
<span id="cb29-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb29-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>),</span>
<span id="cb29-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb29-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() </span>
<span id="cb29-21">h4</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div></li>
</ul>
</section>
<section id="frequency-polygon" class="level4" data-number="1.2.3">
<h4 data-number="1.2.3" class="anchored" data-anchor-id="frequency-polygon"><span class="header-section-number">1.2.3</span> Frequency polygon</h4>
<ul>
<li><p>It is a special type of line graph used to graphically represent the frequency distribution.</p></li>
<li><p>As we did in histograms, the class intervals are represented on the horizontal axis, whereas the vertical axis represents the frequency.</p></li>
<li><p>The midpoint of each class interval is marked and a point is plotted at the height corresponding to the frequency of that class interval.</p></li>
<li><p>The points are connected by straight lines to form a polygon.</p></li>
<li><p>To ensure the polygon touches the horizontal axis, include one class interval below the lowest value in the data and one above the highest value.</p></li>
<li><p>The frequency polygon for the <code>mpg</code> variable can be created in R as follows:</p>
<ul>
<li><p>Calculate midpoints of the class intervals:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DT)</span>
<span id="cb30-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a vector to assign each value to a class interval</span></span>
<span id="cb30-3">mpg_class <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb30-4"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(</span>
<span id="cb30-5"> mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg,</span>
<span id="cb30-6"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb30-7"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include.lowest =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb30-8"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb30-9"> )</span>
<span id="cb30-10"></span>
<span id="cb30-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a frequency distribution table for the mpg variable</span></span>
<span id="cb30-12">freq_tbl_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(mpg_class)</span>
<span id="cb30-13"></span>
<span id="cb30-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a data frame from the frequency table</span></span>
<span id="cb30-15">freq_tbl_df_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(freq_tbl_1)</span>
<span id="cb30-16"></span>
<span id="cb30-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># convert the mpg_class column to character</span></span>
<span id="cb30-18">freq_tbl_df_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg_class <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(freq_tbl_df_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg_class)</span>
<span id="cb30-19"></span>
<span id="cb30-20"></span>
<span id="cb30-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add a column for the midpoints of the class intervals</span></span>
<span id="cb30-22">mids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb30-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(</span>
<span id="cb30-24"> mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg,</span>
<span id="cb30-25"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb30-26"> )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mids  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># extract midoiunts from the histogram</span></span>
<span id="cb30-27"></span>
<span id="cb30-28">freq_tbl_df_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>midpoints <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mids  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add the midpoints to the dataframe</span></span>
<span id="cb30-29"></span>
<span id="cb30-30"></span>
<span id="cb30-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display the frequency distribution table (optional)</span></span>
<span id="cb30-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">datatable</span>(</span>
<span id="cb30-33"> freq_tbl_df_1,</span>
<span id="cb30-34"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colnames =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb30-35">   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Class Interval"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mpg_class"</span>,</span>
<span id="cb30-36">   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Freq"</span>,</span>
<span id="cb30-37">   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Midpoints"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"midpoints"</span></span>
<span id="cb30-38"> ),</span>
<span id="cb30-39"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb30-40">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>,</span>
<span id="cb30-41">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columnDefs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb30-42">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb30-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">className =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dt-center"</span>,</span>
<span id="cb30-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">targets =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_all"</span></span>
<span id="cb30-45">    )</span>
<span id="cb30-46">  )</span>
<span id="cb30-47">),</span>
<span id="cb30-48"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb30-49">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-7524aedf358985874082" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7524aedf358985874082">{"x":{"filter":"none","vertical":false,"data":[["[10,15]","(15,20]","(20,25]","(25,30]","(30,35]"],[6,12,8,2,4],[12.5,17.5,22.5,27.5,32.5]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Class Interval<\/th>\n      <th>Frequency<\/th>\n      <th>Midpoints<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-center","targets":"_all"},{"name":"mpg_class","targets":0},{"name":"Freq","targets":1},{"name":"midpoints","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div></li>
<li><div style="margin-top: 1rem; margin-bottom: 1rem">
<p>Add a class interval below the lowest value in the data and one above the highest value:</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">   freq_tbl_df_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(</span>
<span id="cb31-2">     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[5, 10)"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.5</span>),</span>
<span id="cb31-3">     freq_tbl_df_1,</span>
<span id="cb31-4">     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(35, 40]"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.5</span>)</span>
<span id="cb31-5">   )</span>
<span id="cb31-6"></span>
<span id="cb31-7">   freq_tbl_df_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>midpoints <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(freq_tbl_df_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>midpoints)</span>
<span id="cb31-8"></span>
<span id="cb31-9">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display the frequency distribution table (optional)</span></span>
<span id="cb31-10">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">datatable</span>(</span>
<span id="cb31-11"> freq_tbl_df_1,</span>
<span id="cb31-12"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colnames =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb31-13">   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Class Interval"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mpg_class"</span>,</span>
<span id="cb31-14">   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Freq"</span>,</span>
<span id="cb31-15">   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Midpoints"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"midpoints"</span></span>
<span id="cb31-16"> ),</span>
<span id="cb31-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb31-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>,</span>
<span id="cb31-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columnDefs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb31-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb31-21">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">className =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dt-center"</span>,</span>
<span id="cb31-22">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">targets =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_all"</span></span>
<span id="cb31-23">    )</span>
<span id="cb31-24">  )</span>
<span id="cb31-25">),</span>
<span id="cb31-26"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb31-27">      )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-d4685a902af1958cb26d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d4685a902af1958cb26d">{"x":{"filter":"none","vertical":false,"data":[["[5, 10)","[10,15]","(15,20]","(20,25]","(25,30]","(30,35]","(35, 40]"],["0","6","12","8","2","4","0"],[7.5,12.5,17.5,22.5,27.5,32.5,37.5]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Class Interval<\/th>\n      <th>Frequency<\/th>\n      <th>Midpoints<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-center","targets":"_all"},{"name":"mpg_class","targets":0},{"name":"Freq","targets":1},{"name":"midpoints","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div></li>
<li><div style="margin-top: 1rem; margin-bottom: 1rem">
<p>Create a frequency polygon using the midpoints and frequencies:</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" aria-controls="tabset-3-1" aria-selected="true">Base R</a></li><li class="nav-item"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" aria-controls="tabset-3-2" aria-selected="false"><code>ggplot2</code></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(</span>
<span id="cb32-2">   mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg,</span>
<span id="cb32-3">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>),</span>
<span id="cb32-4">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles per Gallon (MPG)"</span>,</span>
<span id="cb32-5">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span>,</span>
<span id="cb32-6">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histogram plus Frequency Polygon"</span></span>
<span id="cb32-7">)</span>
<span id="cb32-8"></span>
<span id="cb32-9"></span>
<span id="cb32-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(</span>
<span id="cb32-11">   freq_tbl_df_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>midpoints,</span>
<span id="cb32-12">   freq_tbl_df_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Freq,</span>
<span id="cb32-13">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"o"</span>,</span>
<span id="cb32-14">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>,</span>
<span id="cb32-15">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0466c8"</span></span>
<span id="cb32-16">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb33-2">gg_freq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb33-3">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb33-4">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars,</span>
<span id="cb33-5">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mpg)</span>
<span id="cb33-6">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb33-7"></span>
<span id="cb33-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(</span>
<span id="cb33-9">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb33-10">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">boundary =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb33-11">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">closed =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>,</span>
<span id="cb33-12">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgrey"</span>,</span>
<span id="cb33-13">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span></span>
<span id="cb33-14">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb33-15"></span>
<span id="cb33-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_freqpoly</span>(</span>
<span id="cb33-17">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb33-18">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">boundary =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb33-19">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">closed =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>,</span>
<span id="cb33-20">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0466c8"</span></span>
<span id="cb33-21">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb33-22"></span>
<span id="cb33-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb33-24">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>),</span>
<span id="cb33-25">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb33-26">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb33-27"></span>
<span id="cb33-28"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb33-29">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Histogram plus Frequency Polygon"</span>,</span>
<span id="cb33-30">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles per Gallon (MPG)"</span>,</span>
<span id="cb33-31">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span></span>
<span id="cb33-32">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb33-33"></span>
<span id="cb33-34"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span>
<span id="cb33-35"></span>
<span id="cb33-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># extract midpoints from the ggplot histogram object</span></span>
<span id="cb33-37">my_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb33-38">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midpoints =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot_build</span>(gg_freq)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x,</span>
<span id="cb33-39">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Freq =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot_build</span>(gg_freq)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y</span>
<span id="cb33-40">)</span>
<span id="cb33-41"></span>
<span id="cb33-42"></span>
<span id="cb33-43">gg_freq <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb33-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb33-45">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> my_data,</span>
<span id="cb33-46">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> midpoints, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Freq),</span>
<span id="cb33-47">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0466c8"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb33-48">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div></li>
</ul></li>
<li><p>If the <img src="https://latex.codecogs.com/png.latex?y-">axis represents the cumulative frequency, the frequency polygon is referred to as cumulative frequency polygon or <code>ogive</code>.</p></li>
<li><p>The cumulative frequency polygon for the <code>mpg</code> variable is represented in the following figure:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ul>
</section>
<section id="kernel-density-plot" class="level4" data-number="1.2.4">
<h4 data-number="1.2.4" class="anchored" data-anchor-id="kernel-density-plot"><span class="header-section-number">1.2.4</span> Kernel density plot</h4>
<ul>
<li><p>The histogram has a disadvantage in that the shape of the distribution is influenced by the choice of the number of class intervals (i.e., bins). Different bin sizes can give a different impression of the underlying distribution.</p></li>
<li><p>This problem can be addressed by using the kernel density plot, which is a smoothed version of the histogram and less sensitive to the choice of the number of bins:</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Using the kernel density plot, the shape of the distribution is represented by a continuous function (i.e., curve) estimated from the sample data.</p></li>
<li><p>Like histograms, the density plots give insights about the underlying shape of the distribution that generated the data based on the sample.</p></li>
<li><p>In simple words, the kernel density estimation (KDE) is based on the idea that the more data points are clustered together, the higher is the probability density in that region (i.e., the higher is the probability of an observation falling in that region):</p>
<ul>
<li><p>KDE places a small kernel (bump) centered at each data point.</p></li>
<li><p>The density of the bump is highest at the data points and decreases by moving away from the data points.</p></li>
<li><p>The small kernels (bumps) are summed to estimate the overall density at each point.</p></li>
</ul></li>
<li><p>Consider the following set of data: <img src="https://latex.codecogs.com/png.latex?5,%206,%207,%208,%2011,%2012">, the density plot can be represented as follows:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>In the above density plot:</p>
<ul>
<li><p>The dashed blue lines represent the small bumps (kernel functions) centered at each data point.</p></li>
<li><p>The solid red line represents the overall kernel density estimate.</p></li>
<li><p>The green tickmarks at the bottom of the plot represent the data points.</p></li>
</ul></li>
<li><p>The small bumps are summed to estimate the overall density.</p></li>
<li><p>The overall desnsity is highest between 5 and 8 because more data points are clustered in that region.</p></li>
</ul></li>
<li><p>The kernel function used for the estimation is given by:</p></li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cdisplaystyle%20%5Chat%20f_n(x)%20=%20%5Cfrac%7B1%7D%7Bnh%7D%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20K%20%5Cleft(%20%5Cfrac%7Bx%20-%20x_i%7D%7Bh%7D%20%5Cright)%0A"></p>
<div style="margin-left: 50px; color: #0466c8;">
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Chat%20f_n(x)"> is the kernel density estimate at <img src="https://latex.codecogs.com/png.latex?x"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?n"> is the number of observations</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?h"> is the bandwidth, <img src="https://latex.codecogs.com/png.latex?h%20%3E%200"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20K%20%5Cleft(%20%5Cfrac%7Bx%20-%20x_i%7D%7Bh%7D%20%5Cright)"> is the kernel function <img src="https://latex.codecogs.com/png.latex?%5Clarge%20(">mentioned below as <img src="https://latex.codecogs.com/png.latex?K(u)">, where <img src="https://latex.codecogs.com/png.latex?u%20=%20%5Cdisplaystyle%20%5Cfrac%7Bx%20-%20x_i%7D%7Bh%7D%20%5Clarge%20)"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?x_i"> is the <img src="https://latex.codecogs.com/png.latex?i%5E%7B%5Ctext%7Bth%7D%7D"> observation of the data</p></li>
</ul>
</div>
<ul>
<li><p>There are different kernel functions, such as the Gaussian kernel, Epanechnikov kernel, rectangular kernel, etc:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Kernel Function</th>
<th style="text-align: center;">Formula</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Gaussian (default in R)</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%0AK(u)%20=%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%7D%7D%20e%5E%7B-%5Clarge%20%5Cfrac%7Bu%5E2%7D%7B2%7D%7D%0A"></td>
</tr>
<tr class="even">
<td>Epanechnikov</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%0A%20%20%20%20K(u)%20=%0A%20%20%20%20%5Cbegin%7Bcases%7D%0A%20%20%20%20%5Cdisplaystyle%20%5Cfrac%7B3%7D%7B4%7D(1%20-%20u%5E2)%20&amp;%20%20%5Cquad%20%5Ctext%7Bif%7D%5C%20%7Cu%7C%20%5Clt%201%20%5C%5C%20%5C%5C%0A%20%20%20%200%20&amp;%20%5Cquad%20%5Ctext%7Botherwise%7D%0A%20%20%20%20%5Cend%7Bcases%7D%0A"></td>
</tr>
<tr class="odd">
<td>Rectangular</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%0A%20%20%20%20K(u)%20=%0A%20%20%20%20%5Cbegin%7Bcases%7D%0A%20%20%20%20%5Cdisplaystyle%20%5Cfrac%7B1%7D%7B2%7D%20&amp;%20%20%5Cquad%20%5Ctext%7Bif%7D%5C%20-1%20%5Cle%20u%20%5Cle%201%20%5C%5C%20%5C%5C%0A%20%20%20%200%20&amp;%20%5Cquad%20%5Ctext%7Botherwise%7D%0A%20%20%20%20%5Cend%7Bcases%7D%0A"></td>
</tr>
</tbody>
</table></li>
<li><p>Characteristics of the kernel function:</p>
<ul>
<li><p>The kernel function is symmetric around zero.</p></li>
<li><p>The kernel function integrates to one (this makes the kernel density estimator a probability density function, a concept tha will be discussed in upcoming tutorials).</p></li>
</ul></li>
<li><p>The kernel density plot for the <code>mpg</code> variable can be created in R as follows :</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" aria-controls="tabset-4-1" aria-selected="true">Base R</a></li><li class="nav-item"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" aria-controls="tabset-4-2" aria-selected="false">Using <code>ggplot2</code></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a kernel density plot using the default Gaussian kernel</span></span>
<span id="cb34-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb34-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">density</span>(</span>
<span id="cb34-4">    mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg</span>
<span id="cb34-5">  ),</span>
<span id="cb34-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Kernel density plot"</span>,</span>
<span id="cb34-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles per Gallon (MPG)"</span>,</span>
<span id="cb34-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>,</span>
<span id="cb34-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0466c8"</span>,</span>
<span id="cb34-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb34-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>)</span>
<span id="cb34-12">)</span>
<span id="cb34-13"></span>
<span id="cb34-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add a kernel density plot using the Epanechnikov kernel </span></span>
<span id="cb34-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(</span>
<span id="cb34-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">density</span>(</span>
<span id="cb34-17">    mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg,</span>
<span id="cb34-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kernel =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"epanechnikov"</span>,</span>
<span id="cb34-19">  ),</span>
<span id="cb34-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>,</span>
<span id="cb34-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, </span>
<span id="cb34-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb34-23">)</span>
<span id="cb34-24"></span>
<span id="cb34-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add a legend</span></span>
<span id="cb34-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">legend</span>(</span>
<span id="cb34-27">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topleft"</span>,</span>
<span id="cb34-28">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gaussian"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Epanechnikov"</span>),</span>
<span id="cb34-29">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0466c8"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>),</span>
<span id="cb34-30">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>),</span>
<span id="cb34-31">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)</span>
<span id="cb34-32">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb35-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a kernel density plot using the default Gaussian kernel</span></span>
<span id="cb35-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb35-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars, </span>
<span id="cb35-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mpg)</span>
<span id="cb35-6">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggplot() accepts only a data frame</span></span>
<span id="cb35-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_density</span>(</span>
<span id="cb35-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gaussian"</span>),  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Label used in the legend </span></span>
<span id="cb35-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kernel =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gaussian"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># default kernel</span></span>
<span id="cb35-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"line"</span>,</span>
<span id="cb35-11">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb35-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_density</span>(</span>
<span id="cb35-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Epanechnikov"</span>),  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Label used in the legend</span></span>
<span id="cb35-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kernel =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"epanechnikov"</span>,</span>
<span id="cb35-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>,</span>
<span id="cb35-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"line"</span>,</span>
<span id="cb35-17">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb35-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb35-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Kernel density plot"</span>,</span>
<span id="cb35-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles per Gallon (MPG)"</span>,</span>
<span id="cb35-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>, </span>
<span id="cb35-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Kernel"</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># title of legend</span></span>
<span id="cb35-23">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb35-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(</span>
<span id="cb35-25">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb35-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gaussian"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0466c8"</span>, </span>
<span id="cb35-27">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Epanechnikov"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ba181b"</span></span>
<span id="cb35-28">  ) </span>
<span id="cb35-29">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb35-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlim</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb35-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div></li>
<li><p>The shape of kernel density plot is affected by the choice of the <img src="https://latex.codecogs.com/png.latex?h"> <code>(bandwidth)</code> parameter, which controls the smoothness of the curve:</p>
<ul>
<li><p>When <img src="https://latex.codecogs.com/png.latex?h"> is too small, the curve becomes wiggly (i.e., undersmoothed) because the bandwidth is too narrow to smooth out random fluctuations in the data (i.e., the density estimate captures noise rather than the true underlying distribution).</p></li>
<li><p>When <img src="https://latex.codecogs.com/png.latex?h"> is too large, the curve becomes oversmoothed because the wide bandwidth smooths out (i.e., combines) more bumps leading to a density estimate that fails to capture the true underlying distribution.</p></li>
<li><p>The bandwidth can be controlled using the <code>bw</code> argument in both <code>density()</code> and <code>stat_density()</code> functions.</p></li>
<li><p>This can be illustrated by the following figure:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot density with default bandwidth </span></span>
<span id="cb36-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb36-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">density</span>(</span>
<span id="cb36-4">  mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg</span>
<span id="cb36-5">  ),</span>
<span id="cb36-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Kernel density plot with different bandwidths"</span>,</span>
<span id="cb36-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles per Gallon (MPG)"</span>,</span>
<span id="cb36-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>,</span>
<span id="cb36-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0466c8"</span>,</span>
<span id="cb36-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb36-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb36-12">)</span>
<span id="cb36-13"></span>
<span id="cb36-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add a kernel density plot with a smaller bandwidth</span></span>
<span id="cb36-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(</span>
<span id="cb36-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">density</span>(</span>
<span id="cb36-17">  mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg,</span>
<span id="cb36-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bw =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb36-19">  ),</span>
<span id="cb36-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>,</span>
<span id="cb36-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb36-22">)</span>
<span id="cb36-23"></span>
<span id="cb36-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add a kernel density plot with a larger bandwidth</span></span>
<span id="cb36-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(</span>
<span id="cb36-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">density</span>(</span>
<span id="cb36-27">  mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg,</span>
<span id="cb36-28">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bw =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb36-29">  ),</span>
<span id="cb36-30">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#38b000"</span>,</span>
<span id="cb36-31">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb36-32">)</span>
<span id="cb36-33"></span>
<span id="cb36-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add a legend</span></span>
<span id="cb36-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">legend</span>(</span>
<span id="cb36-36">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topleft"</span>,</span>
<span id="cb36-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"h=default"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"h=0.5"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"h=3"</span>),</span>
<span id="cb36-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0466c8"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#38b000"</span>),</span>
<span id="cb36-39">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb36-40">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>R uses its own algorithm to estimate the density, the following is quoted from the <code>density()</code> function documentation:</p>
<ul>
<li><p>“The algorithm used in density.default disperses the mass of the empirical distribution function over a regular grid of at least 512 points and then uses the fast Fourier transform to convolve this approximation with a discretized version of the kernel and then uses linear approximation to evaluate the density at the specified points.”</p></li>
<li><p>By default, R calculates the bandwidth using Silverman’s rule of thumb:</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20h%20=%200.9%20%5Ctimes%20%5Ctext%7Bmin%7D%20%5Cleft(%20%5Chat%20%5Csigma,%20%5Cfrac%7B%5Ctext%7BIQR%7D%7D%7B1.34%7D%20%5Cright)%20%5Ctimes%20n%5E%7B-%5Clarge%20%5Cfrac%7B1%7D%7B5%7D%7D"></p></li>
<li><p>where <img src="https://latex.codecogs.com/png.latex?%5Chat%20%5Csigma"> is the standard deviation estimated from the sample, <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BIQR%7D"> is the interquartile range, and <img src="https://latex.codecogs.com/png.latex?n"> is the number of observations.</p></li>
<li><p>The bandwidth <code>(bw)</code> is then multiplied by <code>adjust</code> (default is 1) to get the final bandwidth.</p></li>
<li><p>Therefore, modifying the <code>adjust</code> argument can change the bandwidth, e.g., if <code>adjust</code> is set to 0.5, the bandwidth is halved.</p></li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="violin-plot" class="level4" data-number="1.2.5">
<h4 data-number="1.2.5" class="anchored" data-anchor-id="violin-plot"><span class="header-section-number">1.2.5</span> Violin plot</h4>
<ul>
<li><p>A violin plot is another type of graphical representation that is used to display the distribution of quantitative variables.</p></li>
<li><p>It is a density plot that is flipped and mirrored on both sides of the vertical axis resulting in a shape that resembles a violin.</p></li>
<li><p>The width of the violin at each point represents the density at that point.</p></li>
<li><p>Violin plots can created using the <code>vioplot()</code> function from the <code>vioplot</code> package, the <code>ggviolin()</code> function from the <code>ggpubr</code> package, or the <code>geom_violin()</code> function from the <code>ggplot2</code> package as follows:</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" aria-controls="tabset-5-1" aria-selected="true">Base R</a></li><li class="nav-item"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" aria-controls="tabset-5-2" aria-selected="false">Using ggpubr</a></li><li class="nav-item"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" aria-controls="tabset-5-3" aria-selected="false">ggplo2</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(vioplot)</span>
<span id="cb37-2"></span>
<span id="cb37-3"></span>
<span id="cb37-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vioplot</span>(</span>
<span id="cb37-5">  mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg,</span>
<span id="cb37-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">drawRect =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># do not draw boxplot</span></span>
<span id="cb37-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rgb</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">212</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">73</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">76</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>),</span>
<span id="cb37-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Violin plot using vioplot()"</span>,</span>
<span id="cb37-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb37-10">  )</span>
<span id="cb37-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles per Gallon (MPG)"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>The above violin plot displays the distribution of the <code>mpg</code> variable.</p></li>
<li><p>The density plot is flipped and mirrored on both sides of the vertical axis.</p></li>
</ul>
</div>
<div id="tabset-5-2" class="tab-pane" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggpubr)</span>
<span id="cb38-2"></span>
<span id="cb38-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggviolin</span>(</span>
<span id="cb38-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars,</span>
<span id="cb38-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mpg"</span>,</span>
<span id="cb38-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>,</span>
<span id="cb38-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb38-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>,</span>
<span id="cb38-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles per Gallon (MPG)"</span>,</span>
<span id="cb38-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Violin plot using ggviolin()"</span>,</span>
<span id="cb38-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ggtheme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span>
<span id="cb38-12">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb38-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_discrete</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># removes the label of the variable </span></span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb39-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars,</span>
<span id="cb39-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> mpg)</span>
<span id="cb39-4">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_violin</span>(</span>
<span id="cb39-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#e63946"</span>,</span>
<span id="cb39-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span></span>
<span id="cb39-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb39-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb39-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles per Gallon (MPG)"</span></span>
<span id="cb39-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Violin plot using geom_violin()"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="the-shape-of-the-distribution" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="the-shape-of-the-distribution"><span class="header-section-number">1.3</span> The shape of the distribution</h3>
<ul>
<li><p>Histograms, density plots, and violin plots can be used to reveal the distribution of the data.</p></li>
<li><p>The shape of the distribution can be symmetric, skewed to the right, or skewed to the left:</p>
<ul>
<li><p>Symmetric distribution has a mirror image on both sides of the center.</p></li>
<li><p>Right-skewed (positively-skewed) distribution has a long tail to the right (caused by a few large values).</p></li>
<li><p>Left-skewed (negatively-skewed) distribution has a long tail to the left (caused by a few small values).</p></li>
</ul></li>
<li><p>Example of symmetric, right-skewed, and left-skewed distributions are displayed below:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>The following is another example of how violin plots can give insights about the shape of the distribution:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simulate a symmetric distribution</span></span>
<span id="cb40-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb40-3">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb40-4"></span>
<span id="cb40-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simulate a right-skewed distribution</span></span>
<span id="cb40-6">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rgamma</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rate =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb40-7"></span>
<span id="cb40-8">my_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb40-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Symmetric"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Skewed"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)),</span>
<span id="cb40-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(x, y)</span>
<span id="cb40-11">)</span>
<span id="cb40-12"></span>
<span id="cb40-13"></span>
<span id="cb40-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(vioplot)</span>
<span id="cb40-15"></span>
<span id="cb40-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vioplot</span>(</span>
<span id="cb40-17">  value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> group,</span>
<span id="cb40-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> my_data, </span>
<span id="cb40-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">drawRect =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># do not draw boxplot</span></span>
<span id="cb40-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rgb</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">212</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">73</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">76</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span>
<span id="cb40-21">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>As depicted in the above figure:</p>
<ul>
<li><p>The right violin plot shows symmetric density plot at the center <img src="https://latex.codecogs.com/png.latex?(2)">.</p></li>
<li><p>On the other hand, the left violin plot shows a long tail to the right, indicating a right-skewed distribution.</p></li>
</ul></li>
</ul></li>
<li><p>There are other types of graphical representations that can be used to display the distribution of data, such as boxplots (discussed <a href="../../posts/biostats/B05_boxplot_stats.html">here</a>) and quantile-quantile plots, which will be discussed in upcoming tutorials.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" aria-controls="tabset-6-1" aria-selected="true"><span style="color: #ba181b">Exercise B.2.1 <iconify-icon inline="" icon="fluent:chat-bubbles-question-20-filled" style="font-size: 21px;" aria-label="Icon chat-bubbles-question-20-filled from fluent Iconify.design set." title="Icon chat-bubbles-question-20-filled from fluent Iconify.design set."></iconify-icon></span></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" aria-labelledby="tabset-6-1-tab">
<ul>
<li><p>Install and load the package <code>boot</code>.</p></li>
<li><p>Make a histogram and a stem-and-leaf plot for the <code>thickness</code> variable from the <code>melanoma</code> dataset.</p></li>
</ul>
<div class="webex-check webex-box">
<p>A. What is the shape of the distribution <select class="webex-select"><option value="blank"></option><option value="">symmetric</option><option value="answer">right-skewed</option><option value="">left-skewe</option></select></p>
B. Using the stem-and-leaf plot, which of the following intervals contains the median of the thickness variable?
<div id="radio_SVJPEDRAPQ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_SVJPEDRAPQ" value=""> <span>0.5 – 1.0</span></label><label><input type="radio" autocomplete="off" name="radio_SVJPEDRAPQ" value=""> <span>1.0 – 1.5</span></label><label><input type="radio" autocomplete="off" name="radio_SVJPEDRAPQ" value="answer"> <span>1.5 – 2.0</span></label><label><input type="radio" autocomplete="off" name="radio_SVJPEDRAPQ" value=""> <span>2.0 – 2.5</span></label><label><input type="radio" autocomplete="off" name="radio_SVJPEDRAPQ" value=""> <span>2.5 – 3.0</span></label>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="references" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="references"><span class="header-section-number">2</span> References</h2>
<ul>
<li><p>Chen, Y. (2017). Lecture 7: Density Estimation. University of Washington. Retrieved October 05, 2024, from https://faculty.washington.edu/yenchic/17Sp_403/Lec7-density.pdf</p></li>
<li><p>Daniel, W. W. and Cross, C. L. (2013). Biostatistics: A Foundation for Analysis in the Health Sciences, Tenth edition. Wiley</p></li>
<li><p>Heumann, C., Schomaker, M., and Shalabh (2022). Introduction to Statistics and Data Analysis: With Exercises, Solutions and Applications in R. Springer</p></li>
<li><p>Lane, D. M. et al., (2019). Introduction to Statistics. Online Edition. Retrieved September 14, 2024, from https://openstax.org/details/introduction-statistics</p></li>
</ul>
<p><br></p>
</section>
<section id="add-your-comments" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="add-your-comments"><span class="header-section-number">3</span> Add your comments</h2>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <guid>https://www.amrbiostats.com/posts/biostats/B02_Freq_dist2_stats.html</guid>
  <pubDate>Fri, 04 Oct 2024 20:00:00 GMT</pubDate>
  <media:content url="https://www.amrbiostats.com/images/biostats.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Frequency distribution 1</title>
  <link>https://www.amrbiostats.com/posts/biostats/B01_Freq_dist1_stats.html</link>
  <description><![CDATA[ 




<section id="definitions" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="definitions"><span class="header-section-number">1</span> Definitions</h2>
<section id="raw-data" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="raw-data"><span class="header-section-number">1.1</span> Raw data</h3>
<ul>
<li>It is defined as the original set of measurements or observations collected from a study or an experiment without being organized, summarized, or manipulated.</li>
</ul>
</section>
<section id="ordered-aray" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="ordered-aray"><span class="header-section-number">1.2</span> Ordered aray</h3>
<ul>
<li><p>It is a set of data arranged in ascending or descending order.</p></li>
<li><p>For example, consider the following set of raw data (5, 3, 7, 2, 8, 4, 6, 1)</p>
<ul>
<li><p>The ordered array of the data is (1, 2, 3, 4, 5, 6, 7, 8).</p></li>
<li><p>This can be done using the <code>sort()</code> function in R as follows:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a vector of raw data</span></span>
<span id="cb1-2">raw_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sort the raw data in ascending order</span></span>
<span id="cb1-5">ordered_array <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span>(raw_data)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display the ordered array</span></span>
<span id="cb1-8">ordered_array</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5 6 7 8</code></pre>
</div>
</div></li>
</ul></li>
</ul>
</section>
<section id="frequency-distribution" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="frequency-distribution"><span class="header-section-number">1.3</span> Frequency distribution</h3>
<ul>
<li>It is used to summarize raw data by grouping the data into classes and counting the number of observations in each class.</li>
</ul>
</section>
</section>
<section id="frequency-distribution-of-categorical-variables" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="frequency-distribution-of-categorical-variables"><span class="header-section-number">2</span> Frequency distribution of categorical variables</h2>
<ul>
<li><p>These variables can be summarized by counting the number of observations in each category (this count is known as the absolute frequency).</p></li>
<li><p>The relative frequency of each category is the proportion of observations in that category relative to the total number of observations.</p></li>
<li><p>For example, consider the variable <code>vs</code> (engine type) in the <code>mtcars</code> dataset:</p>
<ul>
<li><p>This variable contains two categories: <code>0</code> (V-shaped) and <code>1</code> (Straight).</p></li>
<li><p>The frequency distribution and relative frequency of the variable <code>vs</code> can be calculated using base R functions or directly using custom functions from <code>vtable</code> and <code>gtsummary</code> packages:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">Base R</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">Using <code>sumtable()</code></a></li><li class="nav-item"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" aria-controls="tabset-1-3" aria-selected="false">Using <code>tbl_summary()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<ul>
<li><p>Load the dataset and display the variable</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load the mtcars dataset</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(mtcars)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display the values of the vs variable</span></span>
<span id="cb3-5">mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vs</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0 0 1 1 0 1 0 1 1 1 1 0 0 0 0 0 0 1 1 1 1 0 0 0 0 1 0 1 0 0 0 1</code></pre>
</div>
</div></li>
<li><p>Check the type (class) of the variable</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
</div></li>
<li><p>Convert the variable to a factor and modify labels</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># convert the variable to a factor</span></span>
<span id="cb6-2">mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(</span>
<span id="cb6-4">    mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vs,</span>
<span id="cb6-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb6-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"V-shaped"</span>,</span>
<span id="cb6-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Straight"</span></span>
<span id="cb6-8">  )</span>
<span id="cb6-9">)</span>
<span id="cb6-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vs)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "V-shaped" "Straight"</code></pre>
</div>
</div></li>
<li><p>Create a frequency distribution table</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a frequency distribution table for the vs variable</span></span>
<span id="cb8-2">freq_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vs)</span>
<span id="cb8-3">freq_tbl</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
V-shaped Straight 
      18       14 </code></pre>
</div>
</div></li>
<li><p>Calculate the relative frequency</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># calculate the relative frequency</span></span>
<span id="cb10-2">rel_freq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prop.table</span>(freq_tbl)</span>
<span id="cb10-3">rel_freq</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
V-shaped Straight 
  0.5625   0.4375 </code></pre>
</div>
</div></li>
<li><p>Display the relative frequency as a percentage</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display as percentage</span></span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(</span>
<span id="cb12-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(rel_freq), </span>
<span id="cb12-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>( </span>
<span id="cb12-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(       </span>
<span id="cb12-6">      (rel_freq <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>), </span>
<span id="cb12-7">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb12-8">    ), </span>
<span id="cb12-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span></span>
<span id="cb12-10">  )</span>
<span id="cb12-11">)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]       [,2]      
[1,] "V-shaped" "Straight"
[2,] "56.2%"    "43.8%"   </code></pre>
</div>
</div></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(vtable)</span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb14-3"></span>
<span id="cb14-4">mtcars <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb14-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(vs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># select the vs variable </span></span>
<span id="cb14-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sumtable</span>( </span>
<span id="cb14-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Engine Type'</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># change the label of the vs variable </span></span>
<span id="cb14-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set the number of digits </span></span>
<span id="cb14-9">    )</span></code></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Summary Statistics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">N</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Engine Type</td>
<td style="text-align: left;">32</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">... V-shaped</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">56.2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">... Straight</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">43.8%</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gtsummary)</span>
<span id="cb15-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb15-3"></span>
<span id="cb15-4">mtcars <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb15-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(vs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># select the vs variable </span></span>
<span id="cb15-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tbl_summary</span>(</span>
<span id="cb15-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Engine Type"</span>),  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># change the label of the vs variable</span></span>
<span id="cb15-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> vs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set the number of digits, 0 for frequency and 1 for relative frequency</span></span>
<span id="cb15-9">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="tdtmgyduld" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tdtmgyduld table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tdtmgyduld thead, #tdtmgyduld tbody, #tdtmgyduld tfoot, #tdtmgyduld tr, #tdtmgyduld td, #tdtmgyduld th {
  border-style: none;
}

#tdtmgyduld p {
  margin: 0;
  padding: 0;
}

#tdtmgyduld .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tdtmgyduld .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tdtmgyduld .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tdtmgyduld .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tdtmgyduld .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tdtmgyduld .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdtmgyduld .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tdtmgyduld .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tdtmgyduld .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tdtmgyduld .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tdtmgyduld .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tdtmgyduld .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tdtmgyduld .gt_spanner_row {
  border-bottom-style: hidden;
}

#tdtmgyduld .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tdtmgyduld .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tdtmgyduld .gt_from_md > :first-child {
  margin-top: 0;
}

#tdtmgyduld .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tdtmgyduld .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tdtmgyduld .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tdtmgyduld .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tdtmgyduld .gt_row_group_first td {
  border-top-width: 2px;
}

#tdtmgyduld .gt_row_group_first th {
  border-top-width: 2px;
}

#tdtmgyduld .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdtmgyduld .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tdtmgyduld .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tdtmgyduld .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdtmgyduld .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdtmgyduld .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tdtmgyduld .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tdtmgyduld .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tdtmgyduld .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdtmgyduld .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tdtmgyduld .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdtmgyduld .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tdtmgyduld .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdtmgyduld .gt_left {
  text-align: left;
}

#tdtmgyduld .gt_center {
  text-align: center;
}

#tdtmgyduld .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tdtmgyduld .gt_font_normal {
  font-weight: normal;
}

#tdtmgyduld .gt_font_bold {
  font-weight: bold;
}

#tdtmgyduld .gt_font_italic {
  font-style: italic;
}

#tdtmgyduld .gt_super {
  font-size: 65%;
}

#tdtmgyduld .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tdtmgyduld .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tdtmgyduld .gt_indent_1 {
  text-indent: 5px;
}

#tdtmgyduld .gt_indent_2 {
  text-indent: 10px;
}

#tdtmgyduld .gt_indent_3 {
  text-indent: 15px;
}

#tdtmgyduld .gt_indent_4 {
  text-indent: 20px;
}

#tdtmgyduld .gt_indent_5 {
  text-indent: 25px;
}

#tdtmgyduld .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tdtmgyduld div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_0" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N = 32</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Engine Type</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;V-shaped</td>
<td class="gt_row gt_center" headers="stat_0">18 (56.3%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Straight</td>
<td class="gt_row gt_center" headers="stat_0">14 (43.8%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
</div>
</div></li>
</ul></li>
</ul>
<section id="graphical-representation" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="graphical-representation"><span class="header-section-number">2.1</span> Graphical representation</h3>
<section id="bar-chart" class="level4" data-number="2.1.1">
<h4 data-number="2.1.1" class="anchored" data-anchor-id="bar-chart"><span class="header-section-number">2.1.1</span> Bar chart</h4>
<ul>
<li><p>This type of charts is used to represent the frequency distribution of categorical variables.</p></li>
<li><p>It consists of a rectangular bar (column) for each category, where the height of the bar represents the absolute frequency or relative frequency of that category.</p></li>
<li><p>The bars can be arranged horizontally or vertically.</p></li>
<li><p>For ordinal scale variables, it is better to arrange the bars on the <img src="https://latex.codecogs.com/png.latex?x">-axis based on the order of the categories.</p></li>
<li><p>The frequency distribution of the <code>vs</code> variable can be represented using a bar chart as follows:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true">Base R</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" aria-controls="tabset-2-2" aria-selected="false">Using <code>ggplot2</code></a></li><li class="nav-item"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" aria-controls="tabset-2-3" aria-selected="false">Horizontal bar chart</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a bar chart for the vs variable</span></span>
<span id="cb16-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">barplot</span>(</span>
<span id="cb16-3">  freq_tbl,</span>
<span id="cb16-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency distribution of the Engine Type"</span>,</span>
<span id="cb16-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Engine Type"</span>,</span>
<span id="cb16-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span>,</span>
<span id="cb16-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgreen"</span>),</span>
<span id="cb16-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">border =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb16-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names.arg =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"V-shaped"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Straight"</span>),</span>
<span id="cb16-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>),</span>
<span id="cb16-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>), </span>
<span id="cb16-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb16-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">space =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb16-14">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B01_Freq_dist1_stats_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb17-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggthemes)</span>
<span id="cb17-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)</span>
<span id="cb17-4"></span>
<span id="cb17-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a data frame from the frequency table</span></span>
<span id="cb17-6">freq_tbl_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb17-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb17-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">engine_type =</span></span>
<span id="cb17-9">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(</span>
<span id="cb17-10">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(freq_tbl),</span>
<span id="cb17-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(freq_tbl)</span>
<span id="cb17-12">      ),</span>
<span id="cb17-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(freq_tbl)</span>
<span id="cb17-14">  )</span>
<span id="cb17-15"></span>
<span id="cb17-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a new column for the relative frequency</span></span>
<span id="cb17-17">total_freq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(freq_tbl)</span>
<span id="cb17-18">freq_tbl_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb17-19">  freq_tbl_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb17-21">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rel_freq =</span> </span>
<span id="cb17-22">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(</span>
<span id="cb17-23">          (freq <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_freq) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb17-24">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb17-25">        )</span>
<span id="cb17-26">    )</span>
<span id="cb17-27"></span>
<span id="cb17-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a bar chart with frequency on y-axis</span></span>
<span id="cb17-29">fig1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb17-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>( </span>
<span id="cb17-31">    freq_tbl_df,</span>
<span id="cb17-32">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb17-33">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> engine_type,</span>
<span id="cb17-34">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> freq,</span>
<span id="cb17-35">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> engine_type</span>
<span id="cb17-36">    )</span>
<span id="cb17-37"> ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-38"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># you can also use geom_bar(stat = "identity")</span></span>
<span id="cb17-39"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb17-40">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency distribution </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> of the Engine Type"</span>,</span>
<span id="cb17-41">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Engine Type"</span>,</span>
<span id="cb17-42">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span></span>
<span id="cb17-43"> ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-44"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb17-45">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgreen"</span>)</span>
<span id="cb17-46"> ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-47"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb17-48">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>),</span>
<span id="cb17-49">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb17-50"> ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-51"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_few</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-52"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb17-53">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), </span>
<span id="cb17-54">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb17-55">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb17-56"> )</span>
<span id="cb17-57"></span>
<span id="cb17-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a bar chart with relative frequency on y-axis</span></span>
<span id="cb17-59">fig2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb17-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb17-61">    freq_tbl_df,</span>
<span id="cb17-62">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb17-63">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> engine_type,</span>
<span id="cb17-64">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> rel_freq,</span>
<span id="cb17-65">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> engine_type</span>
<span id="cb17-66">    )</span>
<span id="cb17-67"> ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-68"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-69"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb17-70">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Relative Frequency </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> distribution of the Engine Type"</span>,</span>
<span id="cb17-71">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Engine Type"</span>,</span>
<span id="cb17-72">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Relative Frequency (%)"</span>, </span>
<span id="cb17-73">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Engine Type"</span></span>
<span id="cb17-74"> ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-75"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb17-76"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgreen"</span>)</span>
<span id="cb17-77"> ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-78"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb17-79">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>),</span>
<span id="cb17-80">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb17-81"> ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-82"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_few</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-83"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb17-84">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb17-85">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb17-86"> )</span>
<span id="cb17-87"></span>
<span id="cb17-88"> fig1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_spacer</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> fig2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">widths =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B01_Freq_dist1_stats_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use the same code as described in the previous tab but just add coord_flip() to the ggplot object</span></span>
<span id="cb18-2"></span>
<span id="cb18-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb18-4">  freq_tbl_df,</span>
<span id="cb18-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb18-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> engine_type,</span>
<span id="cb18-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> rel_freq,</span>
<span id="cb18-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> engine_type</span>
<span id="cb18-9">  )</span>
<span id="cb18-10">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb18-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb18-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Relative Frequency distribution of the Engine Type"</span>,</span>
<span id="cb18-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Engine Type"</span>,</span>
<span id="cb18-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Relative Frequency (%)"</span>, </span>
<span id="cb18-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Engine Type"</span></span>
<span id="cb18-17">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb18-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgreen"</span>)</span>
<span id="cb18-20">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb18-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>),</span>
<span id="cb18-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb18-24">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_few</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb18-28">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), </span>
<span id="cb18-29">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B01_Freq_dist1_stats_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div></li>
<li><p>Bar charts can be also used to compare the frequency distribution of a categorical variable across different groups.</p></li>
<li><p>For example, the following bar chart shows the differences in the frequency distribution of the <code>vs</code> variable across the <code>am</code> variable (transmission type; 0: automatic and 1: manual) in the <code>mtcars</code> dataset:</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb19-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggthemes)</span>
<span id="cb19-3"></span>
<span id="cb19-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb19-5">  mtcars,</span>
<span id="cb19-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb19-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(am),</span>
<span id="cb19-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(vs),</span>
<span id="cb19-9">  )</span>
<span id="cb19-10">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(</span>
<span id="cb19-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_dodge</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.55</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add small gap between bars </span></span>
<span id="cb19-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb19-14">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb19-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency distribution of Engine Type by Transmission Type"</span>,</span>
<span id="cb19-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Transmission Type"</span>,</span>
<span id="cb19-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span>,</span>
<span id="cb19-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Engine Type"</span>, </span>
<span id="cb19-20">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb19-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgreen"</span>)</span>
<span id="cb19-23">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_discrete</span>(</span>
<span id="cb19-25">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Automatic"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Manual"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># change the labels of the x-axis</span></span>
<span id="cb19-26">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb19-28">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), </span>
<span id="cb19-29">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)</span>
<span id="cb19-30">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_few</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb19-33">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb19-34">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb19-35">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B01_Freq_dist1_stats_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The above figure shows that the V-shaped engine is more common in cars with automatic transmission compared to manual transmission.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>It is recommended to start the baseline of the y-axis at zero to avoid inaccurate interpretations.</li>
</ul>
</div>
</div>
</section>
<section id="pie-chart" class="level4" data-number="2.1.2">
<h4 data-number="2.1.2" class="anchored" data-anchor-id="pie-chart"><span class="header-section-number">2.1.2</span> Pie chart</h4>
<ul>
<li><p>It is also used to represent the frequency distribution of categorical variables.</p></li>
<li><p>It consists of a circle divided into parts, where each part represents a category.</p></li>
<li><p>The size of each part is equal to the angle calculated by multiplying the relative frequency of the category by <img src="https://latex.codecogs.com/png.latex?360%20%5E%5Ccirc"> (the total angle of a circle).</p></li>
<li><p>For instance, the relative frequency of the V-shaped engine in the above example is <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cfrac%7B18%7D%7B32%7D%20=%200.5625">, this corresponds to an angle of <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%200.5625%20%5Ctimes%20360%20=%20202.5%5E%5Ccirc"> degrees.</p></li>
<li><p>The pie chart is suitable for variables with a small number of categories; it becomes cluttered and hard to read when the number of categories is large.</p></li>
<li><p>If the number of observations is small, it is recommended to display the absolute frequency on the chart rather than the percentage, which can be misleading.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" aria-controls="tabset-3-1" aria-selected="true">Base R</a></li><li class="nav-item"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" aria-controls="tabset-3-2" aria-selected="false">Using <code>ggplot2</code></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># extract the relative frequencies from the data frame created above</span></span>
<span id="cb20-2">percentages <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> freq_tbl_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rel_freq</span>
<span id="cb20-3"></span>
<span id="cb20-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create labels with the percentages</span></span>
<span id="cb20-5">labels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb20-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"V-shaped"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Straight"</span>), </span>
<span id="cb20-7">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, </span>
<span id="cb20-8">         percentages, </span>
<span id="cb20-9">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span></span>
<span id="cb20-10">  )</span>
<span id="cb20-11"></span>
<span id="cb20-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a pie chart </span></span>
<span id="cb20-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pie</span>(</span>
<span id="cb20-14"> freq_tbl,</span>
<span id="cb20-15"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pie chart of the Engine Type"</span>,</span>
<span id="cb20-16"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgreen"</span>),</span>
<span id="cb20-17"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> labels,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use the percentage labels</span></span>
<span id="cb20-18"> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clockwise =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb20-19">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B01_Freq_dist1_stats_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide code</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb21-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggthemes)</span>
<span id="cb21-3"></span>
<span id="cb21-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb21-5">  freq_tbl_df,</span>
<span id="cb21-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb21-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb21-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> rel_freq,</span>
<span id="cb21-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> engine_type</span>
<span id="cb21-10">  )</span>
<span id="cb21-11">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(</span>
<span id="cb21-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>,</span>
<span id="cb21-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb21-15">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_polar</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb21-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pie chart of the Engine Type"</span>,</span>
<span id="cb21-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Engine Type"</span></span>
<span id="cb21-20">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb21-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skyblue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgreen"</span>)</span>
<span id="cb21-23">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb21-26">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>, </span>
<span id="cb21-27">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb21-28">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb21-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> labels),</span>
<span id="cb21-31">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_stack</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb21-32">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.amrbiostats.com/posts/biostats/B01_Freq_dist1_stats_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div></li>
</ul>
</section>
</section>
</section>
<section id="references" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="references"><span class="header-section-number">3</span> References</h2>
<ul>
<li><p>Daniel, W. W. and Cross, C. L. (2013). Biostatistics: A Foundation for Analysis in the Health Sciences, Tenth edition. Wiley</p></li>
<li><p>Heumann, C., Schomaker, M., and Shalabh (2022). Introduction to Statistics and Data Analysis: With Exercises, Solutions and Applications in R. Springer</p></li>
<li><p>Lane, D. M. et al., (2019). Introduction to Statistics. Online Edition. Retrieved September 14, 2024, from https://openstax.org/details/introduction-statistics</p></li>
</ul>
<p><br></p>
</section>
<section id="add-your-comments" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="add-your-comments"><span class="header-section-number">4</span> Add your comments</h2>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <guid>https://www.amrbiostats.com/posts/biostats/B01_Freq_dist1_stats.html</guid>
  <pubDate>Sun, 29 Sep 2024 20:00:00 GMT</pubDate>
  <media:content url="https://www.amrbiostats.com/images/biostats.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Variables</title>
  <link>https://www.amrbiostats.com/posts/biostats/A02_intro.html</link>
  <description><![CDATA[ 




<section id="variables" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="variables"><span class="header-section-number">1</span> Variables</h2>
<ul>
<li><p>A variable can be defined as a characteristic or attribute that can be measured or observed.</p></li>
<li><p>The values of a variable change from one observation to another (this is opposed to constants that do not change).</p></li>
</ul>
</section>
<section id="random-variables" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="random-variables"><span class="header-section-number">2</span> Random variables</h2>
<ul>
<li><p>When the values of the variable are the result of chance factors (i.e., the values are subject to randomness or uncertainty), the variable is refered to as a random variable.</p></li>
<li><p>For example, when a coin is flipped, the outcome (head or tail) is random and can not be predicted with certainty until experiment is performed (i.e., the coin is flipped).</p></li>
</ul>
<section id="types-of-variables" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="types-of-variables"><span class="header-section-number">2.1</span> Types of variables</h3>
<section id="independent-and-dependent-variables" class="level4" data-number="2.1.1">
<h4 data-number="2.1.1" class="anchored" data-anchor-id="independent-and-dependent-variables"><span class="header-section-number">2.1.1</span> Independent and Dependent variables</h4>
<ul>
<li><p><strong>Independent variable</strong>:</p>
<ul>
<li><p>It is a variable that is manipulated or controlled by the researcher during an experiment.</p></li>
<li><p>It has other names such as predictor, explanatory, or treatment variable.</p></li>
<li><p>It may have different levels or categories.</p></li>
</ul></li>
<li><p><strong>Dependent variable</strong>:</p>
<ul>
<li><p>It is a variable that is measured or observed during an experiment in response to changes in the independent variable(s).</p></li>
<li><p>It has other names such as outcome or response variable.</p></li>
</ul></li>
<li><p>Example:</p>
<ul>
<li><p>In a study evaluating the effect of three medications on lowering blood pressure in hypertensive patients:</p>
<ul>
<li><p>The medication type is the <code>independent variable</code> that has three levels (medication A, medication B, and medication C).</p></li>
<li><p>The blood pressure is the <code>dependent variable</code>.</p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="qualitative-and-quantitative-variables" class="level4" data-number="2.1.2">
<h4 data-number="2.1.2" class="anchored" data-anchor-id="qualitative-and-quantitative-variables"><span class="header-section-number">2.1.2</span> Qualitative and Quantitative variables</h4>
<ul>
<li><p><strong>Qualitative (categorical) variables</strong>:</p>
<ul>
<li><p>They can not be measured in the usual sense but can be only classified into categories (i.e., they express a quality or attribute).</p></li>
<li><p>Examples: hair color, socioeconomic status, etc.</p></li>
</ul></li>
<li><p><strong>Quantitative (numerical) variables</strong>:</p>
<ul>
<li><p>They represent measurable quantities that can be expressed in terms of numbers.</p></li>
<li><p>Examples: age, weight, blood pressure, etc.</p></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Qualitative variables can be assigned numbers for coding purposes, however, these numbers do not have any numerical significance.</p></li>
<li><p>For example:</p>
<ul>
<li><p>The categories of the variable gender {“male” and “female”} can be coded as {0 and 1}, {1 and 2}, or {2 and 1}, etc.</p></li>
<li><p>The selection of codes is arbitrary and does not imply any numerical order.</p></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="discrete-and-continuous-variables" class="level4" data-number="2.1.3">
<h4 data-number="2.1.3" class="anchored" data-anchor-id="discrete-and-continuous-variables"><span class="header-section-number">2.1.3</span> Discrete and Continuous variables</h4>
<ul>
<li><p><strong>Discrete variables</strong>:</p>
<ul>
<li><p>They can take only whole numbers (i.e., integers).</p></li>
<li><p>They can be described as having no intermediate values between two adjacent values (i.e., they have gaps or interruptions in the values that they can assume).</p></li>
<li><p>Discrete variables can be either qualitative or quantitative (all qualitative variables are discrete by definition).</p></li>
<li><p>Examples:</p>
<ul>
<li><p>Number of migraine attacks, number of children in a family, number of hospital admissions , etc.</p></li>
<li><p>The above variables can take whole numbers such as <img src="https://latex.codecogs.com/png.latex?0,%201,%202,%203,%20%5Ccdots">, but they can not be fractional numbers such as <img src="https://latex.codecogs.com/png.latex?1.34,%202.76">, etc.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Continuous variables</strong>:</p>
<ul>
<li><p>Unlike discrete variables, continuous variables can take any value within a given range.</p></li>
<li><p>They do not have gaps or interruptions in the values that they can assume (i.e., between any two values, there are an infinite number of other values).</p></li>
<li><p>Examples:</p>
<ul>
<li><p>Age, weight, height, blood pressure, etc.</p></li>
<li><p>The above variables can take any value within a given range (e.g., weight can be <img src="https://latex.codecogs.com/png.latex?25.3,%2030.6,%2045.8"> kg, etc.).</p></li>
</ul></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Continuous variables are often recorded rounded to a certain number of decimal places as if they were discrete variables.</p></li>
<li><p>The cause of this is the limitations of the measuring instruments used to collect the data (the scale in the case of weight, the thermometer in the case of temperature, etc.).</p></li>
<li><p>Therefore, the weight of an individual can take infinite values between say <img src="https://latex.codecogs.com/png.latex?70"> and <img src="https://latex.codecogs.com/png.latex?71"> kg, but in practice it is recorded rounded to the nearest decimal place (e.g., <img src="https://latex.codecogs.com/png.latex?70.3,%2070.6,%2070.8"> kg, etc.) because of the lack of precise measurement.<br>
</p></li>
</ul>
</div>
</div>
</section>
</section>
</section>
<section id="scales-of-measurement" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="scales-of-measurement"><span class="header-section-number">3</span> Scales of measurement</h2>
<ul>
<li><p>Measurement can be defined as the assignment of numbers to objects or events according to certain rules.</p></li>
<li><p>Different scales of measurement arise from the fact that numbers can be assigned to objects or events under different sets of rules.</p></li>
<li><p>Each scale of measurement has its own properties that affect the type of statistical analysis that can be performed on the data.</p></li>
<li><p>These properties include the order of the categories, the distance between the categories, and the presence of a true zero point.</p></li>
<li><p>According to Stevens (1946), there are four scales of measurement:</p>
<ol type="1">
<li><p><strong>Nominal scale</strong>:</p>
<ul>
<li><p>It involves naming or classifying observations into categories that are mutually exclusive (i.e., categories that do not overlap) and collectively exhaustive (i.e., every observation must fall into one of the categories).</p></li>
<li><p>The categories have no inherent order or ranking.</p></li>
<li><p>Examples of nominal scale variables:</p>
<ol type="i">
<li><p>Blood type (A, B, AB, and O).</p></li>
<li><p>Hair color (black, brown, blonde, and red).</p></li>
<li><p>Gender (male and female).</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>A nominal variable that possesses only two categories is referred to as a dichotomous or binary variable (e.g., gender, yes/no response).</li>
</ul>
</div>
</div></li>
</ul></li>
<li><p><strong>Ordinal scale</strong>:</p>
<ul>
<li><p>Like the nominal scale, the ordinal scale involves naming or classifying observations into categories that are mutually exclusive and collectively exhaustive.</p></li>
<li><p>However, the categories have <em>a natural order or ranking</em>.</p></li>
<li><p>The distance or the the difference between the categories is not necessarily equal (i.e., the difference between the categories is not meaningful in a numerical sense).</p></li>
<li><p>Examples of ordinal scale variables:</p>
<ol type="i">
<li><p>Educational level (elementary, high school, college, and postgraduate).</p></li>
<li><p>Socioeconomic status (low, middle, and high).</p></li>
<li><p>Pain severity (mild, moderate, and severe).</p></li>
<li><p>Cancer stage (stage I, stage II, stage III, and stage IV).</p></li>
<li><p>Likert scale (strongly disagree, disagree, neutral, agree, and strongly agree).</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Consider for example the variable <strong>pain severity</strong>, the difference between <strong>mild</strong> and <strong>moderate</strong> is not necessarily equal to the difference between <strong>moderate</strong> and <strong>severe</strong>.</p></li>
<li><p>Even if we can code the categories as 1, 2, and 3, no mathematical operations can be performed on these numbers and we still can not say that the difference between 1 and 2 is equal to the difference between 2 and 3.</p></li>
</ul>
</div>
</div></li>
</ul></li>
<li><p><strong>Interval scale</strong>:</p>
<ul>
<li><p>It is a quantitative and numerical scale.</p></li>
<li><p>The measurements are ordered (ranked).</p></li>
<li><p>The difference between measurements is meaningful (i.e., interpretable).</p></li>
<li><p>It does not have a true zero point (i.e., the value of zero does not indicate the absence of the quantity being measured). This zero point is arbitrary.</p></li>
<li><p>The ratio of two measurements is not meaningful because of the absence of a true zero point.</p></li>
<li><p>Examples of interval scale variables:</p>
<ol type="i">
<li><p>Temperature measured in Celsius or Fahrenheit.</p></li>
<li><p>Intelligence Quotient (IQ) scores.</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Consider the temperature measured in Celsius, the difference between 10°C and 15°C is equal to the difference between 20°C and 25°C.</p></li>
<li><p>However, the ratio of 20°C to 10°C is not meaningful (i.e., we can not say that 20°C is twice as hot as 10°).</p></li>
<li><p>The value of zero Celsius does not imply the absence of temperature (i.e., the absence of molecular kinetic energy).</p></li>
</ul>
</div>
</div></li>
</ul></li>
<li><p><strong>Ratio scale</strong>:</p>
<ul>
<li><p>It has the properties of the interval scale with the addition of:</p>
<ol type="i">
<li><p>A true zero point.</p></li>
<li><p>The ratio of two measurements is meaningful.</p></li>
</ol></li>
<li><p>Examples of ratio scale variables:</p>
<ol type="i">
<li><p>Age.</p></li>
<li><p>Weight.</p></li>
<li><p>Temperature measured in Kelvin (this scale has a true zero point).</p></li>
</ol></li>
</ul></li>
</ol></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" style="color: #0466c8;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Each scale has the same properties as the scales that precede it.</p></li>
<li><p>The statistical analysis that can be performed on a lower scale variable can also be performed on a higher scale variable but the reverse is not true.</p></li>
<li><p>The scales can be ordered according to the level of information they provide in a descending order as follows: ratio &gt; interval &gt; ordinal &gt; nominal.</p></li>
</ul>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true"><span style="color: #ba181b">Exercise B.1.1 <iconify-icon inline="" icon="fluent:chat-bubbles-question-20-filled" style="font-size: 21px;" aria-label="Icon chat-bubbles-question-20-filled from fluent Iconify.design set." title="Icon chat-bubbles-question-20-filled from fluent Iconify.design set."></iconify-icon></span></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<p>Indicate the measurement scale for each of the following variables:</p>
<div class="webex-check webex-box">
<p>Car speed <select class="webex-select"><option value="blank"></option><option value="">nominal</option><option value="">ordinal</option><option value="">interval</option><option value="answer">ratio</option></select></p>
<p>Cancer diagnosis <select class="webex-select"><option value="blank"></option><option value="answer">nominal</option><option value="">ordinal</option><option value="">interval</option><option value="">ratio</option></select></p>
<p>Pain level on a 5-point scale <select class="webex-select"><option value="blank"></option><option value="">nominal</option><option value="answer">ordinal</option><option value="">interval</option><option value="answer">ratio</option></select></p>
<p>Serum sodium level <select class="webex-select"><option value="blank"></option><option value="">nominal</option><option value="">ordinal</option><option value="">interval</option><option value="answer">ratio</option></select></p>
</div>
</div>
</div>
</div>
</section>
<section id="references" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="references"><span class="header-section-number">4</span> References</h2>
<ul>
<li><p>Daniel, W. W. and Cross, C. L. (2013). Biostatistics: A Foundation for Analysis in the Health Sciences, Tenth edition. Wiley</p></li>
<li><p>Heumann, C., Schomaker, M., and Shalabh (2022). Introduction to Statistics and Data Analysis: With Exercises, Solutions and Applications in R. Springer</p></li>
<li><p>Lane, D. M. et al., (2019). Introduction to Statistics. Online Edition. Retrieved September 14, 2024, from https://openstax.org/details/introduction-statistics</p></li>
</ul>
<p><br></p>
</section>
<section id="add-your-comments" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="add-your-comments"><span class="header-section-number">5</span> Add your comments</h2>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <guid>https://www.amrbiostats.com/posts/biostats/A02_intro.html</guid>
  <pubDate>Fri, 20 Sep 2024 20:00:00 GMT</pubDate>
  <media:content url="https://www.amrbiostats.com/images/biostats.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Basic Concepts</title>
  <link>https://www.amrbiostats.com/posts/biostats/A01_intro.html</link>
  <description><![CDATA[ 




<section id="definitions" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="definitions"><span class="header-section-number">1</span> Definitions</h2>
<ul>
<li><p>Statistics is the branch of science that deals with the collection, summarization, analysis, and interpretation of data.</p></li>
<li><p>Biostatistics is the application of statistics to data collected from experiments in the field of biological sciences or medicine.</p></li>
</ul>
</section>
<section id="population-and-sample" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="population-and-sample"><span class="header-section-number">2</span> Population and Sample</h2>
<section id="population" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="population"><span class="header-section-number">2.1</span> Population</h3>
<ul>
<li><p>A population can be defined as the largest group of entities (people, animals, plants, etc.) that we are interested in studying or drawing conclusions about.</p></li>
<li><p>Population can be finite or infinite.</p></li>
<li><p>The units of a population are termed as observations.</p></li>
</ul>
</section>
<section id="sample" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sample"><span class="header-section-number">2.2</span> Sample</h3>
<ul>
<li><p>A sample is a subset of the population.</p></li>
<li><p>It is used to draw conclusions about the population because collecting data from the entire population is often impractical, costly, and time-consuming, particularly when the population is extremely large.</p></li>
</ul>
</section>
<section id="example" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="example"><span class="header-section-number">2.3</span> Example</h3>
<ul>
<li><p>If we are interested in evaluating the effect of a new medication on lowering blood glucose levels in diabetic patients:</p>
<ul>
<li><p>The population would be all diabetic patients, however, it is not feasible to collect data from all diabetic patients.</p></li>
<li><p>Therefore, we would collect data from a representative part of diabetic patients (sample).</p></li>
<li><p>The data collected from this sample can be used to draw conclusions about the effect of the medication on the entire population of diabetic patients.</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="main-areas-of-statistics" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="main-areas-of-statistics"><span class="header-section-number">3</span> Main areas of statistics</h2>
<ul>
<li><p><strong>Descriptive statistics</strong>:</p>
<ul>
<li><p>It is used to summarize and describe data collected from a sample or population.</p></li>
<li><p>It includes measures of central tendency (average), measures of dispersion (spread), and graphical representation of data.</p></li>
</ul></li>
<li><p><strong>Inferential statistics</strong>:</p>
<ul>
<li><p>It is used to draw conclusions (i.e., make inferences) about a population based on data collected from a sample drawn from that population.</p></li>
<li><p>It includes hypothesis testing, confidence intervals, and other statistical methods.</p></li>
</ul></li>
</ul>
</section>
<section id="references" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="references"><span class="header-section-number">4</span> References</h2>
<ul>
<li><p>Daniel, W. W. and Cross, C. L. (2013). Biostatistics: A Foundation for Analysis in the Health Sciences, Tenth edition. Wiley</p></li>
<li><p>Heumann, C., Schomaker, M., and Shalabh (2022). Introduction to Statistics and Data Analysis: With Exercises, Solutions and Applications in R. Springer</p></li>
<li><p>Lane, D. M. et al., (2019). Introduction to Statistics. Online Edition. Retrieved September 14, 2024, from https://openstax.org/details/introduction-statistics</p></li>
</ul>
<p><br></p>
</section>
<section id="add-your-comments" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="add-your-comments"><span class="header-section-number">5</span> Add your comments</h2>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <guid>https://www.amrbiostats.com/posts/biostats/A01_intro.html</guid>
  <pubDate>Fri, 13 Sep 2024 20:00:00 GMT</pubDate>
  <media:content url="https://www.amrbiostats.com/images/biostats.jpg" medium="image" type="image/jpeg"/>
</item>
</channel>
</rss>
