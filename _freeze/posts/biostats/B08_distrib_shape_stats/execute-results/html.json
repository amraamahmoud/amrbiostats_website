{
  "hash": "9bdd909e89a03c233ad94be4bfebc4e8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Describing the shape of distribution\"\nimage: \"/images/biostats.jpg\"\ndate: \"2024-11-15\"\nformat: \n  html: \n    fig-align: center\n    page-layout: article\n    toc: true\n    toc-depth: 5\n    toc-expand: true\n    lightbox: false\ncrossref: \n  custom: \n    - kind: float\n      reference-prefix: \"Example M.10.\"\n      key: tabset\n      space-before-numbering: false\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n:::\n\n\n\n\n## Background\n\n-   The shape of a distribution can be described in terms of the direction and degree of asymmetry, measured by **skewness**, and the heaviness of the tails, measured by **kurtosis**.\n\n## Skewness\n\n-   It is a measure of the direction and degree of asymmetry of a distribution.\n\n-   It is described as the standardized third moment $(m_3)$ of the distribution about the mean (the concept of moments will be discussed in upcoming articles).\n\n### Formula\n\n-   There are three formulas to calculate skewness (we will use **sample moments**):\n\n    1.  **Raw formula** $g_1$:\n\n        $$\n        g_1 = \\displaystyle \\frac{m_3}{m_2^{3/2}}\n        $$\n\n        -   $m_3$ is the third moment about the mean:\n\n            $$\n            m_3 = \\displaystyle \\frac{1}{n} \\sum_{i=1}^{n} (x_i - \\bar{x})^3\n            $$\n\n        -   $m_2$ is the second moment about the mean:\n\n            $$\n            m_2 = \\displaystyle \\frac{1}{n} \\sum_{i=1}^{n} (x_i - \\bar{x})^2\n            $$\n\n        -   It is not biased-corrected for small samples.\n\n        -   This formula is used by `Excel`(`SKEW.P` function).\n\n    2.  **Fisher's** $G_1$:\n\n        $$\n        G_1 = g_1 \\displaystyle \\frac{\\sqrt {n(n-1)}}{n-2}\n        $$\n\n        -   This measure of skewness is bias-corrected for small samples.\n\n        -   As $n$ increases, the correction factor becomes closer to $1$.\n\n        -   This formula is used by `SAS`, `SPSS`, `NCSS`, `Excel` (`SKEW` function), and `Graphpad Prism`.\n\n    3.  Skewness $b_1$:\n\n        $$\n        b_1 = \\displaystyle \\frac{m_3}{s^3} = g_1 \\big (\\displaystyle \\frac{n-1}{n} \\big)^{3/2}\n        $$\n\n        -   $s$ is the sample standard deviation $\\big [s = \\sqrt{\\displaystyle \\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})^2} \\big]$.\n\n        -   This formula is used by `Minitab`.\n\n        -   This measure uses a slight adjustment by including the factor $(\\displaystyle \\frac{n-1}{n})^{3/2}$.\n\n-   The standard error of skewness is given by:\n\n    $$\n    SE_{skewness} = \\sqrt \\frac{6n(n-1)}{(n-2)(n+1)(n+3)}\n    $$\n\n### Interpretation\n\n-   A skewness value of zero indicates a symmetrical distribution (mean and median are equal or approximately equal).\n\n-   A positive value indicates a long right tail (right-skewed distribution, the mean is greater than the median).\n\n-   A negative value indicates a long left tail (left-skewed distribution, the mean is less than the median).\n\n-   Further interpretation will be discussed in detail under assessing the normality of data.\n\n-   The following figure shows different distributions and their skewness values:\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](B08_distrib_shape_stats_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\n### Calculation in R\n\n-   Different functions in R can be used to calculate the skewness:\n\n    -   `skewness()` function from the `moments` package (uses formula 1).\n\n    -   `Skewness()` function from the `sasLM` package (uses formula 2).\n\n    -   `skew()` function from the `psych` package or `skewness()` function from the `e1071` package can calculate skewness using the three formulas by setting the `type` argument to either $1$, $2$, or $3$.\n\n-   The skewness standard error can be calculated using the `SkewnessSE()` function from the `sasLM` package.\n\n-   For example, the skewness of the `insulin` variable from the `PimaIndiansDiabetes` dataset can be calculated as follows:\n\n    -   First, let's plot the density of the `insulin` variable:\n\n\n\n\n        ::: {.cell}\n        \n        ```{.r .cell-code}\n            # load the library and dataset\n            library(mlbench)\n            data(PimaIndiansDiabetes)\n        \n            # plot density of the insulin variable\n            plot(\n              density(PimaIndiansDiabetes$insulin, adjust =2),\n              main = \"Density plot of insulin\",\n              lwd = 2,\n              col = \"#0466c8\",\n            )\n        ```\n        \n        ::: {.cell-output-display}\n        ![](B08_distrib_shape_stats_files/figure-html/unnamed-chunk-3-1.png){width=672}\n        :::\n        \n        ```{.r .cell-code}\n            # calculate skewness and its standard error\n            library(psych)\n            library(sasLM)\n            paste(\n        \"Skewness =\", \n        round(skew(PimaIndiansDiabetes$insulin, type = 2), 3)\n            )\n        ```\n        \n        ::: {.cell-output .cell-output-stdout}\n        \n        ```\n        [1] \"Skewness = 2.272\"\n        ```\n        \n        \n        :::\n        \n        ```{.r .cell-code}\n            paste(\n        \"Skewness SE =\", \n        round(SkewnessSE(PimaIndiansDiabetes$insulin), 3)\n            )\n        ```\n        \n        ::: {.cell-output .cell-output-stdout}\n        \n        ```\n        [1] \"Skewness SE = 0.088\"\n        ```\n        \n        \n        :::\n        :::\n\n\n\n\n-   These results are similar to the results obtained by `SPSS` or `Graphpad Prism`:\n\n    ::: panel-tabset\n    ## SPSS\n\n    <img src=\"/images/skew_s.png\" alt=\"SPSS\" width=\"100%\"/>\n\n    ## Graphpad Prism\n\n    <img src=\"/images/skew_g.png\" alt=\"Graphpad Prism\" width=\"100%\"/>\n    :::\n\n## Kurtosis\n\n-   It is a measure of tail heaviness (tailedness) of a distribution.\n\n-   It is described as the standardized fourth moment $(m_4)$ of the distribution about the mean.\n\n::: {.callout-warning title=\"Kurtosis is not a measure of peakedness!\"}\n-   There is a misconception that kurtosis measures the peakedness, but actually its interpretation is in terms of tail extremity [(Westfall 2014)](https://doi.org/10.1080/00031305.2014.917055).\n:::\n\n### Formula\n\n-   There are three formulas to calculate excess kurtosis (we will use **sample moments**):\n\n    1.  **Raw formula** $g_2$:\n\n        $$\n        g_2 = \\displaystyle \\frac{m_4}{m_2^2} - 3\n        $$\n\n        -   $m_4$ is the fourth moment about the mean:\n\n            $$\n            m_4 = \\displaystyle \\frac{1}{n} \\sum_{i=1}^{n} (x_i - \\bar{x})^4\n            $$\n\n        -   $m_2$ is the second moment about the mean:\n\n            $$\n            m_2 = \\displaystyle \\frac{1}{n} \\sum_{i=1}^{n} (x_i - \\bar{x})^2\n            $$\n\n    2.  **Fisher's** $G_2$:\n\n        $$\n        G_2 = \\displaystyle \\frac{(n + 1)g_2 + 6}{(n - 2)(n - 3)}\n        $$\n\n        -   This formula is used by `SAS`, `SPSS`, `NCSS`, `Excel` (`KURT` function), and `Graphpad Prism`.\n\n    3.  Kurtosis $b_2$:\n\n        $$\n        b_1 = \\displaystyle \\frac{m_4}{s^4} -3 = (g_2 +3)(1 - \\displaystyle \\frac{1}{n})^2 - 3\n        $$\n\n        -   $s$ is the sample standard deviation $\\big [s = \\displaystyle \\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})^2 \\big ]$.\n\n        -   This formula is used by `Minitab`.\n\n-   The standard error of kurtosis is given by:\n\n    $$\n    SE_{kurtosis} = \\sqrt \\frac{24n(n-1)^2}{(n-3)(n-2)(n+3)(n+5)}\n    $$\n\n### Interpretation\n\n-   Normal distribution is usually used as a reference, which has a kurtosis of $3$ and is referred to as `mesokurtic`.\n\n-   Unimodal distributions with kurtosis $\\gt 3$ possess heavier or thicker tails (i.e., more extreme values in the tails) relative to the normal distribution and are referred to as `leptokurtic`.\n\n-   Unimodal distributions with kurtosis $\\lt 3$ possess lighter or thinner tails relative to the normal distribution and are referred to as `platykurtic`.\n\n-   The following figure shows different distributions and their kurtosis values:\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](B08_distrib_shape_stats_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n-   As depicted in the above figure, the mesokuotic distribution is a normal distribution that has a kurtosis of $0$ because software packages express it as **excess kurtosis** $(Kurtosis - 3)$.\n\n-   In this context, the leptokurtic distribution has a kurtosis $\\gt 0$, while the platykurtic distribution has a kurtosis $\\lt 0$.\n\n### Calculation in R\n\n-   Different functions in R can be used to calculate the kurtosis:\n\n    -   `kurtosis()` function from the `moments` package (uses formula 1 but as raw kurtosis, i.e., $m_4/m_2^2$).\n\n    -   `Kurtosis()` function from the `sasLM` package (uses formula 2).\n\n    -   `kurtosi()` function from the `psych` package or `kurtosis()` function from the `e1071` package can calculate skewness using the three formulas by setting the `type` argument to either $1$, $2$, or $3$.\n\n-   The skewness standard error can be calculated using the `KurtosisSE()` function from the `sasLM` package.\n\n-   For example, the skewness of the `insulin` variable from the `PimaIndiansDiabetes` dataset can be calculated as follows:\n\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n            # load the library and dataset\n            library(mlbench)\n            data(PimaIndiansDiabetes)\n    \n            # calculate kurtosis and its standard error\n            library(psych)\n            library(sasLM)\n            paste(\n        \"Kurtosis =\", \n        round(kurtosi(PimaIndiansDiabetes$insulin, type = 2), 3)\n            )\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] \"Kurtosis = 7.214\"\n    ```\n    \n    \n    :::\n    \n    ```{.r .cell-code}\n            paste(\n        \"Kurtosis SE =\", \n        round(KurtosisSE(PimaIndiansDiabetes$insulin), 3)\n            )\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] \"Kurtosis SE = 0.176\"\n    ```\n    \n    \n    :::\n    :::\n\n\n\n\n-   These results are similar to the results obtained by `SPSS` or `Graphpad Prism`:\n\n    ::: panel-tabset\n    ## SPSS\n\n    <img src=\"/images/kurt_s.png\" alt=\"SPSS\" width=\"100%\"/>\n\n    ## Graphpad Prism\n\n    <img src=\"/images/kurt_g.png\" alt=\"Graphpad Prism\" width=\"100%\"/>\n    :::\n\n## References\n\n-   Daniel, W. W. and Cross, C. L. (2013). Biostatistics: A Foundation for Analysis in the Health Sciences, Tenth edition. Wiley\n\n-   Heumann, C., Schomaker, M., and Shalabh (2022). Introduction to Statistics and Data Analysis: With Exercises, Solutions and Applications in R. Springer\n\n-   Hoffman, J. (2019). Basic Biostatistics for Medical and Biomedical Practitioners, Second Edition. Academic Press\n\n-   Lane, D. M. et al., (2019). Introduction to Statistics. Online Edition. Retrieved September 14, 2024, from https://openstax.org/details/introduction-statistics\n\n-   Westfall, Peter H. 2014. Kurtosis as Peakedness, 1905–2014. R.I.P. The American Statistician 68 (3): 191–95. <https://doi.org/10.1080/00031305.2014.917055>\n\n<br>\n\n## Add your comments\n",
    "supporting": [
      "B08_distrib_shape_stats_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}