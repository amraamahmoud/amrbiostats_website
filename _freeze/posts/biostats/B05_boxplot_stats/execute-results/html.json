{
  "hash": "16132bb81c4cd21772017d561b01c425",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Boxplot\"\nimage: \"/images/biostats.jpg\"\ndate: \"2024-11-01\"\nformat: \n  html: \n    fig-align: center\n    page-layout: article\n    toc: true\n    toc-depth: 5\n    toc-expand: true\n    lightbox: false\ncrossref: \n  custom: \n    - kind: float\n      reference-prefix: \"Example M.10.\"\n      key: tabset\n      space-before-numbering: false\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n:::\n\n\n\n## Introduction\n\n-   A boxplot is used to graphically represent the distribution of numerical and ordinal data.\n\n-   In addition, it is helpful in identifying outliers.\n\n## Components of boxplot\n\n-   It consists of a box and two vertical lines (whiskers) extending from the box.\n\n\n\n::: {.cell}\n\n:::\n\n\n\n-   For example, consider the following two boxplots:\n\n    ![](/images/boxplot.jpg)\n\n    -   **The Box**:\n\n        -   It has has three horizontal lines (hinges).\n\n            1.  The bottom line <i class=\"bi bi-1-circle-fill\" style=\"color: #0171c3; font-size: 22px;\"></i> represents the $25^{th}$ percentile (first quartile, $Q_1$).\n\n            2.  The middle line <i class=\"bi bi-2-circle-fill\" style=\"color: #0171c3; font-size: 22px;\"></i> represents the $50^{th}$ percentile (median, $Q_2$).\n\n            3.  The top line <i class=\"bi bi-3-circle-fill\" style=\"color: #0171c3; font-size: 22px;\"></i> represents the $75^{th}$ percentile (third quartile, $Q_3$).\n\n        ::: {.callout-note style=\"color: #0466c8;\"}\n        ## IQR\n\n        -   The difference between the $Q_3$ and $Q_1$ is referred to as the \\`interquartile range (IQR)', which is a measure of the spread of the middle $50\\%$ of the data and will be discussed later under the measures of dispersion.\n        :::\n\n    -   **The Whiskers**:\n\n        -   The whiskers extend from the box to the minimum <i class=\"bi bi-4-circle-fill\" style=\"color: darkgreen; font-size: 22px;\"></i> and maximum <i class=\"bi bi-5-circle-fill\" style=\"color: darkgreen; font-size: 22px;\"></i> if they are contained within $Q1 - (1.5 \\times \\text{IQR})$ and $Q3 + (1.5 \\times \\text{IQR})$ as shown in the boxplot $A$ to the left panel.\n\n        -   On the other hand, the whiskers are capped by short horizontal lines <i class=\"bi bi-6-circle-fill\" style=\"color: orange; font-size: 22px;\"></i> and <i class=\"bi bi-7-circle-fill\" style=\"color: orange; font-size: 22px;\"></i> (inner fences, IF) at $Q1 - (1.5 \\times \\text{IQR})$ and $Q3 + (1.5 \\times \\text{IQR})$ if there are values outside this range as shown in the boxplot $B$ to the right panel. These fences are also referred to as **Tukey's fences**.\n\n        -   Additionally, the boxplot $B$ shows short horizontal lines <i class=\"bi bi-8-circle-fill\" style=\"color: red; font-size: 22px;\"></i> and <i class=\"bi bi-9-circle-fill\" style=\"color: red; font-size: 22px;\"></i> that are referred to as outer fences (OF) and are located at $Q1 - (3 \\times \\text{IQR})$ and $Q3 + (3 \\times \\text{IQR})$. However, the outer fences are not shown on the boxplot by default in R.\n\n    -   **Outliers**:\n\n        -   Grubbs defined outlier as \"an observation that deviates markedly from other members of the sample in which it occurs.â€\n\n        -   The values ![](/images/10.svg){style=\"vertical-align: bottom; display: inline-block\" width=\"30\" height=\"30\"} located between the inner and outer fences are termed minor outliers (Boxplot $B$).\n\n        -   The values ![](/images/11.png){style=\"vertical-align: middle; display: inline-block\" width=\"35\" height=\"35\"} located beyond the outer fences are termed major outliers (Boxplot $B$).\n\n        -   The function `identify_outliers()` from the `rstatix` package can be used to identify outliers based on Tukey's method\n\n## Creating Boxplots in R\n\n-   As an example, we will use the `pressure` variable from the `PimaIndiansDiabetes` dataset which is available in the `mlbench` package or `Sepal.Width` variable from the `iris` dataset, which is available in base R.\n\n-   So, the first step is to load the required libraries and datasets:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(mlbench)\n    data(PimaIndiansDiabetes)\n    data(iris)\n    ```\n    :::\n\n\n\n::: panel-tabset\n## Base R\n\n-   The following figure shows the default boxplot in R with the fences at $Q1 - (1.5 \\times \\text{IQR})$ and $Q3 + (1.5 \\times \\text{IQR})$.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(\n  PimaIndiansDiabetes$pressure, \n  range = 1.5,\n  main = \"Boxplot of the diastolic blood pressure\",\n  ylab = \"Diastolic blood pressure (mm Hg)\"\n)\n```\n\n::: {.cell-output-display}\n![](B05_boxplot_stats_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n-   The outlying observation can be identified using the function `identify_outliers()` from the `rstatix` package as follows:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(rstatix)\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    \n    ```\n    \n    Attaching package: 'rstatix'\n    ```\n    \n    \n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    \n    ```\n    The following object is masked from 'package:stats':\n    \n        filter\n    ```\n    \n    \n    :::\n    \n    ```{.r .cell-code}\n    PimaIndiansDiabetes %>%\n      select(pressure) %>%\n      identify_outliers()\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n        pressure is.outlier is.extreme\n    8          0       TRUE       TRUE\n    16         0       TRUE       TRUE\n    19        30       TRUE      FALSE\n    44       110       TRUE      FALSE\n    50         0       TRUE       TRUE\n    61         0       TRUE       TRUE\n    79         0       TRUE       TRUE\n    82         0       TRUE       TRUE\n    85       108       TRUE      FALSE\n    107      122       TRUE      FALSE\n    126       30       TRUE      FALSE\n    173        0       TRUE       TRUE\n    178      110       TRUE      FALSE\n    194        0       TRUE       TRUE\n    223        0       TRUE       TRUE\n    262        0       TRUE       TRUE\n    267        0       TRUE       TRUE\n    270        0       TRUE       TRUE\n    301        0       TRUE       TRUE\n    333        0       TRUE       TRUE\n    337        0       TRUE       TRUE\n    348        0       TRUE       TRUE\n    358        0       TRUE       TRUE\n    363      108       TRUE      FALSE\n    427        0       TRUE       TRUE\n    431        0       TRUE       TRUE\n    436        0       TRUE       TRUE\n    454        0       TRUE       TRUE\n    469        0       TRUE       TRUE\n    485        0       TRUE       TRUE\n    495        0       TRUE       TRUE\n    523        0       TRUE       TRUE\n    534        0       TRUE       TRUE\n    536        0       TRUE       TRUE\n    550      110       TRUE      FALSE\n    590        0       TRUE       TRUE\n    598       24       TRUE      FALSE\n    602        0       TRUE       TRUE\n    605        0       TRUE       TRUE\n    620        0       TRUE       TRUE\n    644        0       TRUE       TRUE\n    692      114       TRUE      FALSE\n    698        0       TRUE       TRUE\n    704        0       TRUE       TRUE\n    707        0       TRUE       TRUE\n    ```\n    \n    \n    :::\n    :::\n\n\n\n    -   The output shows the index and the value of the outlying observation and wether it is a minor (`is.outlier`) or major (`is.extreme`) outlier.\n\n-   A `plus` sign $(+)$ is sometimes drawn on the boxplot to indicate the `mean` as in the following figure:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(\n  PimaIndiansDiabetes$pressure, \n  range = 1.5,\n  main = \"Boxplot of the diastolic blood pressure\",\n  ylab = \"Diastolic blood pressure (mm Hg)\",\n  col = \"white\"\n)\n\npoints(\n  1, \n  mean(PimaIndiansDiabetes$pressure), \n  col = \"red\", \n  pch = 3, \n  cex = 1,\n  lwd = 2\n  \n)\n```\n\n::: {.cell-output-display}\n![](B05_boxplot_stats_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n-   **Control fences location**\n\n    -   The location of the fences can be controlled using the `range` argument:\n\n\n\n        ::: {.cell}\n        \n        ```{.r .cell-code}\n        par(mfrow=c(1,3))\n        \n        boxplot(\n          PimaIndiansDiabetes$pressure, \n          range = 1.5,\n          main = \"A \\n Fences range = 1.5 (Default)\"\n        )\n        \n        boxplot(\n          PimaIndiansDiabetes$pressure, \n          range = 3,\n          main = \"B \\n Fences range = 3\"\n        )\n        \n        boxplot(\n          PimaIndiansDiabetes$pressure,\n          range = 0,\n          main = \"C \\n Fences range = 0\"\n        )\n        ```\n        \n        ::: {.cell-output-display}\n        ![](B05_boxplot_stats_files/figure-html/unnamed-chunk-7-1.png){width=672}\n        :::\n        :::\n\n\n\n        -   Figure $A$ shows the boxplot with the fences at $Q1 - (1.5 \\times \\text{IQR})$ and $Q3 + (1.5 \\times \\text{IQR})$, which is the default setting in R.\n\n        -   Figure $B$ shows the boxplot with the fences at $Q1 - (3 \\times \\text{IQR})$ and $Q3 + (3 \\times \\text{IQR})$.\n\n        -   Figure $C$ shows the boxplot with the fences at the minimum and maximum values.\n\n-   **Notch**\n\n    -   The notches in a boxplot represent a rough estimate of the confidence interval around the median.\n\n    -   They extend to the `median` $\\pm\\ 1.58 \\times \\text{IQR}/ \\sqrt{n}$.\n\n    -   Notches can be requested by setting the `notch` argument to `TRUE`.\n\n    -   The notches allow for the visual comparison of medians between two groups. If the notches of two boxplots do not overlap, it suggests that there is a statistically significant difference between the medians of the two groups at approximately the 95% confidence level. Conversely, if the notches overlap, the medians are not significantly different.\n\n    -   This is quoted from the help of `boxplot.stats()` \"The notches (if requested) extend to $\\pm 1.58 IQR/sqrt(n)$. This seems to be based on the same calculations as the formula with 1.57 in Chambers et al. (1983, p. 62), given in McGill et al. (1978, p. 16). They are based on asymptotic normality of the median and roughly equal sample sizes for the two medians being compared, and are said to be rather insensitive to the underlying distributions of the samples. The idea appears to be to give roughly a 95% confidence interval for the difference in two medians.\"\n\n    -   For example, the following code will draw boxplot with notches for the `pressure` variable from the `PimaIndiansDiabetes` dataset grouped by `diabetes` status:\n\n\n\n        ::: {.cell}\n        \n        ```{.r .cell-code}\n            boxplot(\n              pressure ~ diabetes,\n              data = PimaIndiansDiabetes,\n              notch = TRUE,\n              main = \"Boxplot with notch\",\n              xlab = \"Diabetes Status\",\n              ylab = \"Diastolic blood pressure (mm Hg)\"\n            )\n        ```\n        \n        ::: {.cell-output-display}\n        ![](B05_boxplot_stats_files/figure-html/unnamed-chunk-8-1.png){width=672}\n        :::\n        :::\n\n\n\n        -   The notches of the two boxes do not overlap, indicating that the medians are significantly different between the two groups (this can be confirmed by a formal statistical test such as Mood's median test).\n\n-   **Box width**\n\n    -   The argument `varwidth` can be set to `TRUE` to draw the boxes with widths proportional to the square root of the number of observations in the groups.\n\n    -   For example, the following code will draw boxplot with variable width for the `pressure` variable from the `PimaIndiansDiabetes` dataset grouped by `diabetes` status:\n\n\n\n        ::: {.cell}\n        \n        ```{.r .cell-code}\n        par(mfrow=c(1,2)) \n        \n        boxplot(\n        PimaIndiansDiabetes$pressure ~ PimaIndiansDiabetes$diabetes,\n        varwidth = FALSE,\n        main = \"Equal width\",\n        xlab = \"Diabetes Status\",\n        ylab = \"Diastolic blood pressure (mm Hg)\"\n        )\n              \n        boxplot(\n        PimaIndiansDiabetes$pressure ~ PimaIndiansDiabetes$diabetes,\n        varwidth = TRUE,\n        main = \"Variable width\",\n        xlab = \"Diabetes Status\",\n        ylab = \"Diastolic blood pressure (mm Hg)\"\n        )\n        ```\n        \n        ::: {.cell-output-display}\n        ![](B05_boxplot_stats_files/figure-html/unnamed-chunk-9-1.png){width=672}\n        :::\n        :::\n\n\n\n## ggplot2\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nggplot(\n  data = PimaIndiansDiabetes,\n  aes(\n    x = diabetes, \n    y = pressure\n  )\n) +\n  geom_boxplot(\n    width = 0.5,\n    color = \"#0466c8\",\n    outlier.colour = \"#e63946\", \n    staplewidth = 0.2  # width of the horizontal lines relative to the box\n  ) +\n  stat_summary(\n    fun = mean, \n    geom = \"point\", \n    shape = 3, \n    color = \"red\",\n    size = 3\n  ) +\n  labs(\n    x = \"Diabetes Status\",\n    y = \"Diastolic blood pressure (mm Hg)\",\n  ) +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](B05_boxplot_stats_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n## car\n\n-   The `Boxplot` function from the `car` package labels the outliers with the corresponding observation numbers.\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(car)\n    Boxplot(iris$Sepal.Width,\n        main = \"Boxplot of Sepal Width\",\n        xlab = \"Iris Species\",\n        ylab = \"Sepal Width\"\n    )\n    ```\n    \n    ::: {.cell-output-display}\n    ![](B05_boxplot_stats_files/figure-html/unnamed-chunk-11-1.png){width=672}\n    :::\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 61 16 33 34\n    ```\n    \n    \n    :::\n    :::\n\n\n\n-   Observations $61, 16, 33$ and $34$ are considered as outliers.\n:::\n\n## Boxplots by base R vs. ggplot2\n\n-   The `boxplot()` function from base R and `geom_boxplot()` function from `ggplot2` produce different boxplots because they are based on different algoriths for calculating quantiles.\n\n-   The following figure shows a side by side comparison of the boxplots produced by the two functions for the `mpg` variable from the `mtcars` dataset:\n\n\n\n    ::: {.cell}\n    \n    :::\n\n\n\n![](/images/box_compare.jpg)\n\n-   As depicted in the figure, the boxplot produced by `ggplot2` identifies one outlier that is not identified by the base R `boxplot()`.\n\n-   To see the differences in calculations, we can extract the values used for constructing the boxplots using the `boxplot.stats()` function for base R and `ggplot_build()` function for `ggplot2` as follows:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    boxplot.stats(mtcars$mpg)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    $stats\n    [1] 10.40 15.35 19.20 22.80 33.90\n    \n    $n\n    [1] 32\n    \n    $conf\n    [1] 17.11916 21.28084\n    \n    $out\n    numeric(0)\n    ```\n    \n    \n    :::\n    \n    ```{.r .cell-code}\n    box_ggplot <- ggplot(\n      data = mtcars,\n      aes(y = mpg)\n      ) +\n      geom_boxplot() \n    \n    \n    ggplot_build(box_ggplot)$data[[1]]\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n      ymin  lower middle upper ymax outliers notchupper notchlower x flipped_aes\n    1 10.4 15.425   19.2  22.8 32.4     33.9   21.25989   17.14011 0       FALSE\n      PANEL group ymin_final ymax_final   xmin  xmax xid newx new_width weight\n    1     1    -1       10.4       33.9 -0.375 0.375   1    0      0.75      1\n      colour  fill alpha shape linetype linewidth\n    1 grey20 white    NA    19    solid       0.5\n    ```\n    \n    \n    :::\n    :::\n\n\n\n    -   The output shows different $Q_1$, $Q_3$, and consequently different IQR, fences and outliers.\n\n    -   In addition, the notches are different because the of different $IQR$.\n\n## Distribution insights from boxplots\n\n-   Boxplots can provide information about the distribution of data.\n\n-   For example, consider the following boxplots:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    set.seed(123)\n    x <- rnorm(1000)\n    y <- rexp(1000)\n    \n    par(mfrow=c(2, 2))\n    plot(density(x), main=\"Density Plot of X\")\n    plot(density(y), main=\"Density Plot of Y\")\n    boxplot(x, main=\"Boxplot of X\", col = \"white\")\n    points(1, mean(x), col=\"red\", pch=3)\n    boxplot(y, main=\"Boxplot of Y\", col = \"white\")\n    points(1, mean(y), col=\"red\", pch=3)\n    ```\n    \n    ::: {.cell-output-display}\n    ![](B05_boxplot_stats_files/figure-html/unnamed-chunk-14-1.png){width=672}\n    :::\n    :::\n\n\n\n    -   The boxplot of $X$ is symmetric with the median at the center of the box, the whiskers are of equal length, and a few outliers on both sides of the whiskers. In addition, the mean and median appear to be identical.\n\n    -   On the other hand, the boxplot of $Y$ is skewed to the right with the median closer to the $Q_1$, the whisker on the right is longer than the whisker on the left with many outliers on the right side. The mean is greater than the median, which is due to the presence of outliers on the right side (right skewness).\n\n## Other variations of boxplots\n\n-   Boxplots can be misleading because they cannot capture the shape of the distribution accurately. For example, the fail to capture multimoality or kurtosis (i.e., peakedness of the distribution).\n\n-   Therefore, other variants of boxplots have been used by overlaying the original observations on the boxplot as jittered points or dot plots or wrapping the boxplot in a violin plot that shows the density of the data. These approaches provide more insights about the distribution of the data.\n\n-   Jittering means slightly displacing (spreading) the points horizontally to avoid overlapping, while in the dot plot, the points are stacked on top of each other.\n\n-   The following figure shows that boxplot lacks the ability to capture the bimodal nature of the data, which is evident from the density plot or the boxplot with jittered points:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    # Load necessary libraries\n    set.seed(123)\n    \n    # Generate Bimodal Data with clear separation\n    data_bimodal <- c(\n      rnorm(500, mean = 20, sd = 10), \n      rnorm(500, mean = 80, sd = 10)\n    )\n    \n    \n    par(mfrow=c(3,1))\n    \n    boxplot(\n      data_bimodal, \n      main = \"Boxplot of bimodal Data\", \n      ylab = \"Values\", \n      horizontal = TRUE)\n    \n    plot(\n      density(data_bimodal), \n      main = \"Density Plot of bimodal Data\"\n    )\n    \n    boxplot(\n      data_bimodal, \n      main = \"Boxplot of bimodal Data\",\n      horizontal = TRUE,\n      col = \"white\"\n    )\n    \n    stripchart(\n      data_bimodal,\n      method = \"jitter\",\n      pch = 19, # select the point type\n      add = TRUE, # add the points to the existing plot\n      col = \"#0466c8\",\n      vertical = FALSE,\n      jitter = 0.1 # control the amount of jittering\n    )\n    ```\n    \n    ::: {.cell-output-display}\n    ![](B05_boxplot_stats_files/figure-html/unnamed-chunk-15-1.png){width=672}\n    :::\n    :::\n\n\n\n    -   Both the density plot and the boxplot with jittered points show bimodality as two peaks in the former and two distinct clusters in the latter, which are not captured by the standard boxplot.\n\n### Creating boxplot with jittered points\n\n::: panel-tabset\n## Base R\n\n-   Using `stripchart()` function to produce jittered points.\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    boxplot(\n      Sepal.Width ~ Species,\n      data = iris,\n      col = \"white\",\n      outline = FALSE,\n      main = \"Boxplot of sepal width grouped by \\n species with jittered points\",\n      xlab = \"Species\",\n      ylab = \"Sepal Width\"\n    )\n    \n    stripchart(\n      Sepal.Width ~ Species,\n      data = iris,\n      method = \"jitter\",  # select the jitter method\n      pch = 19,  # select the point type\n      add = TRUE,  # add the points to the existing plot\n      col = \"#e63946\", \n      vertical = TRUE, \n      jitter = 0.1,  # control the amount of jittering\n      cex = 0.7  # control the size of the points\n    )\n    ```\n    \n    ::: {.cell-output-display}\n    ![](B05_boxplot_stats_files/figure-html/unnamed-chunk-16-1.png){width=672}\n    :::\n    :::\n\n\n\n## ggplot2\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nggplot(\n  data = iris,\n  aes(\n    x = Species,\n    y = Sepal.Width\n  )\n) +\n  geom_boxplot(\n    width = 0.5,\n    color = \"#0466c8\",\n    outliers = FALSE,\n    staplewidth = 0.2\n  ) +\n  geom_jitter(\n    width = 0.2,\n    color = \"#e63946\",\n    size = 0.7\n  ) +\n  labs(\n    x = \"Sepal Width\",\n    y = \"Species\",\n  ) +\n  labs(title = \"Boxplot with jittered points\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](B05_boxplot_stats_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n:::\n\n### Creating boxplot with dot plot\n\n::: panel-tabset\n## Base R\n\n-   Using `beeswarm` function from the `beeswarm` package that provides various methods to separate coincident points such that the points are stacked and do not overlap.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(beeswarm)\n\nboxplot(\n  Sepal.Width ~ Species,\n  data = iris,\n  col = \"white\",\n  outline = FALSE,\n  main = \"Boxplot of sepal width grouped by \\n species with jittered points\",\n  xlab = \"Species\",\n  ylab = \"Sepal Width\"\n)\n\nbeeswarm(\n  Sepal.Width ~ Species,\n  data = iris,\n  pch = 19, # select the point type\n  add = TRUE, # add the points to the existing plot\n  col = \"#e63946\",\n  method = \"center\", # select the jitter method\n  cex = 0.7 # control the size of the points\n)\n```\n\n::: {.cell-output-display}\n![](B05_boxplot_stats_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n## ggplot2\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n  data = iris,\n  aes(\n    x = Species,\n    y = Sepal.Width\n  )\n) +\n  geom_boxplot(\n    width = 0.5,\n    color = \"#0466c8\",\n    outliers = FALSE, \n    staplewidth = 0.2\n  ) +\n  geom_dotplot(\n    binaxis = \"y\",\n    stackdir = \"center\",\n    dotsize = 0.4,\n    fill = \"#e63946\",\n    color = \"#e63946\",\n  ) +\n  labs(\n    x = \"Sepal Width\",\n    y = \"Species\",\n  ) +\n  labs(title = \"Boxplot with dot plot\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](B05_boxplot_stats_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n:::\n\n### Creating boxplot wrapped in violin plot\n\n::: panel-tabset\n## Base R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(vioplot)\nvioplot(\n  x = data_bimodal, \n  rectCol = \"white\",  # color of the box\n  lineCol = \"white\",  # color of the lines\n  colMed = \"#e63946\",  # color of the median point\n  wex = 0.6,  # relative expansion of the violin \n  col = rgb(212/255, 73/255, 76/255, alpha = 0.8),\n  names = \"Bimodal distribution\",  # label for variable\n  main = \"Violin plot of bimodal data\"\n  )\n```\n\n::: {.cell-output-display}\n![](B05_boxplot_stats_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\n## Using ggpubr\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggpubr)\nmy_data <- data.frame(\n  x = data_bimodal,\n  group = \"Binomial Distribution\"\n)\n\nggviolin(\n  data = my_data,\n  x = \"group\",\n  y = \"x\",\n  fill = \"#e63946\",\n  alpha = 0.8,\n  width = 0.7,\n  xlab = \"\",\n  ylab = \"Values\",\n  main = \"Violin plot of bimodal data\",\n  add = \"boxplot\",\n  add.params = list(\n    alpha = 0.5,\n    fill = \"white\",\n    width = 0.04\n  ),\n  ggtheme = theme_bw()\n)\n```\n\n::: {.cell-output-display}\n![](B05_boxplot_stats_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\n## ggplo2\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n  data = data.frame(x = data_bimodal),\n  aes(x = \"Bimodal distribution\", y = x)\n) +\n  geom_violin(\n    fill = \"#e63946\",\n    alpha = 0.8,\n    width = 0.7\n  ) +\n  geom_boxplot(\n    fill = \"white\",\n    alpha = 0.5,\n    width = 0.04\n  ) +\n  labs(\n    x = \"\",\n    y = \"Values\"\n  ) +\n  labs(title = \"Violin plot of bimodal data\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](B05_boxplot_stats_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n:::\n\n## References\n\n-   Daniel, W. W. and Cross, C. L. (2013). Biostatistics: A Foundation for Analysis in the Health Sciences, Tenth edition. Wiley\n\n-   Heumann, C., Schomaker, M., and Shalabh (2022). Introduction to Statistics and Data Analysis: With Exercises, Solutions and Applications in R. Springer\n\n-   Lane, D. M. et al., (2019). Introduction to Statistics. Online Edition. Retrieved September 14, 2024, from https://openstax.org/details/introduction-statistics\n\n<br>\n\n## Add your comments\n",
    "supporting": [
      "B05_boxplot_stats_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}