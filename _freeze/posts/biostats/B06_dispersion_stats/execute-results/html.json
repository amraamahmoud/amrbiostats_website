{
  "hash": "fe3ca5b93dd4fbd94eec4a01e9ac17ab",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Measures of Variability\"\nimage: \"/images/biostats.jpg\"\ndate: \"2024-11-06\"\nformat: \n  html: \n    fig-align: center\n    page-layout: article\n    toc: true\n    toc-depth: 5\n    toc-expand: true\n    lightbox: false\ncrossref: \n  custom: \n    - kind: float\n      reference-prefix: \"Example M.10.\"\n      key: tabset\n      space-before-numbering: false\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n:::\n\n\n\n## Background\n\n-   Variability describes how the observations are dispersed around the center of the data.\n\n-   The terms `variability` and `dispersion` are used interchangeably.\n\n-   Two distributions can have the same mean but different variability (as depicted in the figure below).\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](B06_dispersion_stats_files/figure-html/unnamed-chunk-2-1.png){width=672}\n    :::\n    :::\n\n\n\n    -   Despite having the same mean represented by the red vertical line, the blue distribution has a higher variability than the green distribution (i.e., the observations are more dispersed around the mean).\n\n-   Therefore, it is important to report a measure of variability along with the measure of central tendency to provide a complete description of the data.\n\n## Measures of variability\n\n-   In the following sections, we will discuss the most commonly used measures of variability.\n\n### Range\n\n-   The range $(R)$ is defined as the difference between the maximum and minimum value of the data.\n\n$$\nR = x_{\\text{max}} - x_{\\text{min}}\n$$\n\n-   The range considers only two observations, so its use is limited.\n\n-   It is sensitive to extreme values.\n\n-   Because infinite number of distributions can have different maximum and minimum values but the same range, it can be helpful to report the range as the $[x_{\\text{min}},\\ x_{\\text{max}}]$. This approach conveys more information about the data.\n\n-   Example: the range of the variable `mpg` in the `mtcars` dataset is calculated in R using the `range()` function:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    range(mtcars$mpg)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 10.4 33.9\n    ```\n    \n    \n    :::\n    :::\n\n\n\n    -   The output is a vector of two values representing the minimum and maximum values, respectively.\n\n### Interquartile Range (IQR)\n\n-   It is defined as the difference between the third quartile $(Q_3)$ and the first quartile $(Q_1)$;\n\n$$\nIQR = Q_3 - Q_1\n$$\n\n-   $IQR$ reflects the variability among the middle $50\\%$ of the observations:\n\n    -   If $IQR$ is large, it inidicates a large amount of variability.\n\n    -   If $IQR$ is small, it indicates a small amount of variability.\n\n-   The IQR is calculated in R using the `IQR()` function as follows:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    IQR(mtcars$mpg)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 7.375\n    ```\n    \n    \n    :::\n    :::\n\n\n\n::: callout-note\n-   The `summary()` function in R can be used to get the minimum, $Q_1$, median, $Q_3$, and maximum values of a variable. In addition, it provides the counts of missing values, if any.\n\n-   For example, the summary of the variable `mpg` in the `mtcars` dataset is obtained as follows:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    summary(mtcars$mpg)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n       Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n      10.40   15.43   19.20   20.09   22.80   33.90 \n    ```\n    \n    \n    :::\n    :::\n\n\n:::\n\n### Variance\n\n-   The variance measures the variability relative to the scatter of the observations about their mean.\n\n#### Population variance\n\n-   Finite population variance $\\sigma^2$ is defined as the mean of the squared differences (i.e., deviations) between each observation and the population mean $(\\mu)$:\n\n$$\n\\sigma^2 =\\displaystyle \\frac{1}{N} \\displaystyle \\sum_{i=1}^{N} (x_i - \\mu)^2 = \\displaystyle \\frac{1}{N} \\Big (\\displaystyle \\sum_{i=1}^{N} x_i^2 - \\frac {\\displaystyle \\big (\\sum_{i=1}^{N} x_i \\big)^2}{N} \\Big)\n$$\n\n#### Sample variance\n\n-   Sample variance $(s^2)$ is defined as the mean of the squared differences (i.e., deviations) between each observation and the sample mean $(\\bar{x})$:\n\n$$\ns^2 =\\displaystyle \\frac{1}{n-1} \\displaystyle \\sum_{i=1}^{n} (x_i - \\bar{x})^2 = \\displaystyle \\frac{1}{n-1} \\Big (\\displaystyle \\sum_{i=1}^{n} x_i^2 - \\frac {\\displaystyle \\big (\\sum_{i=1}^{n} x_i \\big)^2}{n} \\Big)\n$$\n\n-   More detailed discussion on the sample variance formula is provided [here](/posts/biostats/B07_sample_variance_stats.qmd).\n\n-   The sample variance is calculated in R using the `var()` function as follows:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    var(mtcars$mpg)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 36.3241\n    ```\n    \n    \n    :::\n    :::\n\n\n\n-   The above value is the same if we calculate the variance manually using the above formula:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    n <- length(mtcars$mpg)\n    mean_mpg <- mean(mtcars$mpg)\n    sum((mtcars$mpg - mean_mpg)^2) / (n - 1)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 36.3241\n    ```\n    \n    \n    :::\n    :::\n\n\n\n::: {.callout-note style=\"color:#0466c8;\"}\n-   The expression $\\displaystyle \\sum_{i=1}^{N} (x_i - \\mu)^2$ or $\\displaystyle \\sum_{i=1}^{n}(x_i - \\bar{x})^2$ is referred to as sum of squares $SS$.\n\n-   The unit of the variance is the square of the units of the observations making interpretation difficult.\n:::\n\n### Standard Deviation\n\n-   The standard deviation $(s)$ is the square root of the variance.\n\n#### Population standard deviation\n\n$$\n\\sigma = \\sqrt{\\sigma^2} = \\sqrt{\\displaystyle \\frac{1}{N} \\displaystyle \\sum_{i=1}^{N} (x_i - \\mu)^2}   \n$$\n\n#### Sample standard deviation\n\n$$\ns = \\sqrt{s^2} =  \\sqrt{\\displaystyle \\frac{1}{n-1} \\displaystyle \\sum_{i=1}^{n} (x_i - \\bar{x})^2}   \n$$\n\n-   The sample standard deviation is calculated in R using the `sd()` function as follows:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    sd(mtcars$mpg)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 6.026948\n    ```\n    \n    \n    :::\n    :::\n\n\n\n-   The above value is the same if we take the square root of the sample variance:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    sqrt(var(mtcars$mpg))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 6.026948\n    ```\n    \n    \n    :::\n    :::\n\n\n\n::: {.callout-note style=\"color:#0466c8;\"}\n-   The standard deviation is more interpretable than the variance because it has the original unit of the observations.\n\n-   Therefore, it is preferred as a measure of variability.\n\n-   Similar to the variance, the standard deviation measures how much the observations are scattered around the mean (i.e., the average difference of the observations from the mean), therefore:\n\n    -   A low value of the standard deviation implies that the observations are more concentrated around the mean (i.e., low variability).\n\n    -   A high value of the standard deviation implies that the observations are more scattered around the mean (i.e., high variability).\n:::\n\n### Coefficient of Variation\n\n-   Assume that we want to compare the variability of two or more variables.\n\n-   Although the standard deviation is an appropriate measure of variability, it is not suitable for making this comparison directly because the variables might have different units causing the means to differ substantially. This also applies even if the variables are measured in the same units but have different means (differences in the standard deviation might be due to differences in the means not due to differences in the variability).\n\n-   Therefore, a relative measure of variability is needed that is independent of the unit of measurement or the mean.\n\n-   The coefficient of variation $(CV)$ is defined as the ratio of the standard deviation to the mean expressed as a percentage:\n\n$$\nCV = \\displaystyle \\frac{s}{\\bar{x}} \\times (100) \\%\n$$\n\n-   It is unitless and is independent of the mean.\n\n::: panel-tabset\n## Example B.6.1 {{< iconify ic:round-menu-book size=21px >}}\n\n-   The mean and standard deviation of the glucose and cholesterol levels of 10 subjects are given below:\n\n    -   Glucose: $\\bar{x}_{\\text{glucose}} = 120$ mg/dL, $s_{\\text{glucose}} = 15$ mg/dL\n\n    -   Cholesterol: $\\bar{x}_{\\text{cholesterol}} = 200$ mg/dL, $s_{\\text{cholesterol}} = 20$ mg/dL\n\n-   The coefficient of variation for glucose and cholesterol levels can be calculated as follows:\n\n    -   $CV_{\\text{glucose}} = \\displaystyle \\frac{15}{120} \\times 100\\% = 12.5\\%$\n\n    -   $CV_{\\text{cholesterol}} = \\displaystyle \\frac{20}{200} \\times 100\\% = 10\\%$\n\n-   Based on the results, we can conclude that the cholesterol levels are less variable than the glucose levels (even though the standard deviation of cholesterol levels is higher than that of glucose levels).\n\n-   Using the standard deviation to compare the variability would have led to the opposite conclusion.\n\n## [Exercise B.6.1 {{< iconify fluent:chat-bubbles-question-20-filled size=21px >}}]{style=\"color: #ba181b\"}\n\n-   Load the `PimaIndiansDiabetes` dataset.\n\n\n\n    Which of the following variables has the highest variability?? <div class='webex-radiogroup' id='radio_RTZEGRRJEP'><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_RTZEGRRJEP\" value=\"\"></input> <span>glucose</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_RTZEGRRJEP\" value=\"answer\"></input> <span>pressure</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_RTZEGRRJEP\" value=\"\"></input> <span>mass</span></label></div>\n\n\n:::\n\n### Median Absolute Deviation (MAD)\n\n-   The standard deviation is based on the mean, so it is also sensitive to outliers.\n\n-   Median Absolute Deviation (MAD) is a more robust measure of variability than the standard deviation.\n\n-   It is calculated based on the median of the observations and is defined as the median of the absolute deviations of the observations from the median:\n\n$$\n\\text{MAD} = \\text{median}(|x_i - \\text{median}(x)|)\n$$\n\n::: panel-tabset\n## Example B.6.2 {{< iconify ic:round-menu-book size=21px >}}\n\n-   Calculate $MAD$ for the following observations: $2, 5, 6, 8, 15$.\n\n-   The median of the observations is $6$.\n\n-   The absolute deviations from the median are $|2-6| = 4$, $|5-6| = 1$, $|6-6| = 0$, $|8-6| = 2$, and $|15-6| = 9$.\n\n-   Arrange the absolute deviations in ascending order: $0, 1, 2, 4, 9$.\n\n-   The median of the absolute deviations $\\text{MAD} = 2$.\n:::\n\n::: {.callout-note style=\"color:#0466c8;\" title=\"MAD of normal distribution\"}\n-   If the distribution of a variable is normal (i.e., Gaussian), the following relationships hold:\n\n    -   $\\sigma \\approx 1.4826 \\times \\text{MAD}$\n\n    -   $\\text{IQR} \\approx 2 \\times \\text{MAD}$\n:::\n\n-   MAD can be calculated in R using the `mad()` function as follows:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    mad(c(2, 5, 6, 8, 15))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 2.9652\n    ```\n    \n    \n    :::\n    :::\n\n\n\n    -   The result $(2.9652)$ is different from our manual calculation $(2)$ because the `mad()` function in R scales the $\\text{MAD}$ by a constant factor of $1.4826$ for a normal distribution $(2 \\times 1.4826 = 2.9652)$.\n\n## References\n\n-   Daniel, W. W. and Cross, C. L. (2013). Biostatistics: A Foundation for Analysis in the Health Sciences, Tenth edition. Wiley\n\n-   Heumann, C., Schomaker, M., and Shalabh (2022). Introduction to Statistics and Data Analysis: With Exercises, Solutions and Applications in R. Springer\n\n-   Hoffman, J. (2019). Basic Biostatistics for Medical and Biomedical Practitioners, Second Edition. Academic Press\n\n-   Lane, D. M. et al., (2019). Introduction to Statistics. Online Edition. Retrieved September 14, 2024, from https://openstax.org/details/introduction-statistics\n\n<br>\n\n## Add your comments\n",
    "supporting": [
      "B06_dispersion_stats_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}